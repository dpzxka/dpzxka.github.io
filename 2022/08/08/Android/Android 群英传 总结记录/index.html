<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Android 群英传笔记 | 小白兔与小猪猪</title><meta name="keywords" content="android"><meta name="author" content="XKADPZ"><meta name="copyright" content="XKADPZ"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="android 笔记记录">
<meta property="og:type" content="article">
<meta property="og:title" content="Android 群英传笔记">
<meta property="og:url" content="https://dpzxka.github.io/2022/08/08/Android/Android%20%E7%BE%A4%E8%8B%B1%E4%BC%A0%20%E6%80%BB%E7%BB%93%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="小白兔与小猪猪">
<meta property="og:description" content="android 笔记记录">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dpzxka.github.io/img/author.jpeg">
<meta property="article:published_time" content="2022-08-07T16:00:00.000Z">
<meta property="article:modified_time" content="2022-08-08T15:36:23.427Z">
<meta property="article:author" content="XKADPZ">
<meta property="article:tag" content="android">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dpzxka.github.io/img/author.jpeg"><link rel="shortcut icon" href="/img/favicon_new.jpeg"><link rel="canonical" href="https://dpzxka.github.io/2022/08/08/Android/Android%20%E7%BE%A4%E8%8B%B1%E4%BC%A0%20%E6%80%BB%E7%BB%93%E8%AE%B0%E5%BD%95/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":250},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: XKADPZ","link":"链接: ","source":"来源: 小白兔与小猪猪","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Android 群英传笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-08 23:36:23'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/java/"><i class="fa-fw fa-brands fa-java"></i><span> Java</span></a></li><li><a class="site-page child" href="/android/"><i class="fa-fw fa-brands fa-android"></i><span> Android</span></a></li><li><a class="site-page child" href="/algorithm/"><i class="fa-fw fa-duotone fa-blanket"></i><span> algorithm</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/carbonEmission/"><i class="fa-fw fa-brands fa-cloudversify"></i><span> 碳排放</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/author.jpeg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小白兔与小猪猪</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/java/"><i class="fa-fw fa-brands fa-java"></i><span> Java</span></a></li><li><a class="site-page child" href="/android/"><i class="fa-fw fa-brands fa-android"></i><span> Android</span></a></li><li><a class="site-page child" href="/algorithm/"><i class="fa-fw fa-duotone fa-blanket"></i><span> algorithm</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/carbonEmission/"><i class="fa-fw fa-brands fa-cloudversify"></i><span> 碳排放</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Android 群英传笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-07T16:00:00.000Z" title="发表于 2022-08-08 00:00:00">2022-08-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-08T15:36:23.427Z" title="更新于 2022-08-08 23:36:23">2022-08-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/android/">android</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>22分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Android 群英传笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><hr>
<h2 id="群英传"><a href="#群英传" class="headerlink" title="群英传"></a>群英传</h2><h3 id="第1章Android体系与系统架构"><a href="#第1章Android体系与系统架构" class="headerlink" title="第1章Android体系与系统架构"></a>第1章Android体系与系统架构</h3><h4 id="系统架构"><a href="#系统架构" class="headerlink" title="系统架构"></a>系统架构</h4><p><img src="https://s2.loli.net/2022/08/07/Yfl4p3AMeikBgSC.png" alt="image-20220807145006111"></p>
<ul>
<li><p>Linux内核层</p>
<p>Android系统是基于Linux内核的，为设置的各种硬件提供了底层的驱动：显示驱动，音频驱动，蓝牙驱动等</p>
</li>
<li><p>系统运行库层</p>
<p>通过一些C/C++库为Android系统提供了主要的特性支持，SQLite库提供了数据库的支持，OpenGL|ES库提供了3D绘图的支持。</p>
<p>还提供一些核心库，允许使用Java来编写Android应用。还包含Dalvik虚拟机（5.0之后改为ART运行环境），使得每一个Android应用都能运行在读理的进程中，并拥有一个自己的虚拟机实例。</p>
</li>
<li><p>应用框架层</p>
<p>构建应用程序时可能用到的各种API，Android自带的一些核心应用就是使用这些api完成的。</p>
</li>
<li><p>应用层</p>
<p>各种手机应用</p>
</li>
</ul>
<h4 id="App组件架构"><a href="#App组件架构" class="headerlink" title="App组件架构"></a><code>App</code>组件架构</h4><ul>
<li><code>Activity</code></li>
<li><code>BroadCastReceiver</code></li>
<li><code>ContentProvider</code></li>
<li><code>Service</code></li>
</ul>
<p>组件之间的协同工作：</p>
<p>Android作为人机交互的第一界面，负责向用户展示信息和处理结果，这些信息来源，可以通过资源获取，也可也i通过Content Provider来获取其他应用的信息或Service从后台计算、下载、处理的结果，也可以是通过BroadCast Revicever获取到的广播信息。同时通过信使Intent-，作为信息传递的载体。组件与组件之间通过Intent来通信、传递信息、交换数据，从而使得四大组件形成各自独立而又紧密联系。</p>
<h3 id="第2章Android开发工具新接触"><a href="#第2章Android开发工具新接触" class="headerlink" title="第2章Android开发工具新接触"></a>第2章Android开发工具新接触</h3><h4 id="ADB命令使用技巧"><a href="#ADB命令使用技巧" class="headerlink" title="ADB命令使用技巧"></a>ADB命令使用技巧</h4><h3 id="第3章Android控件架构与自定义控件详解"><a href="#第3章Android控件架构与自定义控件详解" class="headerlink" title="第3章Android控件架构与自定义控件详解"></a>第3章Android控件架构与自定义控件详解</h3><h4 id="3-1-Android控件架构"><a href="#3-1-Android控件架构" class="headerlink" title="3.1 Android控件架构"></a>3.1 Android控件架构</h4><ul>
<li><p><strong><code>ViewGroup</code></strong></p>
<p>父控件，可以包含多个View控件，管理包含的View控件。通过ViewGroup，构造成控件树，上层控件负责下层子控件的测量与绘制，并传递交互事件。</p>
</li>
<li><p><strong><code>View控件</code></strong></p>
</li>
</ul>
<p><img src="https://s2.loli.net/2022/08/07/ktrbNuBJyaCp2OY.png" alt="img"></p>
<p>每个Activity都包含一个window对象，在Android中Window对象通常由PhoneWindow来实现。PhoneWindow将一个DecorView设置为整个应用窗口的根View。DevorView作为窗口界面的顶层视图，封装了一些窗口操作的通用方法。DecorView将要显示的具体内容呈现在PhoneWindow上，包含所有View的监听事件，通过WindowMangerService来进行接收，并通过activity对象来回调相应的onClickListener。</p>
<p>将屏幕分成两部分，一个是TitleView，另一个是ContentView(id为content的FrameLayout)。</p>
<p>OnCreate()方法中调用setContentView()方法后，activityManagerService会回调onResume方法，将整个decorView添加到PhoneWindow中，显示出来，最终完成界面的绘制。</p>
<h4 id="3-2-View的测量"><a href="#3-2-View的测量" class="headerlink" title="3.2 View的测量"></a>3.2 View的测量</h4><ul>
<li><p>onMeasure方法：测量View的大小.</p>
<ul>
<li>MeasureSpec类，32位int值，高2位测量的模式，低20位测量的大小</li>
<li>测量的三种模式<ul>
<li>EXACTLY(默认)：当控件layout_width或layout_height属性为具体数值时，或指定为match_parent属性</li>
<li>AT_MOST:最大值模式，当控件layout_width或layout_height属性为wrap_content时，控件的大小一般随着控件的子控件或内容的变化而变化。</li>
<li>UNSPECIFIED：不指定大小的测量模式，view想多大就多大，通常情况下在绘制自定义View时才会使用。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.customview;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Canvas;</span><br><span class="line"><span class="keyword">import</span> android.util.AttributeSet;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomViewDemo</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomViewDemo</span><span class="params">(Context context, <span class="meta">@Nullable</span> AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>&#123;</span><br><span class="line">        setMeasuredDimension(measureWidth(widthMeasureSpec),measureHeight(heightMeasureSpec));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">measureWidth</span><span class="params">(<span class="keyword">int</span> measureSpec)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> specMode = MeasureSpec.getMode(measureSpec);</span><br><span class="line">        <span class="keyword">int</span> specSize = MeasureSpec.getSize(measureSpec);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (specMode == MeasureSpec.EXACTLY) &#123;</span><br><span class="line">            result = specSize;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result = <span class="number">200</span>;</span><br><span class="line">            <span class="keyword">if</span> (specMode == MeasureSpec.AT_MOST) &#123;</span><br><span class="line">                result = Math.min(result,specSize);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">measureHeight</span><span class="params">(<span class="keyword">int</span> measureSpec)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> specMode = MeasureSpec.getMode(measureSpec);</span><br><span class="line">        <span class="keyword">int</span> specSize = MeasureSpec.getSize(measureSpec);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (specMode == MeasureSpec.EXACTLY) &#123;</span><br><span class="line">            result = specSize;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result = <span class="number">200</span>;</span><br><span class="line">            <span class="keyword">if</span> (specMode == MeasureSpec.AT_MOST) &#123;</span><br><span class="line">                result = Math.min(result,specSize);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDraw(canvas);</span><br><span class="line">        canvas.drawBitmap(bitmap1,<span class="number">0</span>,<span class="number">0</span>,<span class="keyword">null</span>);</span><br><span class="line">        canvas.drawBitmap(bitmap2,<span class="number">0</span>,<span class="number">0</span>,<span class="keyword">null</span>);</span><br><span class="line">        Canvas mCanvas = <span class="keyword">new</span> Canvas(bitmap2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="3-3-View的绘制"><a href="#3-3-View的绘制" class="headerlink" title="3.3 View的绘制"></a>3.3 View的绘制</h4><blockquote>
<p>在Android的界面上绘制图像，需要在Canvas上进行绘制(画板)，Paint进行画(画笔)，在重写的OnDraw方法上完成。</p>
</blockquote>
<p>创建Canvas对象时，需要传进去一个bitamp对象。通过bitamp与通过整个bitmao创建的canvas画布紧密连接起来，过程为装载画布。此bitamp用来存储所有绘制在Canvas上的像素信息。通过这种方式创建了Canvas对象后，后面所有的Canvas.drawXXX方法都发生在bitmap上。</p>
<h4 id="3-4-ViewGroup的测量"><a href="#3-4-ViewGroup的测量" class="headerlink" title="3.4 ViewGroup的测量"></a>3.4 ViewGroup的测量</h4><p>当ViewGroup的大小为wrap_content时，ViewGroup就需要对子View进行遍历，以获得所有的子View的大小，从而决定自己的大小。在其他模式下，则通过具体的指定值来设置自身的大小。</p>
<p>ViewGroup在测量时通过遍历所有的子View，从而调用子View的measure方法获得每一个子view的测量结果。</p>
<p>当子view测量完成后，需要将子view放到合适的位置，这个过程就是view的layout过程，ViewGroup在执行Layout过程时，同样是使用遍历来调用子View的Layout方法，并指定其具体显示的位置，从而俩决定其布局的位置。</p>
<p>在自定义ViewGroup时，通常会去重写onLaout方法来控制子view显示位置的逻辑。通过，如果需要<code>支持wrap_content属性</code>，还必须重写onmeasure方法，同View。</p>
<h4 id="3-5-ViewGroup的绘制"><a href="#3-5-ViewGroup的绘制" class="headerlink" title="3.5 ViewGroup的绘制"></a>3.5 ViewGroup的绘制</h4><p>ViewGroup通常情况不需要绘制，本身没有需要绘制的东西，如果指定了ViewGroup的背景颜色则需要调用OnDraw方法。但是，ViewGroup会使用dispatchDraw()方法来绘制子View,其过程同样需要通过遍历所有的子View，并调用子view的绘制方法来完成绘制工作。</p>
<h4 id="3-6-自定义View"><a href="#3-6-自定义View" class="headerlink" title="3.6 自定义View"></a>3.6 自定义View</h4><p><strong><code>常用回调方法</code></strong></p>
<ul>
<li>onFinishInflate()：从XML加载固件后回调。</li>
<li>OnSizeChanged()：组件改变时回调</li>
<li>OnMeasure()：回调该方法进行测量</li>
<li>OnLayout：回调该方法来确定显示的位置</li>
<li>OnTOuchEvent：监听到触摸事件的回调</li>
</ul>
<p><strong><code>实现自定义控件的方法</code></strong></p>
<ul>
<li>对现有控件进行拓展</li>
<li>通过组合来实现新的控件</li>
<li>重写View来实现全新的控件</li>
</ul>
<h5 id="3-61-现有控件拓展"><a href="#3-61-现有控件拓展" class="headerlink" title="3.61. 现有控件拓展"></a>3.61. 现有控件拓展</h5><p><strong>拓展TextView</strong></p>
<ul>
<li><p>绘制TextVie背景</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.customview;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Canvas;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color;</span><br><span class="line"><span class="keyword">import</span> android.graphics.LinearGradient;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Matrix;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Paint;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Shader;</span><br><span class="line"><span class="keyword">import</span> android.util.AttributeSet;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomTextView</span> <span class="keyword">extends</span> <span class="title">androidx</span>.<span class="title">appcompat</span>.<span class="title">widget</span>.<span class="title">AppCompatTextView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Paint mPaint1;</span><br><span class="line">    <span class="keyword">private</span> Paint mPaint2;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomTextView</span><span class="params">(Context context, <span class="meta">@Nullable</span> AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//在回调父类方法前，实现自己的逻辑，对TextView来说就是绘制文件内容前</span></span><br><span class="line">        mPaint1 = <span class="keyword">new</span> Paint();</span><br><span class="line">        mPaint1.setColor(getResources().getColor(android.R.color.holo_blue_bright));</span><br><span class="line">        mPaint1.setStyle(Paint.Style.FILL);</span><br><span class="line">        mPaint2 = <span class="keyword">new</span> Paint();</span><br><span class="line">        mPaint2.setColor(Color.YELLOW);</span><br><span class="line">        mPaint2.setStyle(Paint.Style.FILL);</span><br><span class="line">        <span class="comment">//绘制外层矩形</span></span><br><span class="line">        canvas.drawRect(<span class="number">0</span>,<span class="number">0</span>,getMeasuredWidth(),getMeasuredHeight(),mPaint1);</span><br><span class="line">        <span class="comment">//绘制内层矩形</span></span><br><span class="line">        canvas.drawRect(<span class="number">10</span>,<span class="number">10</span>,getMeasuredWidth()-<span class="number">10</span>,getMeasuredHeight()-<span class="number">10</span>,mPaint2);</span><br><span class="line">        canvas.save();</span><br><span class="line">        <span class="comment">//绘制文字前平移10像素</span></span><br><span class="line">        canvas.translate(<span class="number">50</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="comment">//父类完成的方法，即绘制文本</span></span><br><span class="line">        <span class="keyword">super</span>.onDraw(canvas);</span><br><span class="line">        <span class="comment">//在回调父类方法后，实现自己的逻辑，对TextView来说就是绘制文件内容后</span></span><br><span class="line">        canvas.restore();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>文字闪烁</p>
<p>通过使用Shader渲染器，设置一个不断变化的<code>LinearGradient</code>，并使用带有该属性的Paint对象来绘制要显示的文字。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.customview;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Canvas;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color;</span><br><span class="line"><span class="keyword">import</span> android.graphics.LinearGradient;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Matrix;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Paint;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Shader;</span><br><span class="line"><span class="keyword">import</span> android.util.AttributeSet;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomTextView</span> <span class="keyword">extends</span> <span class="title">androidx</span>.<span class="title">appcompat</span>.<span class="title">widget</span>.<span class="title">AppCompatTextView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Paint mPaint1;</span><br><span class="line">    <span class="keyword">private</span> Paint mPaint2;</span><br><span class="line">    <span class="keyword">private</span> Paint mPaint;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mViewWidth;</span><br><span class="line">    <span class="keyword">private</span> LinearGradient mLinearGradient;</span><br><span class="line">    <span class="keyword">private</span> Matrix mGradientMatrix;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mTranslate;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomTextView</span><span class="params">(Context context, <span class="meta">@Nullable</span> AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//在回调父类方法前，实现自己的逻辑，对TextView来说就是绘制文件内容前</span></span><br><span class="line">        mPaint1 = <span class="keyword">new</span> Paint();</span><br><span class="line">        mPaint1.setColor(getResources().getColor(android.R.color.holo_blue_bright));</span><br><span class="line">        mPaint1.setStyle(Paint.Style.FILL);</span><br><span class="line">        mPaint2 = <span class="keyword">new</span> Paint();</span><br><span class="line">        mPaint2.setColor(Color.YELLOW);</span><br><span class="line">        mPaint2.setStyle(Paint.Style.FILL);</span><br><span class="line">        <span class="comment">//绘制外层矩形</span></span><br><span class="line">        canvas.drawRect(<span class="number">0</span>,<span class="number">0</span>,getMeasuredWidth(),getMeasuredHeight(),mPaint1);</span><br><span class="line">        <span class="comment">//绘制内层矩形</span></span><br><span class="line">        canvas.drawRect(<span class="number">10</span>,<span class="number">10</span>,getMeasuredWidth()-<span class="number">10</span>,getMeasuredHeight()-<span class="number">10</span>,mPaint2);</span><br><span class="line">        canvas.save();</span><br><span class="line">        <span class="comment">//绘制文字前平移10像素</span></span><br><span class="line">        canvas.translate(<span class="number">50</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="comment">//父类完成的方法，即绘制文本</span></span><br><span class="line">        <span class="keyword">super</span>.onDraw(canvas);</span><br><span class="line">        <span class="comment">//在回调父类方法后，实现自己的逻辑，对TextView来说就是绘制文件内容后</span></span><br><span class="line">        canvas.restore();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//文字闪烁</span></span><br><span class="line">        <span class="keyword">if</span> (mGradientMatrix !=<span class="keyword">null</span>)&#123;</span><br><span class="line">            mTranslate += mViewWidth/<span class="number">5</span>;</span><br><span class="line">            <span class="keyword">if</span> (mTranslate&gt;<span class="number">2</span>*mViewWidth)&#123;</span><br><span class="line">                mTranslate=-mViewWidth;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//通过矩阵的不断平移</span></span><br><span class="line">            mGradientMatrix.setTranslate(mTranslate,<span class="number">0</span>);</span><br><span class="line">            mLinearGradient.setLocalMatrix(mGradientMatrix);</span><br><span class="line">            postInvalidateDelayed(<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSizeChanged</span><span class="params">(<span class="keyword">int</span> w, <span class="keyword">int</span> h, <span class="keyword">int</span> oldw, <span class="keyword">int</span> oldh)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onSizeChanged(w, h, oldw, oldh);</span><br><span class="line">        <span class="keyword">if</span> (mViewWidth == <span class="number">0</span>)&#123;</span><br><span class="line">            mViewWidth = getMeasuredWidth();</span><br><span class="line">            <span class="keyword">if</span> (mViewWidth&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">//获取当前绘制Textview的Paint对象，并给这个对象设置LinearGradient属性。</span></span><br><span class="line">                mPaint = getPaint();</span><br><span class="line">                mLinearGradient = <span class="keyword">new</span> LinearGradient(<span class="number">0</span>,<span class="number">0</span>,mViewWidth,<span class="number">0</span>,<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;Color.BLUE,<span class="number">0xffffffff</span>,Color.YELLOW&#125;,<span class="keyword">null</span>,Shader.TileMode.CLAMP);</span><br><span class="line">                mPaint.setShader(mLinearGradient);</span><br><span class="line">                mGradientMatrix = <span class="keyword">new</span> Matrix();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="3-6-2-复合控件"><a href="#3-6-2-复合控件" class="headerlink" title="3.6.2.复合控件"></a>3.6.2.复合控件</h5><p>创建复合控件可以很好地创建出具有重用功能的控件集合。这种方式通常需要继承一个合适的ViewGroup，再给它添加指定功能的控件，从而组合成新的复合控件。通过这种方式创建的控件，我们一般会给它指定一些可配置的属性，让它具有更强的拓展性。</p>
<h6 id="定义属性"><a href="#定义属性" class="headerlink" title="定义属性"></a>定义属性</h6><blockquote>
<p>可定制性，通过调用不同的属性实现不同的效果</p>
</blockquote>
<p>values/attrs.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--我们在代码中通过&lt;declare-styleable&gt;标签声明了使用自定义属性，</span></span><br><span class="line"><span class="comment">    并通过name属性来确定引用的名称。</span></span><br><span class="line"><span class="comment">    最后，通过&lt;attr&gt;标签来声明具体的自定义属性，</span></span><br><span class="line"><span class="comment">    比如在这里定义了标题文字的字体、大小、颜色，左边按钮的文字颜色、背景、字体，右边按钮的文字颜色、背景、字体等属性，</span></span><br><span class="line"><span class="comment">    并通过format属性来指定属性的类型。这里需要注意的就是，有些属性可以是颜色属性，也可以是引用属性。</span></span><br><span class="line"><span class="comment">    比如按钮的背景，可以把它指定为具体的颜色，也可以把它指定为一张图片，所以使用“”来分隔不同的属性—“reference|color”。--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span> = <span class="string">&quot;TopBar&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span> <span class="attr">format</span> = <span class="string">&quot;string&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;titleTextSize&quot;</span> <span class="attr">format</span> = <span class="string">&quot;dimension&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;titleTextColor&quot;</span> <span class="attr">format</span> = <span class="string">&quot;color&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;leftTextColor&quot;</span> <span class="attr">format</span> = <span class="string">&quot;color&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;leftBackground&quot;</span> <span class="attr">format</span> = <span class="string">&quot;reference|color&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;leftText&quot;</span> <span class="attr">format</span> = <span class="string">&quot;string&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;rightTextColor&quot;</span> <span class="attr">format</span> = <span class="string">&quot;color&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;rightBackground&quot;</span> <span class="attr">format</span> = <span class="string">&quot;reference|color&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;rightText&quot;</span> <span class="attr">format</span> = <span class="string">&quot;string&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>获取属性集，并设置属性值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.customview;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.res.TypedArray;</span><br><span class="line"><span class="keyword">import</span> android.graphics.drawable.Drawable;</span><br><span class="line"><span class="keyword">import</span> android.util.AttributeSet;</span><br><span class="line"><span class="keyword">import</span> android.widget.RelativeLayout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TopBar</span> <span class="keyword">extends</span> <span class="title">RelativeLayout</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mLeftTextColor;</span><br><span class="line">    <span class="keyword">private</span> Drawable mLeftBackground;</span><br><span class="line">    <span class="keyword">private</span> String mLeftText;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mRightTextColor;</span><br><span class="line">    <span class="keyword">private</span> Drawable mRightBackground;</span><br><span class="line">    <span class="keyword">private</span> String mRightText;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String mTitle;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mTitleTextColor;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mTitleTextSize;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TopBar</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        <span class="comment">//通过TypedArray 数据结构来获取自定义属性集，通过getString，getColor方法获得定义的属性值</span></span><br><span class="line">        TypedArray typedArray = context.obtainStyledAttributes(attrs, R.styleable.TopBar);</span><br><span class="line">        <span class="comment">//从通过TypedArray中取出对应的值来为要设置的属性赋值</span></span><br><span class="line">        mLeftTextColor = typedArray.getColor(R.styleable.TopBar_leftTextColor, <span class="number">0</span>);</span><br><span class="line">        mLeftBackground = typedArray.getDrawable(R.styleable.TopBar_leftBackground);</span><br><span class="line">        mLeftText = typedArray.getString(R.styleable.TopBar_leftText);</span><br><span class="line"></span><br><span class="line">        mRightTextColor = typedArray.getColor(R.styleable.TopBar_rightTextColor, <span class="number">0</span>);</span><br><span class="line">        mRightBackground = typedArray.getDrawable(R.styleable.TopBar_rightBackground);</span><br><span class="line">        mRightText = typedArray.getString(R.styleable.TopBar_rightText);</span><br><span class="line"></span><br><span class="line">        mTitle = typedArray.getString(R.styleable.TopBar_title);</span><br><span class="line">        mTitleTextColor = typedArray.getColor(R.styleable.TopBar_titleTextColor, <span class="number">0</span>);</span><br><span class="line">        mTitleTextSize = typedArray.getDimension(R.styleable.TopBar_titleTextSize, <span class="number">10</span>);</span><br><span class="line">        <span class="comment">//获取完TypedArray的值之后，一般要调用recyle方法来避免重新创建的时候的错误</span></span><br><span class="line">        typedArray.recycle();<span class="comment">//资源释放，回收</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="组合控件"><a href="#组合控件" class="headerlink" title="组合控件"></a>组合控件</h6><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.customview;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.res.TypedArray;</span><br><span class="line"><span class="keyword">import</span> android.graphics.drawable.Drawable;</span><br><span class="line"><span class="keyword">import</span> android.util.AttributeSet;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> android.view.Gravity;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.RelativeLayout;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TopBar</span> <span class="keyword">extends</span> <span class="title">RelativeLayout</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">&quot;TopBar&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mLeftTextColor;</span><br><span class="line">    <span class="keyword">private</span> Drawable mLeftBackground;</span><br><span class="line">    <span class="keyword">private</span> String mLeftText;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mRightTextColor;</span><br><span class="line">    <span class="keyword">private</span> Drawable mRightBackground;</span><br><span class="line">    <span class="keyword">private</span> String mRightText;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String mTitle;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mTitleTextColor;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mTitleTextSize;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Button mLeftButton;</span><br><span class="line">    <span class="keyword">private</span> Button mRightButton;</span><br><span class="line">    <span class="keyword">private</span> TextView mTitleView;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LayoutParams mLeftParams;</span><br><span class="line">    <span class="keyword">private</span> LayoutParams mRightParams;</span><br><span class="line">    <span class="keyword">private</span> LayoutParams mTitleParams;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> OnTopBarClickListener mListener;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TopBar</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TopBar</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TopBar</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        <span class="comment">//通过TypedArray 数据结构来获取自定义属性集，通过getString，getColor方法获得定义的属性值</span></span><br><span class="line">        TypedArray typedArray = context.obtainStyledAttributes(attrs, R.styleable.TopBar);</span><br><span class="line">        <span class="comment">//从通过TypedArray中取出对应的值来为要设置的属性赋值</span></span><br><span class="line">        mLeftTextColor = typedArray.getColor(R.styleable.TopBar_leftTextColor, <span class="number">0</span>);</span><br><span class="line">        mLeftBackground = typedArray.getDrawable(R.styleable.TopBar_leftBackground);</span><br><span class="line">        mLeftText = typedArray.getString(R.styleable.TopBar_leftText);</span><br><span class="line">        Log.i(TAG, <span class="string">&quot;zhangtao: mLeftText:&quot;</span>+mLeftText.toString());</span><br><span class="line"></span><br><span class="line">        mRightTextColor = typedArray.getColor(R.styleable.TopBar_rightTextColor, <span class="number">0</span>);</span><br><span class="line">        mRightBackground = typedArray.getDrawable(R.styleable.TopBar_rightBackground);</span><br><span class="line">        mRightText = typedArray.getString(R.styleable.TopBar_rightText);</span><br><span class="line">        Log.i(TAG, <span class="string">&quot;zhangtao: mLeftText:&quot;</span>+mRightText.toString());</span><br><span class="line"></span><br><span class="line">        mTitle = typedArray.getString(R.styleable.TopBar_title);</span><br><span class="line">        mTitleTextColor = typedArray.getColor(R.styleable.TopBar_titleTextColor, <span class="number">0</span>);</span><br><span class="line">        mTitleTextSize = typedArray.getDimension(R.styleable.TopBar_titleTextSize, <span class="number">10</span>);</span><br><span class="line">        <span class="comment">//获取完TypedArray的值之后，一般要调用recyle方法来避免重新创建的时候的错误</span></span><br><span class="line">        typedArray.recycle();<span class="comment">//资源释放，回收</span></span><br><span class="line">        <span class="comment">//initTopBar(context);</span></span><br><span class="line">        mLeftButton = <span class="keyword">new</span> Button(context);</span><br><span class="line">        mRightButton = <span class="keyword">new</span> Button(context);</span><br><span class="line">        mTitleView = <span class="keyword">new</span> TextView(context);</span><br><span class="line">        <span class="comment">//为创建的组件元素赋值</span></span><br><span class="line">        <span class="comment">//值来源于引用的xml文件中对应属性的赋值</span></span><br><span class="line">        mLeftButton.setTextColor(mLeftTextColor);</span><br><span class="line">        mLeftButton.setBackground(mLeftBackground);</span><br><span class="line">        mLeftButton.setText(mLeftText);</span><br><span class="line"></span><br><span class="line">        mRightButton.setTextColor(mRightTextColor);</span><br><span class="line">        mRightButton.setBackground(mRightBackground);</span><br><span class="line">        mRightButton.setText(mRightText);</span><br><span class="line"></span><br><span class="line">        mTitleView.setText(mTitle);</span><br><span class="line">        mTitleView.setTextColor(mTitleTextColor);</span><br><span class="line">        mTitleView.setTextSize(mTitleTextSize);</span><br><span class="line">        mTitleView.setGravity(Gravity.CENTER);</span><br><span class="line"></span><br><span class="line">        initTopBar(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initTopBar</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">/*if (getParent()!=null)&#123;</span></span><br><span class="line"><span class="comment">            Log.i(TAG, &quot;initTopBar: zhangtao ,not null&quot;);</span></span><br><span class="line"><span class="comment">            removeAllViews();</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        removeAllViews();*/</span></span><br><span class="line">        <span class="comment">//为组件元素设置相应的布局元素</span></span><br><span class="line">        mLeftParams = <span class="keyword">new</span> LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.MATCH_PARENT);</span><br><span class="line">        mLeftParams.addRule(ALIGN_PARENT_LEFT,TRUE);</span><br><span class="line">        <span class="comment">//添加到ViewGroup</span></span><br><span class="line">        addView(mLeftButton, mLeftParams);</span><br><span class="line"></span><br><span class="line">        mRightParams = <span class="keyword">new</span> LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.MATCH_PARENT);</span><br><span class="line">        mRightParams.addRule(ALIGN_PARENT_RIGHT,TRUE);</span><br><span class="line">        <span class="comment">//getParent();</span></span><br><span class="line">        addView(mRightButton, mRightParams);</span><br><span class="line"></span><br><span class="line">        mTitleParams = <span class="keyword">new</span> LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.MATCH_PARENT);</span><br><span class="line">        mTitleParams.addRule(CENTER_IN_PARENT,TRUE);</span><br><span class="line">        addView(mTitleView,mTitleParams);</span><br><span class="line">        <span class="comment">//暴露接口给调用者</span></span><br><span class="line">        <span class="comment">/*按钮的点击事件，不需要具体的实现，只需要调用接口的方法，回调的时候，会有具体的实现*/</span></span><br><span class="line">        mRightButton.setOnClickListener(<span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (mListener !=<span class="keyword">null</span>) &#123;</span><br><span class="line">                    mListener.rightClick();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        mLeftButton.setOnClickListener(<span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (mListener!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                    mListener.leftClick();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*暴露一个方法给调用者来注册接口回调</span></span><br><span class="line"><span class="comment">    * 通过接口来获得回调者对接口发方法的实现*/</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setonTopBarClickListener</span><span class="params">(OnTopBarClickListener mListener)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mListener = mListener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*设*/</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setButtonVisable</span><span class="params">(<span class="keyword">int</span> id,<span class="keyword">boolean</span> flag)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">            <span class="keyword">if</span> (id == <span class="number">0</span>) &#123;</span><br><span class="line">                mLeftButton.setVisibility(View.VISIBLE);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mRightButton.setVisibility(VISIBLE);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (id == <span class="number">0</span>) &#123;</span><br><span class="line">                mLeftButton.setVisibility(GONE);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mRightButton.setVisibility(GONE);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="定义接口"><a href="#定义接口" class="headerlink" title="定义接口"></a>定义接口</h6><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//接口对象，实现回调机制，在回调方法中</span></span><br><span class="line"><span class="comment">//通过映射的接口对象调用接口中的方法</span></span><br><span class="line"><span class="comment">//而不用去考虑如何实现，具体的实现由调用者去创建</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnTopBarClickListener</span> </span>&#123;</span><br><span class="line">    <span class="comment">//左按钮点击事件</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">leftClick</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//右按钮点击事件</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rightClick</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="引用UI模板"><a href="#引用UI模板" class="headerlink" title="引用UI模板"></a>引用UI模板</h6><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">com.example.customview.TopBar</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/topBar&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:leftBackground</span>=<span class="string">&quot;@drawable/ic_launcher_background&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:leftText</span>=<span class="string">&quot;Back&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:leftTextColor</span>=<span class="string">&quot;#FFFFFF&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:rightBackground</span>=<span class="string">&quot;@color/design_default_color_error&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:rightText</span>=<span class="string">&quot;More&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:rightTextColor</span>=<span class="string">&quot;#FFFFFF&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:title</span>=<span class="string">&quot;自定义标题&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:titleTextColor</span>=<span class="string">&quot;#123412&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:titleTextSize</span>=<span class="string">&quot;10sp&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">com.example.customview.TopBar</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h6><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.customview;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.pm.ApplicationInfo;</span><br><span class="line"><span class="keyword">import</span> android.content.pm.PackageManager;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> PackageManager pm;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        TopBar mTopBar = (TopBar)findViewById(R.id.topBar);</span><br><span class="line">        mTopBar.setonTopBarClickListener(<span class="keyword">new</span> OnTopBarClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">leftClick</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>,<span class="string">&quot;left&quot;</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rightClick</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>,<span class="string">&quot;right&quot;</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        mTopBar.setButtonVisable(<span class="number">0</span>,<span class="keyword">true</span>);</span><br><span class="line">        mTopBar.setButtonVisable(<span class="number">1</span>,<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">float</span> type = ApplicationInfo.FLAG_SYSTEM;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;PMAppInfo&gt; <span class="title">getAppInfo</span><span class="params">(<span class="keyword">int</span> flag)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//获取packageManager对象</span></span><br><span class="line">        pm = <span class="keyword">this</span>.getPackageManager();</span><br><span class="line">        <span class="comment">//获取应用信息</span></span><br><span class="line">        List&lt;ApplicationInfo&gt; listApplications = pm.getInstalledApplications(PackageManager.GET_UNINSTALLED_PACKAGES);</span><br><span class="line">        List&lt;PMAppInfo&gt; appInfos = <span class="keyword">new</span> ArrayList&lt;PMAppInfo&gt;();</span><br><span class="line">        <span class="comment">//判断类型</span></span><br><span class="line">        <span class="keyword">switch</span> (flag) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> appInfos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-重写View实现全新的控件"><a href="#3-重写View实现全新的控件" class="headerlink" title="3.重写View实现全新的控件"></a>3.重写View实现全新的控件</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.customview;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Canvas;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Paint;</span><br><span class="line"><span class="keyword">import</span> android.graphics.RectF;</span><br><span class="line"><span class="keyword">import</span> android.util.AttributeSet;</span><br><span class="line"><span class="keyword">import</span> android.util.DisplayMetrics;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.Nullable;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 圆的半径是屏幕宽度的1/4，原点坐标x,y，值大小都是屏幕的1/2*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomView</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Context mContext;</span><br><span class="line">    <span class="comment">//圆画笔</span></span><br><span class="line">    <span class="keyword">private</span> Paint mCirclePaint;</span><br><span class="line">    <span class="comment">//xy坐标</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mCircleXY;</span><br><span class="line">    <span class="comment">//圆的半径</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mRadius;</span><br><span class="line">    <span class="comment">//屏幕宽度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mScreenWidth;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//文字画笔</span></span><br><span class="line">    <span class="keyword">private</span> Paint mTextPaint;</span><br><span class="line">    <span class="comment">//绘制文字</span></span><br><span class="line">    <span class="keyword">private</span> String mShowText = <span class="string">&quot;Android Skill&quot;</span>;</span><br><span class="line">    <span class="comment">//文字大小</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mShowTextSize = <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//圆弧的画笔</span></span><br><span class="line">    <span class="keyword">private</span> Paint mArcPaint;</span><br><span class="line">    <span class="comment">//圆弧扫过的角度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> sweepAngle;</span><br><span class="line">    <span class="comment">//矩形，用来辅助绘制圆弧</span></span><br><span class="line">    <span class="keyword">private</span> RectF mRectF;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomView</span><span class="params">(Context context, <span class="meta">@Nullable</span> AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        mContext = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onMeasure(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line">        mScreenWidth = getScreenWidth(mContext);</span><br><span class="line">        <span class="comment">//圆心坐标</span></span><br><span class="line">        mCircleXY = mScreenWidth/<span class="number">2f</span>;</span><br><span class="line">        mRadius = mScreenWidth / <span class="number">8f</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//圆弧扫过的角度，360度的66%</span></span><br><span class="line">        sweepAngle = <span class="number">66</span> / <span class="number">100f</span> * <span class="number">360f</span>;</span><br><span class="line">        initPaint();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*获取屏幕宽度*/</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getScreenWidth</span><span class="params">(Context activity)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*DisplayMetrics metrics = new DisplayMetrics();</span></span><br><span class="line"><span class="comment">        activity.getWindowManager().getDefaultDisplay().getRealMetrics(metrics);*/</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> activity.getResources().getDisplayMetrics().widthPixels;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*初始化画笔*/</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initPaint</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mCirclePaint = <span class="keyword">new</span> Paint();</span><br><span class="line">        <span class="comment">//画笔颜色</span></span><br><span class="line">        mCirclePaint.setColor(getResources().getColor(android.R.color.holo_blue_bright));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//文字画笔</span></span><br><span class="line">        mTextPaint = <span class="keyword">new</span> Paint();</span><br><span class="line">        <span class="comment">//颜色</span></span><br><span class="line">        mTextPaint.setColor(Color.BLACK);</span><br><span class="line">        <span class="comment">//文字大小</span></span><br><span class="line">        mTextPaint.setTextSize(mShowTextSize);</span><br><span class="line">        <span class="comment">//文字对齐</span></span><br><span class="line">        mTextPaint.setTextAlign(Paint.Align.CENTER);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//弧度的画笔</span></span><br><span class="line">        mArcPaint = <span class="keyword">new</span> Paint();</span><br><span class="line">        <span class="comment">//颜色</span></span><br><span class="line">        mArcPaint.setColor(getResources().getColor(android.R.color.holo_blue_bright));</span><br><span class="line">        <span class="comment">//描边</span></span><br><span class="line">        mArcPaint.setStyle(Paint.Style.STROKE);</span><br><span class="line">        <span class="comment">//描边宽度</span></span><br><span class="line">        mArcPaint.setStrokeWidth(mScreenWidth*<span class="number">0.1f</span>);</span><br><span class="line">        <span class="comment">//创建一个矩形，用来辅助绘制圆弧</span></span><br><span class="line">        mRectF = <span class="keyword">new</span> RectF(mScreenWidth*<span class="number">0.2f</span>,mScreenWidth*<span class="number">0.2f</span>,mScreenWidth*<span class="number">0.8f</span>,mScreenWidth*<span class="number">0.8f</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDraw(canvas);</span><br><span class="line">        <span class="comment">//绘制圆</span></span><br><span class="line">        <span class="comment">/* 绘制圆</span></span><br><span class="line"><span class="comment">         第一个参数是 圆心的 x 坐标</span></span><br><span class="line"><span class="comment">         第二个参数是 圆心的 y 坐标</span></span><br><span class="line"><span class="comment">         第三个参数是 圆的半径</span></span><br><span class="line"><span class="comment">         第四个参数是 画笔*/</span></span><br><span class="line">        canvas.drawCircle(mCircleXY,mCircleXY,mRadius,mCirclePaint);</span><br><span class="line">        <span class="comment">//绘制文字</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 第一个参数是 要绘制的文字内容</span></span><br><span class="line"><span class="comment">         * 第二个参数是 要绘制的文字中第一个字符的索引</span></span><br><span class="line"><span class="comment">         * 第三个参数是 要绘制的文字中最后一个字符的索引减去一</span></span><br><span class="line"><span class="comment">         * 第四个参数是 要绘制文字的原点的 x 坐标</span></span><br><span class="line"><span class="comment">         * 第五个参数是 要绘制文字的原点的 y 坐标</span></span><br><span class="line"><span class="comment">         * 第六个参数是 画笔 */</span></span><br><span class="line">        canvas.drawText(mShowText,<span class="number">0</span>,mShowText.length(),mCircleXY,mCircleXY+mShowTextSize/<span class="number">4</span>,mTextPaint);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//绘制圆弧</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 第一个参数是 椭圆的边界，用来定义弧形的形状和大小</span></span><br><span class="line"><span class="comment">         * 第二个参数是 圆弧的起始角度</span></span><br><span class="line"><span class="comment">         * 第三个参数是 圆弧扫过的角度</span></span><br><span class="line"><span class="comment">         * 第四个参数是 这个参数如果为 true，就把椭圆的中心包括在圆弧中</span></span><br><span class="line"><span class="comment">         * 第五个参数是 画笔</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        canvas.drawArc(mRectF,<span class="number">270</span>,sweepAngle,<span class="keyword">false</span>,mArcPaint);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-8-事件拦截机制分析"><a href="#3-8-事件拦截机制分析" class="headerlink" title="3.8 事件拦截机制分析"></a>3.8 事件拦截机制分析</h4><p><code>dispatchTouchEvent</code>:决定了事件是否继续分发下去和是否响应事件，false：继续分发，true：不继续分发，此次事件到此结束，也不会有任何控件执行<code>onTouchEvent</code>方法。</p>
<p><code>onInterceptTouchEvent</code>：决定了是否拦截该事件，false：不拦截，true：拦截，此时当前控件执行<code>onTouchEvent</code>方法。</p>
<p><code>onTouchEvent</code>：决定了是否消费该事件，false：不消费,true：消费。</p>
<h5 id="OnTouchListener、OnTouchEvent、OnClickListener事件分发顺序"><a href="#OnTouchListener、OnTouchEvent、OnClickListener事件分发顺序" class="headerlink" title="OnTouchListener、OnTouchEvent、OnClickListener事件分发顺序"></a><code>OnTouchListener</code>、<code>OnTouchEvent</code>、<code>OnClickListener</code>事件分发顺序</h5><p>1、调用顺序，<code>OnTouchListener.onTouch()</code>—&gt; <code>onTouchEvent()</code>—&gt;<code>OnClickListener.onClick()</code>，其中若<code>onTouch</code>返回值为<strong>true</strong>，则会屏蔽掉<strong>onTouchEvent</strong>方法和<strong>OnClickListener</strong>.onClick方法，若<strong>onTouchEvent</strong>方法可以被调用，则<strong>OnClickListener</strong>.onClick方法也一定可以被调用。</p>
<p>2、一系列点击事件，肯定是以down事件开始，以up事件结束，中间若干个move事件。如果一旦某个元素拦截了某个事件，那么同一个事件序列内的所有事件都会直接交给它处理。（详见Android开发艺术探索P142)</p>
<p>3、首先，考虑<code>OnTouchListener.onTouch</code>返回的是false，此种情况下，首先down事件按照顺序先经过OnTouchListener.onTouch方法，由于返回false不屏蔽onTouchEvent方法，所以又被分发到onTouchEvent方法，由于该方法默认返回true（详见Android开发艺术探索P143），即消费了down事件，所以此后的所有事件都由该方法处理，并且不再经过OnTouchListener.onTouch。可以看下图log证实了这点，当手指试图滑动时，down事件分别经过两个方法，其他的事件只经过onTouchEventx</p>
<h5 id="滑动冲突-分为三种"><a href="#滑动冲突-分为三种" class="headerlink" title="滑动冲突:分为三种"></a>滑动冲突:分为三种</h5><p>1.外部滑动方向和内部滑动方向不一致</p>
<p>典型一个左右滑动的Viewpager+上下滑动的Fragment(Viewpager已经处理了滑动冲突)</p>
<p>2.外部滑动方向和内部滑动方向一致</p>
<p>3.上述两种情况的嵌套</p>
<p>对于情况一,判断用户是上下滑动还是左右滑动,可以根据角度,距离差,速度差来进行判断</p>
<p>对于情况二,要根据业务情况来处理规则</p>
<ul>
<li><p>外部拦截法:父容器覆写onIntercepted方法,根据情况是否拦截消耗事件(通常选用该方法)</p>
</li>
<li><p>内部拦截法:父容器不做处理,由子控件是否拦截和消耗(要配合requestDisallowInterceptTouchEvent()来使用,父容器不能拦截ACTION_DOWN,因为该事件不受requestDisallowInterceptTouchEvent()控制</p>
</li>
</ul>
<h3 id="第4章-ListView使用技巧"><a href="#第4章-ListView使用技巧" class="headerlink" title="第4章 ListView使用技巧"></a>第4章 ListView使用技巧</h3><h3 id="第5章Android-Scroll分析"><a href="#第5章Android-Scroll分析" class="headerlink" title="第5章Android Scroll分析"></a>第5章Android Scroll分析</h3><h3 id="第6章Android绘图机制与处理技巧"><a href="#第6章Android绘图机制与处理技巧" class="headerlink" title="第6章Android绘图机制与处理技巧"></a>第6章Android绘图机制与处理技巧</h3><h3 id="第7章Android动画机制与使用技巧"><a href="#第7章Android动画机制与使用技巧" class="headerlink" title="第7章Android动画机制与使用技巧"></a>第7章Android动画机制与使用技巧</h3><h3 id="第8章Activity与Activity调用栈分析"><a href="#第8章Activity与Activity调用栈分析" class="headerlink" title="第8章Activity与Activity调用栈分析"></a>第8章Activity与Activity调用栈分析</h3><h4 id="8-1-Activity"><a href="#8-1-Activity" class="headerlink" title="8.1 Activity"></a>8.1 Activity</h4><h3 id="第9章Android系统信息与安全机制"><a href="#第9章Android系统信息与安全机制" class="headerlink" title="第9章Android系统信息与安全机制"></a>第9章Android系统信息与安全机制</h3><h4 id="9-1-Android系统信息获取"><a href="#9-1-Android系统信息获取" class="headerlink" title="9.1 Android系统信息获取"></a>9.1 Android系统信息获取</h4><ul>
<li>android.os.Build</li>
<li>SystemProperty（存储设置软硬件信息的类）</li>
</ul>
<h4 id="9-2-Apk应用信息的获取"><a href="#9-2-Apk应用信息的获取" class="headerlink" title="9.2 Apk应用信息的获取"></a>9.2 Apk应用信息的获取</h4><ul>
<li>PM（PackagerManager），应用的包管理</li>
<li>AM (ActivityManager)，应用的活动管理</li>
</ul>
<p><img src="https://s2.loli.net/2022/08/07/RYQx4sAkyNCJnIg.png" alt="Packager结构"></p>
<p>Activity信息使用ActivityInfo类来进行封装</p>
<p>Maninifest文件中的节点的信息，使用PackageInfo来进行封装</p>
<h3 id="第10章Android性能优化"><a href="#第10章Android性能优化" class="headerlink" title="第10章Android性能优化"></a>第10章Android性能优化</h3><h3 id="第11章搭建云端服务器"><a href="#第11章搭建云端服务器" class="headerlink" title="第11章搭建云端服务器"></a>第11章搭建云端服务器</h3><h3 id="第12章Android-5-X新特性详解"><a href="#第12章Android-5-X新特性详解" class="headerlink" title="第12章Android 5.X新特性详解"></a>第12章Android 5.X新特性详解</h3><h3 id="第13章-Android实例提高"><a href="#第13章-Android实例提高" class="headerlink" title="第13章 Android实例提高"></a>第13章 Android实例提高</h3>

	<div class="row">
    <embed src="https://maipdf.cn/pdf/a82246713196@pdf" width="100%" height="550" type="application/pdf">
	</div>






	<div class="row">
    <embed src="https://maipdf.cn/pdf/a86321716085@pdf" width="100%" height="550" type="application/pdf">
	</div>


</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">XKADPZ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://dpzxka.github.io/2022/08/08/Android/Android%20%E7%BE%A4%E8%8B%B1%E4%BC%A0%20%E6%80%BB%E7%BB%93%E8%AE%B0%E5%BD%95/">https://dpzxka.github.io/2022/08/08/Android/Android%20%E7%BE%A4%E8%8B%B1%E4%BC%A0%20%E6%80%BB%E7%BB%93%E8%AE%B0%E5%BD%95/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://dpzxka.github.io" target="_blank">小白兔与小猪猪</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/android/">android</a></div><div class="post_share"><div class="social-share" data-image="/img/author.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/07/28/Android/Android%2033%E8%AE%B2/"><img class="prev-cover" src="/img/author.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Android 33讲</div></div></a></div><div class="next-post pull-right"><a href="/2022/08/16/Android/Android%E5%BC%80%E5%8F%91%E8%89%BA%E6%9C%AF%E6%8E%A2%E7%B4%A2_2_IPC%E6%9C%BA%E5%88%B6/"><img class="next-cover" src="/img/author.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Android开发艺术探索_2_IPC机制</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/02/13/Android/%E7%AC%AC%E4%BA%94%E7%AB%A0%20%E5%B9%BF%E6%92%AD%E6%9C%BA%E5%88%B6/" title="Android之广播机制(五)"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-13</div><div class="title">Android之广播机制(五)</div></div></a></div><div><a href="/2022/02/13/Android/%E7%AC%AC%E5%85%AD%E7%AB%A0%20%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/" title="Android之数据存储(六)"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-13</div><div class="title">Android之数据存储(六)</div></div></a></div><div><a href="/2022/04/22/Android/Android%E7%9F%A5%E8%AF%86%E7%82%B9/" title="Android 知识点"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-22</div><div class="title">Android 知识点</div></div></a></div><div><a href="/2022/07/08/Android/Android%20%E9%9D%A2%E8%AF%95/" title="Android 面试宝典"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-08</div><div class="title">Android 面试宝典</div></div></a></div><div><a href="/2022/07/28/Android/Android%2033%E8%AE%B2/" title="Android 33讲"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-28</div><div class="title">Android 33讲</div></div></a></div><div><a href="/2022/08/16/Android/Android%E5%BC%80%E5%8F%91%E8%89%BA%E6%9C%AF%E6%8E%A2%E7%B4%A2_10_Android%E7%9A%84%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6/" title="Android开发艺术探索_10_Android的消息机制"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">Android开发艺术探索_10_Android的消息机制</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%A4%E8%8B%B1%E4%BC%A0"><span class="toc-number">1.</span> <span class="toc-text">群英传</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC1%E7%AB%A0Android%E4%BD%93%E7%B3%BB%E4%B8%8E%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">第1章Android体系与系统架构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84"><span class="toc-number">1.1.1.</span> <span class="toc-text">系统架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#App%E7%BB%84%E4%BB%B6%E6%9E%B6%E6%9E%84"><span class="toc-number">1.1.2.</span> <span class="toc-text">App组件架构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC2%E7%AB%A0Android%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E6%96%B0%E6%8E%A5%E8%A7%A6"><span class="toc-number">1.2.</span> <span class="toc-text">第2章Android开发工具新接触</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ADB%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7"><span class="toc-number">1.2.1.</span> <span class="toc-text">ADB命令使用技巧</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC3%E7%AB%A0Android%E6%8E%A7%E4%BB%B6%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.3.</span> <span class="toc-text">第3章Android控件架构与自定义控件详解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-Android%E6%8E%A7%E4%BB%B6%E6%9E%B6%E6%9E%84"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 Android控件架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-View%E7%9A%84%E6%B5%8B%E9%87%8F"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 View的测量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-View%E7%9A%84%E7%BB%98%E5%88%B6"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 View的绘制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-ViewGroup%E7%9A%84%E6%B5%8B%E9%87%8F"><span class="toc-number">1.3.4.</span> <span class="toc-text">3.4 ViewGroup的测量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-ViewGroup%E7%9A%84%E7%BB%98%E5%88%B6"><span class="toc-number">1.3.5.</span> <span class="toc-text">3.5 ViewGroup的绘制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-%E8%87%AA%E5%AE%9A%E4%B9%89View"><span class="toc-number">1.3.6.</span> <span class="toc-text">3.6 自定义View</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-61-%E7%8E%B0%E6%9C%89%E6%8E%A7%E4%BB%B6%E6%8B%93%E5%B1%95"><span class="toc-number">1.3.6.1.</span> <span class="toc-text">3.61. 现有控件拓展</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-6-2-%E5%A4%8D%E5%90%88%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.3.6.2.</span> <span class="toc-text">3.6.2.复合控件</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7"><span class="toc-number">1.3.6.2.1.</span> <span class="toc-text">定义属性</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.3.6.2.2.</span> <span class="toc-text">组合控件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.3.6.2.3.</span> <span class="toc-text">定义接口</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%BC%95%E7%94%A8UI%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.3.6.2.4.</span> <span class="toc-text">引用UI模板</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%B0%83%E7%94%A8"><span class="toc-number">1.3.6.2.5.</span> <span class="toc-text">调用</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E9%87%8D%E5%86%99View%E5%AE%9E%E7%8E%B0%E5%85%A8%E6%96%B0%E7%9A%84%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.3.6.3.</span> <span class="toc-text">3.重写View实现全新的控件</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-%E4%BA%8B%E4%BB%B6%E6%8B%A6%E6%88%AA%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90"><span class="toc-number">1.3.7.</span> <span class="toc-text">3.8 事件拦截机制分析</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#OnTouchListener%E3%80%81OnTouchEvent%E3%80%81OnClickListener%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.3.7.1.</span> <span class="toc-text">OnTouchListener、OnTouchEvent、OnClickListener事件分发顺序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%BB%91%E5%8A%A8%E5%86%B2%E7%AA%81-%E5%88%86%E4%B8%BA%E4%B8%89%E7%A7%8D"><span class="toc-number">1.3.7.2.</span> <span class="toc-text">滑动冲突:分为三种</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC4%E7%AB%A0-ListView%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7"><span class="toc-number">1.4.</span> <span class="toc-text">第4章 ListView使用技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC5%E7%AB%A0Android-Scroll%E5%88%86%E6%9E%90"><span class="toc-number">1.5.</span> <span class="toc-text">第5章Android Scroll分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC6%E7%AB%A0Android%E7%BB%98%E5%9B%BE%E6%9C%BA%E5%88%B6%E4%B8%8E%E5%A4%84%E7%90%86%E6%8A%80%E5%B7%A7"><span class="toc-number">1.6.</span> <span class="toc-text">第6章Android绘图机制与处理技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC7%E7%AB%A0Android%E5%8A%A8%E7%94%BB%E6%9C%BA%E5%88%B6%E4%B8%8E%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7"><span class="toc-number">1.7.</span> <span class="toc-text">第7章Android动画机制与使用技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC8%E7%AB%A0Activity%E4%B8%8EActivity%E8%B0%83%E7%94%A8%E6%A0%88%E5%88%86%E6%9E%90"><span class="toc-number">1.8.</span> <span class="toc-text">第8章Activity与Activity调用栈分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-Activity"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1 Activity</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC9%E7%AB%A0Android%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E4%B8%8E%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6"><span class="toc-number">1.9.</span> <span class="toc-text">第9章Android系统信息与安全机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-Android%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96"><span class="toc-number">1.9.1.</span> <span class="toc-text">9.1 Android系统信息获取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-Apk%E5%BA%94%E7%94%A8%E4%BF%A1%E6%81%AF%E7%9A%84%E8%8E%B7%E5%8F%96"><span class="toc-number">1.9.2.</span> <span class="toc-text">9.2 Apk应用信息的获取</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC10%E7%AB%A0Android%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">1.10.</span> <span class="toc-text">第10章Android性能优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC11%E7%AB%A0%E6%90%AD%E5%BB%BA%E4%BA%91%E7%AB%AF%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.11.</span> <span class="toc-text">第11章搭建云端服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC12%E7%AB%A0Android-5-X%E6%96%B0%E7%89%B9%E6%80%A7%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.12.</span> <span class="toc-text">第12章Android 5.X新特性详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC13%E7%AB%A0-Android%E5%AE%9E%E4%BE%8B%E6%8F%90%E9%AB%98"><span class="toc-number">1.13.</span> <span class="toc-text">第13章 Android实例提高</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By XKADPZ</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">xkadpz的欢乐乐园</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>