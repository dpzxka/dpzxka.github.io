<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>4、自定义View | 小白兔与小猪猪</title><meta name="keywords" content="android"><meta name="author" content="XKADPZ"><meta name="copyright" content="XKADPZ"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="自定义View相关">
<meta property="og:type" content="article">
<meta property="og:title" content="4、自定义View">
<meta property="og:url" content="https://dpzxka.github.io/2022/09/13/Android/4%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89View/index.html">
<meta property="og:site_name" content="小白兔与小猪猪">
<meta property="og:description" content="自定义View相关">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dpzxka.github.io/img/author.jpeg">
<meta property="article:published_time" content="2022-09-12T16:00:00.000Z">
<meta property="article:modified_time" content="2022-09-13T15:13:57.991Z">
<meta property="article:author" content="XKADPZ">
<meta property="article:tag" content="android">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dpzxka.github.io/img/author.jpeg"><link rel="shortcut icon" href="/img/favicon_new.jpeg"><link rel="canonical" href="https://dpzxka.github.io/2022/09/13/Android/4%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89View/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":250},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: XKADPZ","link":"链接: ","source":"来源: 小白兔与小猪猪","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '4、自定义View',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-09-13 23:13:57'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/java/"><i class="fa-fw fa-brands fa-java"></i><span> Java</span></a></li><li><a class="site-page child" href="/android/"><i class="fa-fw fa-brands fa-android"></i><span> Android</span></a></li><li><a class="site-page child" href="/algorithm/"><i class="fa-fw fa-duotone fa-blanket"></i><span> algorithm</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/carbonEmission/"><i class="fa-fw fa-brands fa-cloudversify"></i><span> 碳排放</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/author.jpeg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小白兔与小猪猪</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/java/"><i class="fa-fw fa-brands fa-java"></i><span> Java</span></a></li><li><a class="site-page child" href="/android/"><i class="fa-fw fa-brands fa-android"></i><span> Android</span></a></li><li><a class="site-page child" href="/algorithm/"><i class="fa-fw fa-duotone fa-blanket"></i><span> algorithm</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/carbonEmission/"><i class="fa-fw fa-brands fa-cloudversify"></i><span> 碳排放</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">4、自定义View</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-09-12T16:00:00.000Z" title="发表于 2022-09-13 00:00:00">2022-09-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-09-13T15:13:57.991Z" title="更新于 2022-09-13 23:13:57">2022-09-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/android/">android</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">18.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>72分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="4、自定义View"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="4、-自定义View"><a href="#4、-自定义View" class="headerlink" title="4、 自定义View"></a>4、 自定义View</h1><h2 id="1、自定义View基础"><a href="#1、自定义View基础" class="headerlink" title="1、自定义View基础"></a>1、自定义View基础</h2><h3 id="1、视图定义"><a href="#1、视图定义" class="headerlink" title="1、视图定义"></a>1、视图定义</h3><p>显示在屏幕上的各种视图控件</p>
<h3 id="2、视图分类"><a href="#2、视图分类" class="headerlink" title="2、视图分类"></a>2、视图分类</h3><p>视图View主要分为两类：</p>
<ul>
<li>单一视图：即一个View、不包含子View，如TextView</li>
<li>视图组，即多个View组成的ViewGroup、包含子View，如LinearLayout</li>
</ul>
<p>Android中的UI组件都由View、ViewGroup共同组成。</p>
<h3 id="3、视图类简介"><a href="#3、视图类简介" class="headerlink" title="3、视图类简介"></a>3、视图类简介</h3><ul>
<li><p>视图的核心类是：View类</p>
</li>
<li><p>View类是Android中各种组件的基类，如View是ViewGroup基类</p>
</li>
<li><p>View的构造函数：共有4个，自定义View必须重写至少一个构造函数。具体如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 构造函数1</span></span><br><span class="line"><span class="comment">// 调用场景：View是在Java代码里面new的</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">CarsonView</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(context);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造函数2</span></span><br><span class="line"><span class="comment">// 调用场景：View是在.xml里声明的</span></span><br><span class="line"><span class="comment">// 自定义属性是从AttributeSet参数传进来的</span></span><br><span class="line"><span class="function"><span class="keyword">public</span>  <span class="title">CarsonView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(context, attrs);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造函数3</span></span><br><span class="line"><span class="comment">// 应用场景：View有style属性时</span></span><br><span class="line"><span class="comment">// 一般是在第二个构造函数里主动调用；不会自动调用</span></span><br><span class="line"><span class="function"><span class="keyword">public</span>  <span class="title">CarsonView</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(context, attrs, defStyleAttr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造函数4</span></span><br><span class="line"><span class="comment">// 应用场景：View有style属性时、API21之后才使用</span></span><br><span class="line"><span class="comment">// 一般是在第二个构造函数里主动调用；不会自动调用</span></span><br><span class="line"><span class="function"><span class="keyword">public</span>  <span class="title">CarsonView</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr, <span class="keyword">int</span> defStyleRes)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(context, attrs, defStyleAttr, defStyleRes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2016/0806/4575.html">深入理解View的构造函数</a>和<a target="_blank" rel="noopener" href="http://www.cnblogs.com/angeldevil/p/3479431.html#three">理解View的构造函数</a></p>
</li>
</ul>
<h3 id="4、视图结构"><a href="#4、视图结构" class="headerlink" title="4、视图结构"></a>4、视图结构</h3><ul>
<li><p>对于包含子View的视图组（ViewGroup），<strong>结构是树形结构</strong></p>
</li>
<li><p>ViewGroup下可能有多个ViewGroup或View，如下图：</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/a0fed9306691fdfd64333c1e66350d10.png" alt="img"></p>
<blockquote>
<p>在View的绘制过程中，<strong>永远都是从View树结构的根节点开始(即从树的顶端开始)，一层一层、一个个分支地自上而下遍历进行（即树形递归）</strong>，最终计算整个View树中各个View，从而最终确定整个View树的相关属性。</p>
</blockquote>
</li>
</ul>
<h3 id="5-Android坐标系"><a href="#5-Android坐标系" class="headerlink" title="5. Android坐标系"></a>5. Android坐标系</h3><p>Android的坐标系定义为：</p>
<ul>
<li>屏幕的左上角为坐标原点</li>
<li>向右为x轴增大方向</li>
<li>向下为y轴增大方向</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/f2b54d093c9cce2235daa05dbf656a06.png" alt="img"></p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/1b18ace8b8c561d170695085e7561477.png" alt="img"></p>
<h3 id="6、View位置（坐标）描述"><a href="#6、View位置（坐标）描述" class="headerlink" title="6、View位置（坐标）描述"></a>6、View位置（坐标）描述</h3><p>视图的位置由四个顶点决定，ABCD</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/11e2f4559b67903b0b98c0d2e5883a19.png" alt="img"></p>
<p>视图的位置是相对于父控件而言的，四个顶点的位置描述分别由四个与父控件相关的值决定：</p>
<ul>
<li>顶部(Top)：视图上边界到父控件上边界的距离；</li>
<li>左边(Left)：视图左边界到父控件左边界的距离；</li>
<li>右边(Right)：视图右边界到父控件左边界的距离；</li>
<li>底部(Bottom)：视图下边界到父控件上边界的距离。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/19c38fb06a36868ce9a8d640cafbe4e4.png" alt="img"></p>
<h3 id="7-位置获取方式"><a href="#7-位置获取方式" class="headerlink" title="7. 位置获取方式"></a>7. 位置获取方式</h3><p>视图的位置获取是通过<code>View.getXXX()</code>方法进行获取。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">获取顶部距离(Top)：getTop()</span><br><span class="line">获取左边距离(Left)：getLeft()</span><br><span class="line">获取右边距离(Right)：getRight()</span><br><span class="line">获取底部距离(Bottom)：getBottom()</span><br></pre></td></tr></table></figure>

<p>MotionEvent中 <code>get()</code>和<code>getRaw()</code>的区别</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//get() ：触摸点相对于其所在组件坐标系的坐标</span></span><br><span class="line"> event.getX();       </span><br><span class="line"> event.getY();</span><br><span class="line"></span><br><span class="line"><span class="comment">//getRaw() ：触摸点相对于屏幕默认坐标系的坐标</span></span><br><span class="line"> event.getRawX();    </span><br><span class="line"> event.getRawY();</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/41c69d800d8145d59ae167b97426d516.png" alt="img"></p>
<h3 id="8-角度（angle）-amp-弧度（radian）"><a href="#8-角度（angle）-amp-弧度（radian）" class="headerlink" title="8. 角度（angle）&amp; 弧度（radian）"></a>8. 角度（angle）&amp; 弧度（radian）</h3><p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/0f9ea49aa3c1d8fbff428aa39eec89a9.png" alt="img"></p>
<h3 id="9、-颜色相关"><a href="#9、-颜色相关" class="headerlink" title="9、 颜色相关"></a>9、 颜色相关</h3><p><strong>颜色模式</strong></p>
<ul>
<li>ARGB8888：四通道高精度(32位)</li>
<li>ARGB4444：四通道低精度(16位)</li>
<li>RGB565：Android屏幕默认模式(16位)</li>
<li>Alpha8：仅有透明通道(8位)</li>
</ul>
<blockquote>
<p>字母：表示通道类型；</p>
<p>数值：表示该类型用多少位二进制来描述；</p>
<p>示例说明：ARGB8888，表示有四个通道(ARGB)；每个对应的通道均用8位来描述。</p>
<p>以ARGB8888为例介绍颜色定义:</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/f3032fb32cc755ffc1bc5220482bfa13.png" alt="img"></p>
</blockquote>
<p><strong>颜色的定义</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 定义方式1：xml</span></span><br><span class="line"><span class="comment">  * 在/res/values/color.xml文件中定义</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  &lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">  &lt;resources&gt;</span><br><span class="line">    <span class="comment">//定义了红色（没有alpha（透明）通道）</span></span><br><span class="line">    &lt;color name=<span class="string">&quot;red&quot;</span>&gt;#ff0000&lt;/color&gt;</span><br><span class="line">    <span class="comment">//定义了蓝色（没有alpha（透明）通道）</span></span><br><span class="line">    &lt;color name=<span class="string">&quot;green&quot;</span>&gt;#00ff00&lt;/color&gt;</span><br><span class="line">  &lt;/resources&gt;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 在xml文件中以”#“开头定义颜色，后面跟十六进制的值，有如下几种定义方式：</span></span><br><span class="line">  #f00  <span class="comment">//低精度 - 不带透明通道红色      </span></span><br><span class="line">  #af00 <span class="comment">//低精度 - 带透明通道红色        </span></span><br><span class="line">  #ff0000 <span class="comment">//高精度 - 不带透明通道红色          </span></span><br><span class="line">  #aaff0000 <span class="comment">//高精度 - 带透明通道红色       </span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 定义方式2：Java</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="comment">// 使用Color类定义颜色</span></span><br><span class="line">  <span class="keyword">int</span> color = Color.GRAY; <span class="comment">//灰色</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Color类使用ARGB值表示</span></span><br><span class="line">  <span class="keyword">int</span> color = Color.argb(<span class="number">127</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>); <span class="comment">//半透明红色   </span></span><br><span class="line">  <span class="keyword">int</span> color = <span class="number">0xaaff0000</span>; <span class="comment">//带有透明度的红色                                    </span></span><br></pre></td></tr></table></figure>

<p><strong>颜色的引用</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line">  * 引用方式1：xml</span><br><span class="line">  */</span><br><span class="line">  // 1. 在style文件中引用</span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;AppTheme&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;Theme.AppCompat.Light.DarkActionBar&quot;</span>&gt;</span><span class="xml"></span></span><br><span class="line"><span class="xml">       <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorPrimary&quot;</span>&gt;</span>@color/red<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  // 2. 在layout文件中引用</span><br><span class="line">  android:background=&quot;@color/red&quot;     </span><br><span class="line">  // 3. 在layout文件中创建并使用颜色</span><br><span class="line">  android:background=&quot;#ff0000&quot;       </span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">  * 引用方式2：Java</span><br><span class="line">  */</span><br><span class="line">  //方法1</span><br><span class="line">  int color = getResources().getColor(R.color.mycolor);</span><br><span class="line"></span><br><span class="line">  //方法2（API 23及以上）</span><br><span class="line">  int color = getColor(R.color.myColor);      </span><br></pre></td></tr></table></figure>



<h2 id="2、自定义View流程及特点-Measure过程、Layout过程、Draw过程"><a href="#2、自定义View流程及特点-Measure过程、Layout过程、Draw过程" class="headerlink" title="2、自定义View流程及特点:Measure过程、Layout过程、Draw过程"></a>2、自定义View流程及特点:Measure过程、Layout过程、Draw过程</h2><h3 id="1、基础"><a href="#1、基础" class="headerlink" title="1、基础"></a>1、基础</h3><h4 id="ViewRoot"><a href="#ViewRoot" class="headerlink" title="ViewRoot"></a>ViewRoot</h4><p>定义：连接器，对应于<code>ViewRootImpl</code>类</p>
<p>作用：连接<code>WindowManager</code>和<code>DecorView</code>，完成View的三大流程：<code>measure</code>、<code>layout</code>、<code>draw</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在主线程中，Activity对象被创建后：</span></span><br><span class="line"><span class="comment">// 1. 自动将DecorView添加到Window中 &amp; 创建ViewRootImpll对象</span></span><br><span class="line">root = <span class="keyword">new</span> ViewRootImpl(view.getContent(),display);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 将ViewRootImpll对象与DecorView建立关联</span></span><br><span class="line">root.setView(view,wparams,panelParentView)</span><br></pre></td></tr></table></figure>

<h4 id="DecorView"><a href="#DecorView" class="headerlink" title="DecorView"></a>DecorView</h4><p>定义：顶层View，即Android视图树根节点，同时也是FrameLayout的子类</p>
<p>作用：显示 &amp; 加载布局。</p>
<blockquote>
<p>View<code>层的事件都先经过</code>DecorView<code>，再传递到</code>View；</p>
<p>内含1个竖直方向的<code>LinearLayout</code>，分为2部分：上 = 标题栏<code>（titlebar）</code>、下 = 内容栏<code>（content）</code></p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/3adc208b5c311a870bf5059faed230a8.png" alt="img"></p>
<p>在<code>Activity</code>中通过 <code>setContentView（）</code>所设置的布局文件其实是被加到内容栏之中的，成为其唯一子View = id为content的<code>FrameLayout</code>中。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在代码中可通过content得到对应加载的布局</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 得到content</span></span><br><span class="line">ViewGroup content = (ViewGroup)findViewById(android.R.id.content);</span><br><span class="line"><span class="comment">// 2. 得到设置的View</span></span><br><span class="line">ViewGroup rootView = (ViewGroup) content.getChildAt(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>


</blockquote>
<h4 id="Window、Activity、DecorView-与-ViewRoot的关系"><a href="#Window、Activity、DecorView-与-ViewRoot的关系" class="headerlink" title="Window、Activity、DecorView 与 ViewRoot的关系"></a>Window、Activity、DecorView 与 ViewRoot的关系</h4><table>
<thead>
<tr>
<th>类型</th>
<th>作用</th>
<th>具体描述</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>Activity</td>
<td>控制生命周期&amp;处理事件<br>(<code>类似控制器</code>)</td>
<td>- 统筹视图的添加&amp;显示<br>- 通过其他回调方法与Window、View交互</td>
<td>- 不负责视图控制<br>- 真正控制试图的是Window，是真正代表1个窗口<br>- 1个Activity包含1个window</td>
</tr>
<tr>
<td>window</td>
<td>视图的承载器</td>
<td>- Window类=抽象类、实现类=PhoneWindow类<br>- PhonwWindow类中有个内部类DecorView=View 的根布局<br>- 通过创建DevorView来加载Activity中设置的布局</td>
<td>1、Window类通过WindowManager将DecorView加载其中<br>2、将DecorView交给ViewRoot，进行视图的控制&amp;其他交互</td>
</tr>
<tr>
<td>decorView</td>
<td>顶层View<br>- Android视图树的根节点<br>- 是FrameLayout的子类</td>
<td>- 内含1个竖直方向的LinearLayout，分为两部分，上=标题栏，下=内容栏</td>
<td></td>
</tr>
<tr>
<td>ViewRoot</td>
<td>连接器<br>对应viewRootImpl类</td>
<td>- 连接WindowManagerService和DecorView：<br>- 1.与WMS交互通信，调整窗口的大小和布局<br>- 2.完成View的绘制：measure、layout、draw</td>
<td></td>
</tr>
</tbody></table>
<h3 id="2、绘制步骤："><a href="#2、绘制步骤：" class="headerlink" title="2、绘制步骤："></a>2、绘制步骤：</h3><p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/08eccbd4be86faf28c2d0d82a02f8426.png" alt="img"></p>
<h4 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h4><p>View 的绘制流程开始于：ViewRootImpl对象的performTraversals()</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 源码分析：ViewRootImpl.performTraversals()</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">performTraversals</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  		<span class="comment">// 1. 执行measure流程</span></span><br><span class="line">        <span class="comment">// 内部会调用performMeasure()</span></span><br><span class="line">        measureHierarchy(host, lp, res,desiredWindowWidth, desiredWindowHeight);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 执行layout流程</span></span><br><span class="line">        performLayout(lp, mWidth, mHeight);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. 执行draw流程</span></span><br><span class="line">        performDraw();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>View</code>的绘制流程从顶级<code>View（DecorView）</code>的<code>ViewGroup</code>开始，一层一层从<code>ViewGroup</code>至子<code>View</code>遍历测绘</strong>。即：自上而下遍历、由父视图到子视图、每一个 <code>ViewGroup</code> 负责测绘它所有的子视图，而最底层的 View 会负责测绘自身</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/9944fa871f479ce72db89ec85c52992c.png" alt="img"></p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/cf48f9488d9f0e471782d03b82599f45.png" alt="img"></p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/a614e22232d8afdc7e268123e7113e98.png" alt="img"></p>
<h3 id="3、详细介绍"><a href="#3、详细介绍" class="headerlink" title="3、详细介绍"></a>3、详细介绍</h3><ul>
<li><p>Measure过程</p>
<p>作用：测量<code>View</code>的宽 / 高</p>
<blockquote>
<ol>
<li>在某些情况下，需要多次测量<code>（measure）</code>才能确定<code>View</code>最终的宽/高；</li>
<li>该情况下，<code>measure</code>过程后得到的宽 / 高可能不准确；</li>
<li>此处建议：在<code>layout</code>过程中<code>onLayout()</code>去获取最终的宽 / 高</li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th>View类型</th>
<th>measure过程</th>
</tr>
</thead>
<tbody><tr>
<td>单一View</td>
<td>只测量自身一个View</td>
</tr>
<tr>
<td>ViewGroup</td>
<td>1.遍历测量所有子View的尺寸<br/>2.合并将所有子View的尺寸进行，最终得到ViewGroup父视图的测量值<br>（<code>即遍历调用所有子元素的measure（）&amp;各子元素再递归去执行该流程</code>）</td>
</tr>
</tbody></table>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/d132e9cbf39de3aac4a03f32fe477cef.png" alt="img"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/carson_ho/article/details/56011064">自定义View Measure过程</a></p>
<ul>
<li><p>Layout过程</p>
<p>作用：计算视图<code>（View）</code>的位置</p>
<table>
<thead>
<tr>
<th>View类型</th>
<th>layout过程</th>
</tr>
</thead>
<tbody><tr>
<td>单一View</td>
<td>仅计算本身View的位置<br>（<code>onLayout（）layout（）.selrame（）</code>）</td>
</tr>
<tr>
<td>ViewGroup</td>
<td>1.计算自身的位置：layout（）<br>2.遍历子View、计算子View的位置&amp;设置<br>（<code>（复写）ViewGroup.onLayout（）、子View.layout（）、子View.onLayout（）</code>）<br>3.如此不断循环，最终确定所有子View在父容器的位置，即layout过程完毕</td>
</tr>
</tbody></table>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/af56deb0a1d5db485e87e7203ef4abd9.png" alt="img"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/carson_ho/article/details/56011112">自定义View Layout过程</a></p>
<ul>
<li><p>Draw过程</p>
<p>作用：绘制<code>View</code>视图</p>
<table>
<thead>
<tr>
<th>View类型</th>
<th>draw过程</th>
</tr>
</thead>
<tbody><tr>
<td>单一View</td>
<td>只需要绘制自身（含背景、内容）和装饰即可</td>
</tr>
<tr>
<td>ViewGroup</td>
<td>1.ViewGroup绘制自身（含背景、内容）；<br>2.ViewGroup遍历子View&amp;绘制其所有子View；<br>（含子View）（类似于单一View的draw过程）<br>3.ViewGroup绘制装饰（滚动指示器、滚动条、和前景）</td>
</tr>
</tbody></table>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/4895cc1dd0e7c833d5bbdb8b57e589cf.png" alt="img"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/carson_ho/article/details/56011153">自定义View Draw过程</a></p>
<h3 id="4、实例"><a href="#4、实例" class="headerlink" title="4、实例"></a>4、实例</h3><p><strong>使用场景</strong></p>
<table>
<thead>
<tr>
<th>类型</th>
<th>使用场景</th>
<th>实现方式</th>
<th>注意点</th>
</tr>
</thead>
<tbody><tr>
<td>继承特定view<br><code>自定义单一View</code></td>
<td>拓展某种已有View的功能</td>
<td>在原有View的基础增加功能 <br>（较容易）</td>
<td>不需要自己支持wrap_content&amp;padding</td>
</tr>
<tr>
<td>继承Vew<br><code>自定义单一View</code></td>
<td>实现不规则的效果、自定义控件<br><code>（如不规则图形：圆）</code></td>
<td>通过绘制的方式实现 <br>即重写onDraw（）</td>
<td>需票自己支技持wrap_content&amp;pacding<br>（不需要支持margin，因为margin属性是由父容器决定的）</td>
</tr>
<tr>
<td>继承特定ViewGroup<br><code>自定义ViewGroup</code></td>
<td>拓展某种布局的布局方式<br> <code>（如：下雨效果）</code></td>
<td>在原有ViewGroup的基础组合<br>较容易</td>
<td>与自定义ViewGroup，更加简单，但自由度不高</td>
</tr>
<tr>
<td>继承ViewGroup<br><code>自定义ViewGroup</code></td>
<td>实现不规则效果、自定义布局<be>下雨效果</td>
<td>MewGroup&amp;子View的measure、layout过程<br>较复杂</td>
<td>·需要自己支持wrap_content&amp;padding&amp;margin；<br>更加接近View的底层</td>
</tr>
</tbody></table>
<p><strong>注意事项</strong></p>
<ol>
<li><p>支持特殊属性：wrap_content、padding、margin</p>
<ol>
<li><p>支持wrap_content<br>如果不在<code>onMeasure（）</code>中对<code>wrap_content</code>作特殊处理，那么<code>wrap_content</code>属性将失效</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ca118d704b5e">为什么你设置的wrap_content不起作用？</a></p>
</li>
<li><p>支持padding &amp; margin<br>如果不支持，那么<code>padding</code>和<code>margin</code>（ViewGroup情况）的属性将失效</p>
</li>
</ol>
<blockquote>
<ol>
<li>对于继承View的控件，padding是在draw()中处理</li>
<li>对于继承ViewGroup的控件，padding和margin会直接影响measure和layout过程</li>
</ol>
</blockquote>
</li>
<li><p>多线程直接使用post方式：避免使用Handler等其他方式</p>
<p>View的内部本身提供了post系列的方法，完全可以替代Handler的作用，使用起来更加方便、直接。</p>
</li>
<li><p>避免内存泄漏：线程、动画即时停止</p>
<p><strong>当View退出或不可见时，记得及时停止该View包含的线程和动画，否则会造成内存泄露问题</strong>。</p>
<blockquote>
<p>启动或停止线程/ 动画的方式：</p>
<ol>
<li>启动线程/ 动画：使用view.onAttachedToWindow（），因为该方法调用的时机是当包含View的Activity启动的时刻</li>
<li>停止线程/ 动画：使用view.onDetachedFromWindow（），因为该方法调用的时机是当包含View的Activity退出或当前View被remove的时刻</li>
</ol>
</blockquote>
</li>
<li><p>处理好滑动冲突，View带有滑动嵌套的情况</p>
<p>当View带有滑动嵌套情况时，必须要处理好滑动冲突，否则会严重影响View的显示效果。</p>
</li>
</ol>
<p><strong>具体步骤</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyView</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="comment">//画笔</span></span><br><span class="line">    Paint mPaint;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyView</span><span class="params">(Context context, <span class="meta">@Nullable</span> AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//画笔初始化</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//创建画笔</span></span><br><span class="line">        mPaint = <span class="keyword">new</span> Paint();</span><br><span class="line">        <span class="comment">//设置画笔颜色</span></span><br><span class="line">        mPaint.setColor(Color.BLUE);</span><br><span class="line">        <span class="comment">//设置画笔宽度 10px</span></span><br><span class="line">        mPaint.setStrokeWidth(<span class="number">5f</span>);</span><br><span class="line">        <span class="comment">//设置画笔模式：填充</span></span><br><span class="line">        mPaint.setStyle(Paint.Style.FILL);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onMeasure(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDraw(canvas);</span><br><span class="line">        <span class="comment">//支持padding</span></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> paddingLeft = getPaddingLeft();</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> paddingRight = getPaddingRight();</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> paddingTop = getPaddingTop();</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> paddingBottom = getPaddingBottom();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取控件的高度和宽度</span></span><br><span class="line">        <span class="keyword">int</span> width = getWidth() - paddingLeft-paddingRight;</span><br><span class="line">        <span class="keyword">int</span> height = getHeight() - paddingTop - paddingBottom;</span><br><span class="line">        <span class="comment">//设置圆的半径=宽，高最小值的1/2</span></span><br><span class="line">        <span class="keyword">int</span> r =Math.min(width,height)/<span class="number">2</span>;</span><br><span class="line">        <span class="comment">//画出圆(蓝色)</span></span><br><span class="line">        <span class="comment">//圆心= 控件的中央，半径=r</span></span><br><span class="line"></span><br><span class="line">        canvas.drawCircle(paddingLeft+width/<span class="number">2</span>,paddingTop+height/<span class="number">2</span>,r,mPaint);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;com.example.cutomview.CustomViewActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.example.cutomview.MyView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">&quot;@color/design_default_color_secondary&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;150dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:padding</span>=<span class="string">&quot;20dp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>自定义属性</strong></p>
<ol>
<li><p>在values目录下创建自定义属性的xml文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--自定义属性集合:CircleView--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--在该集合下,设置不同的自定义属性--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;CircleView&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--在attr标签下设置需要的自定义属性--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--此处定义了一个设置图形的颜色:circle_color属性,格式是color,代表颜色--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--格式有很多种,如资源id(reference)等等--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;circle_color&quot;</span> <span class="attr">format</span>=<span class="string">&quot;color&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>自定义类型</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">&lt;-- 1. reference：使用某一资源ID --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;名称&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;background&quot;</span> <span class="attr">format</span>=<span class="string">&quot;reference&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line">// 使用格式</span><br><span class="line"><span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;42dip&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;42dip&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@drawable/图片ID&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;--  2. color：颜色值 --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;名称&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;textColor&quot;</span> <span class="attr">format</span>=<span class="string">&quot;color&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line">// 格式使用</span><br><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;42dip&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;42dip&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:textColor</span>=<span class="string">&quot;#00FF00&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;-- 3. boolean：布尔值 --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;名称&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;focusable&quot;</span> <span class="attr">format</span>=<span class="string">&quot;boolean&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line">// 格式使用</span><br><span class="line"><span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;42dip&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;42dip&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:focusable</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;-- 4. dimension：尺寸值 --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;名称&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;layout_width&quot;</span> <span class="attr">format</span>=<span class="string">&quot;dimension&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line">// 格式使用：</span><br><span class="line"><span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;42dip&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;42dip&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;-- 5. float：浮点值 --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;AlphaAnimation&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;fromAlpha&quot;</span> <span class="attr">format</span>=<span class="string">&quot;float&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;toAlpha&quot;</span> <span class="attr">format</span>=<span class="string">&quot;float&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line">// 格式使用</span><br><span class="line"><span class="tag">&lt;<span class="name">alpha</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fromAlpha</span>=<span class="string">&quot;1.0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:toAlpha</span>=<span class="string">&quot;0.7&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;-- 6. integer：整型值 --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;AnimatedRotateDrawable&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;frameDuration&quot;</span> <span class="attr">format</span>=<span class="string">&quot;integer&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;framesCount&quot;</span> <span class="attr">format</span>=<span class="string">&quot;integer&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line">// 格式使用</span><br><span class="line"><span class="tag">&lt;<span class="name">animated-rotate</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:frameDuration</span>=<span class="string">&quot;100&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:framesCount</span>=<span class="string">&quot;12&quot;</span></span></span><br><span class="line"><span class="tag"> /&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;-- 7. string：字符串 --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;MapView&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;apiKey&quot;</span> <span class="attr">format</span>=<span class="string">&quot;string&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line">// 格式使用</span><br><span class="line"><span class="tag">&lt;<span class="name">com.google.android.maps.MapView</span></span></span><br><span class="line"><span class="tag"> <span class="attr">android:apiKey</span>=<span class="string">&quot;0jOkQ80oD1JL9C6HAja99uGXCRiS2CGjKO_bc_g&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;-- 8. fraction：百分数 --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;RotateDrawable&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;pivotX&quot;</span> <span class="attr">format</span>=<span class="string">&quot;fraction&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;pivotY&quot;</span> <span class="attr">format</span>=<span class="string">&quot;fraction&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line">// 格式使用</span><br><span class="line"><span class="tag">&lt;<span class="name">rotate</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:pivotX</span>=<span class="string">&quot;200%&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:pivotY</span>=<span class="string">&quot;300%&quot;</span></span></span><br><span class="line"><span class="tag"> /&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;-- 9. enum：枚举值 --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;名称&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;orientation&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">enum</span> <span class="attr">name</span>=<span class="string">&quot;horizontal&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">enum</span> <span class="attr">name</span>=<span class="string">&quot;vertical&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line">// 格式使用</span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;fill_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;fill_parent&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;-- 10. flag：位或运算 --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;名称&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;windowSoftInputMode&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">flag</span> <span class="attr">name</span>=<span class="string">&quot;stateUnspecified&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">flag</span> <span class="attr">name</span>=<span class="string">&quot;stateUnchanged&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">flag</span> <span class="attr">name</span>=<span class="string">&quot;stateHidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">flag</span> <span class="attr">name</span>=<span class="string">&quot;stateAlwaysHidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">flag</span> <span class="attr">name</span>=<span class="string">&quot;stateVisible&quot;</span> <span class="attr">value</span>=<span class="string">&quot;4&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">flag</span> <span class="attr">name</span>=<span class="string">&quot;stateAlwaysVisible&quot;</span> <span class="attr">value</span>=<span class="string">&quot;5&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">flag</span> <span class="attr">name</span>=<span class="string">&quot;adjustUnspecified&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0x00&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">flag</span> <span class="attr">name</span>=<span class="string">&quot;adjustResize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0x10&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">flag</span> <span class="attr">name</span>=<span class="string">&quot;adjustPan&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0x20&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">flag</span> <span class="attr">name</span>=<span class="string">&quot;adjustNothing&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0x30&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span>、</span><br><span class="line">// 使用</span><br><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;.StyleAndThemeActivity&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:windowSoftInputMode</span>=<span class="string">&quot;stateUnspecified | stateUnchanged　|　stateHidden&quot;</span> &gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;-- 特别注意：属性定义时可以指定多种类型值 --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">&quot;名称&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;background&quot;</span> <span class="attr">format</span>=<span class="string">&quot;reference|color&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br><span class="line">// 使用</span><br><span class="line"><span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;42dip&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;42dip&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@drawable/图片ID|#00FF00&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<ol start="2">
<li><p>在自定义View的构造方法中解析自定义属性的值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 该构造函数需要重写</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">CircleView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>(context, attrs,<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// 原来是：super(context,attrs);</span></span><br><span class="line">        init();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">CircleView</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 加载自定义属性集合CircleView</span></span><br><span class="line">        TypedArray a = context.obtainStyledAttributes(attrs,R.styleable.CircleView);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解析集合中的属性circle_color属性</span></span><br><span class="line">        <span class="comment">// 该属性的id为:R.styleable.CircleView_circle_color</span></span><br><span class="line">        <span class="comment">// 将解析的属性传入到画圆的画笔颜色变量当中（本质上是自定义画圆画笔的颜色）</span></span><br><span class="line">        <span class="comment">// 第二个参数是默认设置颜色（即无指定circle_color情况下使用）</span></span><br><span class="line">        mColor = a.getColor(R.styleable.CircleView_circle_color,Color.RED);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解析后释放资源</span></span><br><span class="line">        a.recycle();</span><br><span class="line"></span><br><span class="line">        init();</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<ol start="3">
<li><p>在布局文件中使用自定义属性</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">  &lt;!<span class="attr">--</span>必须添加<span class="attr">schemas</span>声明才能使用自定义属性<span class="attr">--</span>&gt;</span></span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    tools:context=&quot;scut.carson_ho.diy_view.MainActivity&quot;</span><br><span class="line">    &gt;</span><br><span class="line">  </span><br><span class="line"><span class="comment">&lt;!-- 注意添加自定义View组件的标签名：包名 + 自定义View类名--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  控件背景设置为黑色--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scut.carson_ho.diy_view.CircleView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">&quot;#000000&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:padding</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    &lt;!<span class="attr">--</span>设置自定义颜色<span class="attr">--</span>&gt;</span></span><br><span class="line">        app:circle_color=&quot;#FF4081&quot;</span><br><span class="line">         /&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="5、canvas类"><a href="#5、canvas类" class="headerlink" title="5、canvas类"></a>5、canvas类</h3><p>定义：画布，一种绘制时的规则。（Android平台2D图形绘制基础）</p>
<p>作用：规定绘制内容时的规则&amp;内容</p>
<p>本质：</p>
<ul>
<li>绘制内容是根据<strong>画布（Canvas）的规定</strong>绘制在<strong>屏幕</strong>上的</li>
<li>画布（Canvas）只是绘制时的规则，但内容实际上是绘制在屏幕上的</li>
</ul>
<p>案例：先画一个矩形（蓝色）；然后移动画布；再画一个矩形（红色）</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// 画一个矩形(蓝色)</span></span><br><span class="line">canvas.drawRect(<span class="number">100</span>, <span class="number">100</span>, <span class="number">150</span>, <span class="number">150</span>, mPaint1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将画布的原点移动到(400,500)</span></span><br><span class="line">canvas.translate(<span class="number">400</span>,<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 再画一个矩形(红色)</span></span><br><span class="line">canvas.drawRect(<span class="number">100</span>, <span class="number">100</span>, <span class="number">150</span>, <span class="number">150</span>, mPaint2);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/97325ee603687be2495160aa916b39ee.png" alt="img"></p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/98de95c85db9aa88f8c14af1b9aacaa2.png" alt="img"></p>
<h4 id="1、基础-1"><a href="#1、基础-1" class="headerlink" title="1、基础"></a>1、基础</h4><h5 id="Paint类"><a href="#Paint类" class="headerlink" title="Paint类"></a>Paint类</h5><p>定义：画笔</p>
<p>作用：确定绘制内容的具体效果(颜色、大小)</p>
<blockquote>
<p>绘制内容时需要使用画笔</p>
</blockquote>
<p>用法：</p>
<ol>
<li>创建画笔对象</li>
<li>画笔设置，即设置绘制内容 的具体效果(颜色、大小)</li>
<li>初始化画笔(尽量选择在View的构建函数)</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 步骤1：创建一个画笔</span></span><br><span class="line"><span class="keyword">private</span> Paint mPaint = <span class="keyword">new</span> Paint();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 步骤2：初始化画笔</span></span><br><span class="line"><span class="comment">// 根据需求设置画笔的各种属性，具体如下：</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initPaint</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置最基本的属性</span></span><br><span class="line">        <span class="comment">// 设置画笔颜色</span></span><br><span class="line">        <span class="comment">// 可直接引入Color类，如Color.red等</span></span><br><span class="line">        mPaint.setColor(<span class="keyword">int</span> color); </span><br><span class="line">        <span class="comment">// 设置画笔模式</span></span><br><span class="line">         mPaint.setStyle(Style style); </span><br><span class="line">        <span class="comment">// Style有3种类型：</span></span><br><span class="line">        <span class="comment">// 类型1：Paint.Style.FILLANDSTROKE（描边+填充）</span></span><br><span class="line">        <span class="comment">// 类型2：Paint.Style.FILL（只填充不描边）</span></span><br><span class="line">        <span class="comment">// 类型3：Paint.Style.STROKE（只描边不填充）</span></span><br><span class="line">        <span class="comment">// 具体差别请看下图：</span></span><br><span class="line">        <span class="comment">// 特别注意：前两种就相差一条边</span></span><br><span class="line">        <span class="comment">// 若边细是看不出分别的；边粗就相当于加粗       </span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//设置画笔的粗细</span></span><br><span class="line">        mPaint.setStrokeWidth(<span class="keyword">float</span> width)       </span><br><span class="line">        <span class="comment">// 如设置画笔宽度为10px</span></span><br><span class="line">        mPaint.setStrokeWidth(<span class="number">10f</span>);    </span><br><span class="line"></span><br><span class="line">        <span class="comment">// 不常设置的属性</span></span><br><span class="line">        <span class="comment">// 得到画笔的颜色     </span></span><br><span class="line">        mPaint.getColor()      </span><br><span class="line">        <span class="comment">// 设置Shader</span></span><br><span class="line">        <span class="comment">// 即着色器，定义了图形的着色、外观</span></span><br><span class="line">        <span class="comment">// 可以绘制出多彩的图形</span></span><br><span class="line">        <span class="comment">// 具体请参考文章：http://blog.csdn.net/iispring/article/details/50500106</span></span><br><span class="line">        Paint.setShader(Shader shader)  </span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置画笔的a,r,p,g值</span></span><br><span class="line">       mPaint.setARGB(<span class="keyword">int</span> a, <span class="keyword">int</span> r, <span class="keyword">int</span> g, <span class="keyword">int</span> b)      </span><br><span class="line">         <span class="comment">//设置透明度</span></span><br><span class="line">        mPaint.setAlpha(<span class="keyword">int</span> a)   </span><br><span class="line">       <span class="comment">//得到画笔的Alpha值</span></span><br><span class="line">        mPaint.getAlpha()        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 对字体进行设置（大小、颜色）</span></span><br><span class="line">        <span class="comment">//设置字体大小</span></span><br><span class="line">          mPaint.setTextSize(<span class="keyword">float</span> textSize)       </span><br><span class="line"></span><br><span class="line">        <span class="comment">// 文字Style三种模式：</span></span><br><span class="line">          mPaint.setStyle(Style style); </span><br><span class="line">        <span class="comment">// 类型1：Paint.Style.FILLANDSTROKE（描边+填充）</span></span><br><span class="line">        <span class="comment">// 类型2：Paint.Style.FILL（只填充不描边）</span></span><br><span class="line">        <span class="comment">// 类型3：Paint.Style.STROKE（只描边不填充） </span></span><br><span class="line">        </span><br><span class="line">      <span class="comment">// 设置对齐方式   </span></span><br><span class="line">      setTextAlign（）</span><br><span class="line">      <span class="comment">// LEFT：左对齐</span></span><br><span class="line">      <span class="comment">// CENTER：居中对齐</span></span><br><span class="line">      <span class="comment">// RIGHT：右对齐</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置文本的下划线</span></span><br><span class="line">          setUnderlineText(<span class="keyword">boolean</span> underlineText)      </span><br><span class="line">        </span><br><span class="line">        <span class="comment">//设置文本的删除线</span></span><br><span class="line">        setStrikeThruText(<span class="keyword">boolean</span> strikeThruText)    </span><br><span class="line"></span><br><span class="line">         <span class="comment">//设置文本粗体</span></span><br><span class="line">        setFakeBoldText(<span class="keyword">boolean</span> fakeBoldText)  </span><br><span class="line">        </span><br><span class="line">           <span class="comment">// 设置斜体</span></span><br><span class="line">        Paint.setTextSkewX(-<span class="number">0.5f</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置文字阴影</span></span><br><span class="line">        Paint.setShadowLayer(<span class="number">5</span>,<span class="number">5</span>,<span class="number">5</span>,Color.YELLOW);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 步骤3：在构造函数中初始化</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CarsonView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        initPaint();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>Style模式效果</strong>如下：</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/a3961e45e3cbebb2fbddbcd53b102c30.png" alt="img"></p>
<h5 id="2、Path类"><a href="#2、Path类" class="headerlink" title="2、Path类"></a>2、Path类</h5><p>定义：路径，即无数个点连起来的线</p>
<p>作用：设置绘制的顺序 &amp; 区域</p>
<blockquote>
<p>Path只用于描述顺序 &amp; 区域，单使用Path无法产生效果</p>
</blockquote>
<p>场景：应用场景：绘制复杂图形（如心形、五角星等等）</p>
<blockquote>
<p>Path类封装了由直线和曲线（2、3次贝塞尔曲线）构成的几何路径。</p>
</blockquote>
<p><strong>如何判断点在图形内还是图形外</strong></p>
<table>
<thead>
<tr>
<th>方法</th>
<th>判定条件</th>
</tr>
</thead>
<tbody><tr>
<td>奇偶规则</td>
<td>从任意位置p作一条射线，根据与图形的边相交的点数进行判断：<br/><br/>a.若相交的点数为奇数，则认为p为图形内部点；<br/><br/>b.若为偶，则认为为图形外部点。</td>
</tr>
<tr>
<td>非零环绕数规则</td>
<td>从任意位置p作一条射线，当p点沿射线方向移动时，对在每个方向上穿过射线的边计数<br>1.每当图形的边从右到左穿过射线时，环绕数加1；从左到右时，环绕数减1。<br>b.若环绕数为非零，则p为内部点；否则，为外部点。</td>
</tr>
</tbody></table>
<p><strong>具体用法</strong></p>
<ul>
<li><p>对象创建</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 使用Path首先要new一个Path对象</span></span><br><span class="line"><span class="comment">// Path的起点默认为坐标为(0,0)</span></span><br><span class="line">Path path = <span class="keyword">new</span> <span class="built_in">Path</span>();</span><br><span class="line"><span class="comment">// 特别注意：建全局Path对象，在onDraw()按需修改；尽量不要在onDraw()方法里new对象</span></span><br><span class="line"><span class="comment">// 原因：若View频繁刷新，就会频繁创建对象，拖慢刷新速度。</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/2c19abde958c">自定义View Path类全面解析)</a></p>
<h4 id="2、Canvas的使用"><a href="#2、Canvas的使用" class="headerlink" title="2、Canvas的使用"></a>2、Canvas的使用</h4><h5 id="1、对象的创建-amp-获取"><a href="#1、对象的创建-amp-获取" class="headerlink" title="1、对象的创建&amp;获取"></a>1、对象的创建&amp;获取</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 方法1</span></span><br><span class="line"><span class="comment">// 利用空构造方法直接创建对象</span></span><br><span class="line">Canvas canvas = <span class="keyword">new</span> Canvas()；</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法2</span></span><br><span class="line"><span class="comment">// 通过传入装载画布Bitmap对象创建Canvas对象</span></span><br><span class="line"><span class="comment">// CBitmap上存储所有绘制在Canvas的信息</span></span><br><span class="line">Canvas canvas = <span class="keyword">new</span> Canvas(bitmap)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法3</span></span><br><span class="line"><span class="comment">// 通过重写View.onDraw（）创建Canvas对象</span></span><br><span class="line"><span class="comment">// 在该方法里可以获得这个View对应的Canvas对象</span></span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDraw(canvas);</span><br><span class="line">        <span class="comment">//在这里获取Canvas对象</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法4:官方推荐</span></span><br><span class="line"><span class="comment">// 在SurfaceView里画图时创建Canvas对象</span></span><br><span class="line"></span><br><span class="line">        SurfaceView surfaceView = <span class="keyword">new</span> SurfaceView(<span class="keyword">this</span>);</span><br><span class="line">        <span class="comment">// 从SurfaceView的surfaceHolder里锁定获取Canvas</span></span><br><span class="line">        SurfaceHolder surfaceHolder = surfaceView.getHolder();</span><br><span class="line">        <span class="comment">//获取Canvas</span></span><br><span class="line">        Canvas c = surfaceHolder.lockCanvas();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ...（进行Canvas操作）</span></span><br><span class="line">        <span class="comment">// Canvas操作结束之后解锁并执行Canvas</span></span><br><span class="line">        surfaceHolder.unlockCanvasAndPost(c);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>SurfaceView里有一条线程是专门用于画图，所以方法4的<strong>画图性能最好，并适用于高质量的、刷新频率高的图形</strong></li>
<li>而方法3刷新频率低于方法3，<strong>但系统花销小，节省资源</strong></li>
</ul>
</blockquote>
<h5 id="2、绘制方法使用"><a href="#2、绘制方法使用" class="headerlink" title="2、绘制方法使用"></a>2、绘制方法使用</h5><h6 id="绘制颜色"><a href="#绘制颜色" class="headerlink" title="绘制颜色"></a>绘制颜色</h6><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// 传入一个Color类的常量参数来设置画布颜色</span></span><br><span class="line"> <span class="comment">// 绘制蓝色</span></span><br><span class="line">canvas.drawColor(Color.BLUE); </span><br></pre></td></tr></table></figure>



<h6 id="绘制基本图形"><a href="#绘制基本图形" class="headerlink" title="绘制基本图形"></a>绘制基本图形</h6><ul>
<li><p>点</p>
<p>在某个坐标处绘制点(可画一个点或一组点)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 特别注意：需要用到画笔Paint</span></span><br><span class="line"><span class="comment">// 所以之前记得创建画笔</span></span><br><span class="line"><span class="comment">// 为了区分，这里使用了两个不同颜色的画笔</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 描绘一个点</span></span><br><span class="line"><span class="comment">// 在坐标(200,200)处</span></span><br><span class="line">canvas.drawPoint(<span class="number">300</span>, <span class="number">300</span>, mPaint1);    </span><br><span class="line"></span><br><span class="line"><span class="comment">// 绘制一组点，坐标位置由float数组指定</span></span><br><span class="line"><span class="comment">// 此处画了3个点，位置分别是：（600,500）、（600,600）、（600,700）</span></span><br><span class="line">canvas.drawPoints(<span class="keyword">new</span> <span class="keyword">float</span>[]&#123;         </span><br><span class="line">                <span class="number">600</span>,<span class="number">500</span>,</span><br><span class="line">                <span class="number">600</span>,<span class="number">600</span>,</span><br><span class="line">                <span class="number">600</span>,<span class="number">700</span></span><br><span class="line">        &#125;,mPaint2);</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/bdcb5473fd279748984e51430d7af1da.png" alt="效果图"></p>
</li>
<li><p>直线</p>
<p>原理：两点（初始点 &amp; 结束点）确定一条直线</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 画一条直线</span></span><br><span class="line"><span class="comment">// 在坐标(100,200)，(700,200)之间绘制一条直线</span></span><br><span class="line">   canvas.drawLine(<span class="number">100</span>,<span class="number">200</span>,<span class="number">700</span>,<span class="number">200</span>,mPaint1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绘制一组线</span></span><br><span class="line"><span class="comment">// 在坐标(400,500)，(500,500)之间绘制直线1</span></span><br><span class="line"><span class="comment">// 在坐标(400,600)，(500,600)之间绘制直线2</span></span><br><span class="line">        canvas.drawLines(<span class="keyword">new</span> <span class="keyword">float</span>[]&#123;</span><br><span class="line">                <span class="number">400</span>,<span class="number">500</span>,<span class="number">500</span>,<span class="number">500</span>,</span><br><span class="line">                <span class="number">400</span>,<span class="number">600</span>,<span class="number">500</span>,<span class="number">600</span></span><br><span class="line">        &#125;,mPaint2);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/506dbc83a1709ca22107650c422f73a7.png" alt="效果图"></p>
</li>
<li><p>矩形</p>
<p>原理：矩形的对角线顶点确定一个矩形(一般是采用左上角和右下角的两个点的坐标。)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 关于绘制矩形，Canvas提供了三种重载方法</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// 方法1：直接传入两个顶点的坐标</span></span><br><span class="line">       <span class="comment">// 两个顶点坐标分别是：（100,100），（800,400）</span></span><br><span class="line">        canvas.drawRect(<span class="number">100</span>,<span class="number">100</span>,<span class="number">800</span>,<span class="number">400</span>,mPaint);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 方法2：将两个顶点坐标封装为Rect</span></span><br><span class="line">        Rect rect = <span class="keyword">new</span> Rect(<span class="number">100</span>,<span class="number">100</span>,<span class="number">800</span>,<span class="number">400</span>);</span><br><span class="line">        canvas.drawRect(rect,mPaint);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 方法3：将两个顶点坐标封装为RectF</span></span><br><span class="line">        RectF rectF = <span class="keyword">new</span> RectF(<span class="number">100</span>,<span class="number">100</span>,<span class="number">800</span>,<span class="number">400</span>);</span><br><span class="line">        canvas.drawRect(rectF,mPaint);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 特别注意：Rect类和RectF类的区别</span></span><br><span class="line">        <span class="comment">// 精度不同：Rect = int &amp; RectF = float</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 三种方法画出来的效果是一样的。</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/f6e1ad1a89694ec844cc256a848840e4.png" alt="img"></p>
</li>
</ul>
<ul>
<li><p>圆角矩形</p>
<p>原理：矩形的对角线顶点确定一个矩形</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 方法1：直接传入两个顶点的坐标</span></span><br><span class="line"><span class="comment">// API21时才可使用</span></span><br><span class="line"><span class="comment">// 第5、6个参数：rx、ry是圆角的参数，下面会详细描述</span></span><br><span class="line">canvas.drawRoundRect(<span class="number">100</span>,<span class="number">100</span>,<span class="number">800</span>,<span class="number">400</span>,<span class="number">30</span>,<span class="number">30</span>,mPaint);</span><br><span class="line">        </span><br><span class="line"> <span class="comment">// 方法2：使用RectF类</span></span><br><span class="line"> RectF rectF = <span class="keyword">new</span> RectF(<span class="number">100</span>,<span class="number">100</span>,<span class="number">800</span>,<span class="number">400</span>);</span><br><span class="line"> canvas.drawRoundRect(rectF,<span class="number">30</span>,<span class="number">30</span>,mPaint);</span><br><span class="line">       </span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/ac09b634d8f6aa9ee2d3864125883915.png" alt="img"></p>
<p>圆角矩形的角是椭圆的圆弧，rx 和 ry实际上是椭圆的两个半径</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/e05ccb863e03a7cfcbfd1839c953d98b.png" alt="img"></p>
<blockquote>
<p>实际上，在rx为宽度的一半，ry为高度的一半时，刚好是一个椭圆；但由于当rx大于宽度一半，ry大于高度一半时，无法计算出圆弧，所以drawRoundRect对大于该数值的参数进行了修正，<strong>凡是大于一半的参数均按照一半来处理</strong></p>
</blockquote>
</li>
<li><p>绘制椭圆</p>
<p>原理：矩形的对角线顶点确定矩形，根据传入矩形的长宽作为长轴和短轴画椭圆</p>
<blockquote>
<ol>
<li>椭圆传入的参数和矩形是一样的；</li>
<li>绘制椭圆实际上是绘制一个矩形的内切图形。</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 方法1：使用RectF类</span></span><br><span class="line">RectF rectF = <span class="keyword">new</span> RectF(<span class="number">100</span>,<span class="number">100</span>,<span class="number">800</span>,<span class="number">400</span>);</span><br><span class="line">canvas.drawOval(rectF,mPaint);</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 方法2：直接传入与矩形相关的参数</span></span><br><span class="line">canvas.drawOval(<span class="number">100</span>,<span class="number">100</span>,<span class="number">800</span>,<span class="number">400</span>,mPaint);</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 为了方便表示，画一个和椭圆一样参数的矩形</span></span><br><span class="line"> canvas.drawRect(<span class="number">100</span>,<span class="number">100</span>,<span class="number">800</span>,<span class="number">400</span>,mPaint);</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/698dd2b5eacf248dcec544401c8ff106.png" alt="img"></p>
</li>
</ul>
<ul>
<li><p>绘制圆</p>
<p>原理：圆心坐标+半径决定圆</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 参数说明：</span></span><br><span class="line"><span class="comment">// 1、2：圆心坐标</span></span><br><span class="line"><span class="comment">// 3：半径</span></span><br><span class="line"><span class="comment">// 4：画笔</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 绘制一个圆心坐标在(500,500)，半径为400 的圆。</span></span><br><span class="line">    canvas.drawCircle(<span class="number">500</span>,<span class="number">500</span>,<span class="number">400</span>,mPaint);  </span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/4e37a12f397880862ef25465504b1f85.png" alt="img"></p>
</li>
<li><p>绘制圆弧</p>
<p>原理：通过圆弧角度的起始位置和扫过的角度确定圆弧</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 绘制圆弧共有两个方法</span></span><br><span class="line"><span class="comment">// 相比于绘制椭圆，绘制圆弧多了三个参数：</span></span><br><span class="line">startAngle  <span class="comment">// 确定角度的起始位置</span></span><br><span class="line">sweepAngle <span class="comment">// 确定扫过的角度</span></span><br><span class="line">useCenter   <span class="comment">// 是否使用中心（下面会详细说明）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法1</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawArc</span><span class="params">(<span class="meta">@NonNull</span> RectF oval, <span class="keyword">float</span> startAngle, <span class="keyword">float</span> sweepAngle, <span class="keyword">boolean</span> useCenter, <span class="meta">@NonNull</span> Paint paint)</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法2</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawArc</span><span class="params">(<span class="keyword">float</span> left, <span class="keyword">float</span> top, <span class="keyword">float</span> right, <span class="keyword">float</span> bottom, <span class="keyword">float</span> startAngle,</span></span></span><br><span class="line"><span class="params"><span class="function">            <span class="keyword">float</span> sweepAngle, <span class="keyword">boolean</span> useCenter, <span class="meta">@NonNull</span> Paint paint)</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 以下示例：绘制两个起始角度为0度、扫过90度的圆弧</span></span><br><span class="line"><span class="comment">// 两者的唯一区别就是是否使用了中心点</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 绘制圆弧1(无使用中心)</span></span><br><span class="line">        RectF rectF = <span class="keyword">new</span> RectF(<span class="number">100</span>, <span class="number">100</span>, <span class="number">800</span>,<span class="number">400</span>);</span><br><span class="line">        <span class="comment">// 绘制背景矩形</span></span><br><span class="line">        canvas.drawRect(rectF, mPaint1);</span><br><span class="line">        <span class="comment">// 绘制圆弧</span></span><br><span class="line">        canvas.drawArc(rectF, <span class="number">0</span>, <span class="number">90</span>, <span class="keyword">false</span>, mPaint2);</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 绘制圆弧2(使用中心)</span></span><br><span class="line">        RectF rectF2 = <span class="keyword">new</span> RectF(<span class="number">100</span>,<span class="number">600</span>,<span class="number">800</span>,<span class="number">900</span>);</span><br><span class="line">        <span class="comment">// 绘制背景矩形</span></span><br><span class="line">        canvas.drawRect(rectF2, mPaint1);</span><br><span class="line">        <span class="comment">// 绘制圆弧</span></span><br><span class="line">        canvas.drawArc(rectF2,<span class="number">0</span>,<span class="number">90</span>,<span class="keyword">true</span>,mPaint2);</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/e12953090d7c113f0251d384fd5aeb83.png" alt="img"></p>
<blockquote>
<ul>
<li>不使用中心点：圆弧的形状 = （起、止点连线+圆弧）构成的面积</li>
<li>使用中心店：圆弧面积 = （起点、圆心连线 + 止点、圆心连线+圆弧）构成的面积</li>
</ul>
</blockquote>
</li>
</ul>
<h6 id="绘制文字"><a href="#绘制文字" class="headerlink" title="绘制文字"></a>绘制文字</h6><ul>
<li><p>指定文本开始的位置</p>
<blockquote>
<p>即指定文本基线位置<br>基线x默认在字符串左侧，基线y默认在字符串下方</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 参数text：要绘制的文本</span></span><br><span class="line"><span class="comment">// 参数x，y：指定文本开始的位置（坐标）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数paint：设置的画笔属性</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawText</span> <span class="params">(String text, <span class="keyword">float</span> x, <span class="keyword">float</span> y, Paint paint)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 实例</span></span></span><br><span class="line"><span class="function">canvas.<span class="title">drawText</span><span class="params">(<span class="string">&quot;abcdefg&quot;</span>,<span class="number">300</span>,<span class="number">400</span>,mPaint1)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 仅绘制文本的一部分</span></span><br><span class="line"><span class="comment">// 参数start，end：指定绘制文本的位置</span></span><br><span class="line"><span class="comment">// 位置以下标标识，由0开始</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawText</span> <span class="params">(String text, <span class="keyword">int</span> start, <span class="keyword">int</span> end, <span class="keyword">float</span> x, <span class="keyword">float</span> y, Paint paint)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawText</span> <span class="params">(CharSequence text, <span class="keyword">int</span> start, <span class="keyword">int</span> end, <span class="keyword">float</span> x, <span class="keyword">float</span> y, Paint paint)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 对于字符数组char[]</span></span></span><br><span class="line"><span class="function"><span class="comment">// 截取文本使用起始位置(index)和长度(count)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawText</span> <span class="params">(<span class="keyword">char</span>[] text, <span class="keyword">int</span> index, <span class="keyword">int</span> count, <span class="keyword">float</span> x, <span class="keyword">float</span> y, Paint paint)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 实例：绘制从位置1-3的文本</span></span></span><br><span class="line"><span class="function">canvas.<span class="title">drawText</span><span class="params">(<span class="string">&quot;abcdefg&quot;</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">300</span>,<span class="number">400</span>,mPaint1)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符数组情况</span></span><br><span class="line"><span class="comment">// 字符数组(要绘制的内容)</span></span><br><span class="line"><span class="keyword">char</span>[] chars = <span class="string">&quot;abcdefg&quot;</span>.toCharArray();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数为 (字符数组 起始坐标 截取长度 基线x 基线y 画笔)</span></span><br><span class="line">canvas.drawText(chars,<span class="number">1</span>,<span class="number">3</span>,<span class="number">200</span>,<span class="number">500</span>,textPaint);</span><br><span class="line"><span class="comment">// 效果同上</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/bd65ccd48f3dbfce7fd5c6778eb8fce8.png" alt="效果图"></p>
</li>
<li><p>指定每个文字的位置</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 参数text：绘制的文本</span></span><br><span class="line"><span class="comment">// 参数pos：数组类型，存放每个字符的位置（坐标）</span></span><br><span class="line"><span class="comment">// 注意：必须指定所有字符位置</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawPosText</span> <span class="params">(String text, <span class="keyword">float</span>[] pos, Paint paint)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 对于字符数组char[],可以截取部分文本进行绘制</span></span></span><br><span class="line"><span class="function"><span class="comment">// 截取文本使用起始位置(index)和长度(count)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawPosText</span> <span class="params">(<span class="keyword">char</span>[] text, <span class="keyword">int</span> index, <span class="keyword">int</span> count, <span class="keyword">float</span>[] pos, Paint paint)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 特别注意：</span></span></span><br><span class="line"><span class="function"><span class="comment">// 1. 在字符数量较多时，使用会导致卡顿</span></span></span><br><span class="line"><span class="function"><span class="comment">// 2. 不支持emoji等特殊字符，不支持字形组合与分解</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">  <span class="comment">// 实例</span></span></span><br><span class="line"><span class="function">  canvas.<span class="title">drawPosText</span><span class="params">(<span class="string">&quot;abcde&quot;</span>, new <span class="keyword">float</span>[]&#123;</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="number">100</span>, <span class="number">100</span>,    // 第一个字符位置</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="number">200</span>, <span class="number">200</span>,    // 第二个字符位置</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="number">300</span>, <span class="number">300</span>,    // ...</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="number">400</span>, <span class="number">400</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="number">500</span>, <span class="number">500</span></span></span></span><br><span class="line"><span class="params"><span class="function">        &#125;, mPaint1)</span>；</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 数组情况（绘制部分文本）</span></span></span><br><span class="line"><span class="function">       <span class="keyword">char</span>[] chars </span>= <span class="string">&quot;abcdefg&quot;</span>.toCharArray();</span><br><span class="line"></span><br><span class="line">        canvas.drawPosText(chars, <span class="number">1</span>, <span class="number">3</span>, <span class="keyword">new</span> <span class="keyword">float</span>[]&#123;</span><br><span class="line">                <span class="number">300</span>, <span class="number">300</span>,    <span class="comment">// 指定的第一个字符位置</span></span><br><span class="line">                <span class="number">400</span>, <span class="number">400</span>,    <span class="comment">// 指定的第二个字符位置</span></span><br><span class="line">                <span class="number">500</span>, <span class="number">500</span>,    <span class="comment">// 指定的第三个字符位置</span></span><br><span class="line"></span><br><span class="line">        &#125;, mPaint1);</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/6789a826988f93cc292b351ae583af83.png" alt="效果图"></p>
</li>
<li><p>指定路径，并根据路径绘制文字</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">      </span><br><span class="line"><span class="comment">// 在路径(540,750,640,450,840,600)写上&quot;在Path上写的字:Carson_Ho&quot;字样</span></span><br><span class="line">       <span class="comment">// 1.创建路径对象</span></span><br><span class="line">       Path path = <span class="keyword">new</span> Path();</span><br><span class="line">       <span class="comment">// 2. 设置路径轨迹</span></span><br><span class="line">       path.cubicTo(<span class="number">540</span>, <span class="number">750</span>, <span class="number">640</span>, <span class="number">450</span>, <span class="number">840</span>, <span class="number">600</span>);</span><br><span class="line">        <span class="comment">// 3. 画路径</span></span><br><span class="line">       canvas.drawPath(path,mPaint2);</span><br><span class="line">       <span class="comment">// 4. 画出在路径上的字</span></span><br><span class="line">       canvas.drawTextOnPath(<span class="string">&quot;在Path上写的字:Carson_Ho&quot;</span>, path, <span class="number">50</span>, <span class="number">0</span>, mPaint2);</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/27dbaad8f5a73a5b4cfdad09a73e29c4.png" alt="效果图"></p>
</li>
</ul>
<h6 id="绘制图片"><a href="#绘制图片" class="headerlink" title="绘制图片"></a>绘制图片</h6><h6 id="绘制路径"><a href="#绘制路径" class="headerlink" title="绘制路径"></a>绘制路径</h6><p><a target="_blank" rel="noopener" href="https://carsonho.blog.csdn.net/article/details/60598775">自定义View Canvas类使用教程</a></p>
<h2 id="3、事件分发机制流程及原理"><a href="#3、事件分发机制流程及原理" class="headerlink" title="3、事件分发机制流程及原理"></a>3、事件分发机制流程及原理</h2><h2 id="4、动画类型"><a href="#4、动画类型" class="headerlink" title="4、动画类型"></a>4、动画类型</h2><h3 id="1、类型"><a href="#1、类型" class="headerlink" title="1、类型"></a>1、类型</h3><h4 id="1-1、视图动画-补间动画、卓帧动画"><a href="#1-1、视图动画-补间动画、卓帧动画" class="headerlink" title="1.1、视图动画(补间动画、卓帧动画)"></a>1.1、视图动画(补间动画、卓帧动画)</h4><h2 id="4、动画类型-1"><a href="#4、动画类型-1" class="headerlink" title="4、动画类型"></a>4、动画类型</h2><h3 id="1、类型-1"><a href="#1、类型-1" class="headerlink" title="1、类型"></a>1、类型</h3><ol>
<li>视图动画：补间动画、逐帧动画</li>
<li>属性动画</li>
</ol>
<h3 id="2、视图动画-补间动画、卓帧动画"><a href="#2、视图动画-补间动画、卓帧动画" class="headerlink" title="2、视图动画(补间动画、卓帧动画)"></a>2、视图动画(补间动画、卓帧动画)</h3><p>作用对象：视图(View)</p>
<p>具体分类：补间动画&amp;逐帧动画</p>
<h4 id="1、补间动画"><a href="#1、补间动画" class="headerlink" title="1、补间动画"></a>1、补间动画</h4><p><strong>核心类：</strong></p>
<table>
<thead>
<tr>
<th>名称</th>
<th>原理</th>
<th>对应Animation的子类</th>
</tr>
</thead>
<tbody><tr>
<td>平移动画（Translate）</td>
<td>移动视图的位置</td>
<td>TranslateAnimation类</td>
</tr>
<tr>
<td>缩放动画（Scale）</td>
<td>放大/缩小视图的大小</td>
<td>ScaleAnimation类</td>
</tr>
<tr>
<td>旋转动画（Rotate）</td>
<td>旋转视图的角度</td>
<td>RotateAnimation类</td>
</tr>
<tr>
<td>透明度动画（Alpha）</td>
<td>改变视图的透明度</td>
<td>AlphaAnimation类</td>
</tr>
</tbody></table>
<p><strong>应用场景：</strong></p>
<ul>
<li>标准动画效果<ul>
<li>补间动画常用于视图View的一些标准动画效果：平移、旋转、缩放 &amp; 透明度；</li>
<li>除了常规的动画使用，补间动画还有一些特殊的应用场景。</li>
</ul>
</li>
<li>特殊应用场景<ul>
<li><code>Activity</code> 的切换效果（淡入淡出、左右滑动等）</li>
<li><code>Fragement</code> 的切换效果（淡入淡出、左右滑动等）</li>
<li>视图组（<code>ViewGroup</code>）中子元素的出场效果（淡入淡出、左右滑动等）</li>
</ul>
</li>
</ul>
<p><strong>使用方法：</strong></p>
<ul>
<li>xml：动画描述的可读性好</li>
<li>java：动画效果可动态创建</li>
</ul>
<p><strong>具体用法：</strong></p>
<ul>
<li><p>平移动画</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 设置方式1：xml</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="comment">// 步骤1：在 res/anim的文件夹里创建动画效果.xml文件</span></span><br><span class="line"> <span class="comment">// 此处路径为res/anim/view_animation.xml</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// 步骤2：根据不同动画效果的语法设置不同动画参数-view_animation.xml</span></span><br><span class="line">   &lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">   </span><br><span class="line">   &lt;translate xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">      <span class="comment">// 采用&lt;translate /&gt; 标签表示平移动画</span></span><br><span class="line">      <span class="comment">// 以下参数是4种动画效果的公共属性,即都有的属性</span></span><br><span class="line">      android:duration=<span class="string">&quot;3000&quot;</span> <span class="comment">// 动画持续时间（ms），必须设置，动画才有效果</span></span><br><span class="line">      android:startOffset =<span class="string">&quot;1000&quot;</span> <span class="comment">// 动画延迟开始时间（ms）</span></span><br><span class="line">      android:fillBefore = “<span class="keyword">true</span>” <span class="comment">// 动画播放完后，视图是否会停留在动画开始的状态，默认为true</span></span><br><span class="line">      android:fillAfter = “<span class="keyword">false</span>” <span class="comment">// 动画播放完后，视图是否会停留在动画结束的状态，优先于fillBefore值，默认为false</span></span><br><span class="line">      android:fillEnabled= “<span class="keyword">true</span>” <span class="comment">// 是否应用fillBefore值，对fillAfter值无影响，默认为true</span></span><br><span class="line">      android:repeatMode= “restart” <span class="comment">// 选择重复播放动画模式，restart代表正序重放，reverse代表倒序回放，默认为restart|</span></span><br><span class="line">      android:repeatCount = “<span class="number">0</span>” <span class="comment">// 重放次数（所以动画的播放次数=重放次数+1），为infinite时无限重复</span></span><br><span class="line">      android:interpolator = @[<span class="keyword">package</span>:]anim/interpolator_resource <span class="comment">// 插值器，即影响动画的播放速度,下面会详细讲</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 以下参数是平移动画特有的属性</span></span><br><span class="line">      android:fromXDelta=<span class="string">&quot;0&quot;</span> <span class="comment">// 视图在水平方向x 移动的起始值</span></span><br><span class="line">      android:toXDelta=<span class="string">&quot;500&quot;</span> <span class="comment">// 视图在水平方向x 移动的结束值</span></span><br><span class="line">      android:fromYDelta=<span class="string">&quot;0&quot;</span> <span class="comment">// 视图在竖直方向y 移动的起始值</span></span><br><span class="line">      android:toYDelta=<span class="string">&quot;500&quot;</span> <span class="comment">// 视图在竖直方向y 移动的结束值</span></span><br><span class="line">      /&gt; </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 步骤3：在Java代码中创建Animation对象并播放动画</span></span><br><span class="line">  <span class="comment">// 1. 创建需要设置动画的 视图View</span></span><br><span class="line">  Button mButton = (Button) findViewById(R.id.Button); </span><br><span class="line">  <span class="comment">// 2. 创建动画对象并传入设置的动画效果xml文件</span></span><br><span class="line">  Animation translateAnimation = AnimationUtils.loadAnimation(<span class="keyword">this</span>, R.anim.view_animation);</span><br><span class="line">  <span class="comment">// 3. 播放动画</span></span><br><span class="line">  mButton.startAnimation(translateAnimation);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 设置方式2：Java</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="comment">// 步骤1:创建需要设置动画的视图View</span></span><br><span class="line"> Button mButton = (Button) findViewById(R.id.Button);</span><br><span class="line"> <span class="comment">// 步骤2：创建平移动画的对象</span></span><br><span class="line"> <span class="comment">// 平移动画对应的Animation子类为TranslateAnimation</span></span><br><span class="line"> Animation translateAnimation = <span class="keyword">new</span> TranslateAnimation(<span class="number">0</span>，<span class="number">500</span>，<span class="number">0</span>，<span class="number">500</span>);</span><br><span class="line"> <span class="comment">// 参数说明</span></span><br><span class="line"> <span class="comment">// fromXDelta ：视图在水平方向x 移动的起始值</span></span><br><span class="line"> <span class="comment">// toXDelta ：视图在水平方向x 移动的结束值</span></span><br><span class="line"> <span class="comment">// fromYDelta ：视图在竖直方向y 移动的起始值</span></span><br><span class="line"> <span class="comment">// toYDelta：视图在竖直方向y 移动的结束值</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// 步骤3：属性设置：方法名是在其属性前加“set”，如设置时长setDuration()</span></span><br><span class="line"> translateAnimation.setDuration(<span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 步骤4：播放动画</span></span><br><span class="line"> mButton.startAnimation(translateAnimation);</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/d24de453c2049fe99c6069e89df55b8f.gif" alt="效果图"></p>
</li>
<li><p>缩放动画</p>
<p>轴心：</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/bd3768da11a87ffe69a976886cf97d14.png" alt="img"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 设置方式1：xml</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="comment">// 步骤1：在 res/anim的文件夹里创建动画效果.xml文件</span></span><br><span class="line"> <span class="comment">// 此处路径为res/anim/view_animation.xml</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// 步骤2：根据不同动画效果的语法设置不同动画参数-view_animation.xml</span></span><br><span class="line">    &lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">    <span class="comment">// 采用&lt;scale/&gt; 标签表示是缩放动画</span></span><br><span class="line">    &lt;scale xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 以下参数是4种动画效果的公共属性,即都有的属性</span></span><br><span class="line">    android:duration=<span class="string">&quot;3000&quot;</span> <span class="comment">// 动画持续时间（ms），必须设置，动画才有效果</span></span><br><span class="line">    android:startOffset =<span class="string">&quot;1000&quot;</span> <span class="comment">// 动画延迟开始时间（ms）</span></span><br><span class="line">    android:fillBefore = “<span class="keyword">true</span>” <span class="comment">// 动画播放完后，视图是否会停留在动画开始的状态，默认为true</span></span><br><span class="line">    android:fillAfter = “<span class="keyword">false</span>” <span class="comment">// 动画播放完后，视图是否会停留在动画结束的状态，优先于fillBefore值，默认为false</span></span><br><span class="line">    android:fillEnabled= “<span class="keyword">true</span>” <span class="comment">// 是否应用fillBefore值，对fillAfter值无影响，默认为true</span></span><br><span class="line">    android:repeatMode= “restart” <span class="comment">// 选择重复播放动画模式，restart代表正序重放，reverse代表倒序回放，默认为restart|</span></span><br><span class="line">    android:repeatCount = “<span class="number">0</span>” <span class="comment">// 重放次数（所以动画的播放次数=重放次数+1），为infinite时无限重复</span></span><br><span class="line">    android:interpolator = @[<span class="keyword">package</span>:]anim/interpolator_resource <span class="comment">// 插值器，即影响动画的播放速度,下面会详细讲</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 以下参数是缩放动画特有的属性</span></span><br><span class="line">    android:fromXScale=<span class="string">&quot;0.0&quot;</span> </span><br><span class="line">    <span class="comment">// 动画在水平方向X的起始缩放倍数</span></span><br><span class="line">    <span class="comment">// 0.0表示收缩到没有；1.0表示正常无伸缩</span></span><br><span class="line">    <span class="comment">// 值小于1.0表示收缩；值大于1.0表示放大</span></span><br><span class="line"></span><br><span class="line">    android:toXScale=<span class="string">&quot;2&quot;</span>  <span class="comment">//动画在水平方向X的结束缩放倍数</span></span><br><span class="line"></span><br><span class="line">    android:fromYScale=<span class="string">&quot;0.0&quot;</span> <span class="comment">//动画开始前在竖直方向Y的起始缩放倍数</span></span><br><span class="line">    android:toYScale=<span class="string">&quot;2&quot;</span> <span class="comment">//动画在竖直方向Y的结束缩放倍数</span></span><br><span class="line"></span><br><span class="line">    android:pivotX=<span class="string">&quot;50%&quot;</span> <span class="comment">// 缩放轴点的x坐标</span></span><br><span class="line">    android:pivotY=<span class="string">&quot;50%&quot;</span> <span class="comment">// 缩放轴点的y坐标</span></span><br><span class="line">    <span class="comment">// 轴点 = 视图缩放的中心点</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// pivotX pivotY,可取值为数字，百分比，或者百分比p</span></span><br><span class="line">    <span class="comment">// 设置为数字时（如50），轴点为View的左上角的原点在x方向和y方向加上50px的点。在Java代码里面设置这个参数的对应参数是Animation.ABSOLUTE。</span></span><br><span class="line">    <span class="comment">// 设置为百分比时（如50%），轴点为View的左上角的原点在x方向加上自身宽度50%和y方向自身高度50%的点。在Java代码里面设置这个参数的对应参数是Animation.RELATIVE_TO_SELF。</span></span><br><span class="line">    <span class="comment">// 设置为百分比p时（如50%p），轴点为View的左上角的原点在x方向加上父控件宽度50%和y方向父控件高度50%的点。在Java代码里面设置这个参数的对应参数是Animation.RELATIVE_TO_PARENT</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 两个50%表示动画从自身中间开始，具体如下图</span></span><br><span class="line">    /&gt; </span><br><span class="line">  </span><br><span class="line"><span class="comment">// 步骤3：在Java代码中创建Animation对象并播放动画</span></span><br><span class="line">  <span class="comment">// 1. 创建需要设置动画的 视图View</span></span><br><span class="line">  Button mButton = (Button) findViewById(R.id.Button); </span><br><span class="line">  <span class="comment">// 2. 创建动画对象并传入设置的动画效果xml文件</span></span><br><span class="line">  Animation scaleAnimation = AnimationUtils.loadAnimation(<span class="keyword">this</span>, R.anim.view_animation);</span><br><span class="line">  <span class="comment">// 3. 播放动画</span></span><br><span class="line">  mButton.startAnimation(scaleAnimation);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 设置方式2：Java</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// 步骤1：创建 需要设置动画的 视图View</span></span><br><span class="line"> Button mButton = (Button) findViewById(R.id.Button);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 步骤2：创建缩放动画的对象 &amp; 设置动画效果</span></span><br><span class="line"> <span class="comment">// 缩放动画对应的Animation子类为RotateAnimation</span></span><br><span class="line"> Animation scaleAnimation = <span class="keyword">new</span> ScaleAnimation(<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,Animation.RELATIVE_TO_SELF,<span class="number">0.5f</span>,Animation.RELATIVE_TO_SELF,<span class="number">0.5f</span>);</span><br><span class="line"> <span class="comment">// 参数说明:</span></span><br><span class="line"> <span class="comment">// 1. fromX ：动画在水平方向X的结束缩放倍数</span></span><br><span class="line"> <span class="comment">// 2. toX ：动画在水平方向X的结束缩放倍数</span></span><br><span class="line"> <span class="comment">// 3. fromY ：动画开始前在竖直方向Y的起始缩放倍数</span></span><br><span class="line"> <span class="comment">// 4. toY：动画在竖直方向Y的结束缩放倍数</span></span><br><span class="line"> <span class="comment">// 5. pivotXType:缩放轴点的x坐标的模式</span></span><br><span class="line"> <span class="comment">// 6. pivotXValue:缩放轴点x坐标的相对值</span></span><br><span class="line"> <span class="comment">// 7. pivotYType:缩放轴点的y坐标的模式</span></span><br><span class="line"> <span class="comment">// 8. pivotYValue:缩放轴点y坐标的相对值</span></span><br><span class="line"> <span class="comment">// pivotXType = Animation.ABSOLUTE:缩放轴点的x坐标 =  View左上角的原点 在x方向 加上 pivotXValue数值的点(y方向同理)</span></span><br><span class="line"> <span class="comment">// pivotXType = Animation.RELATIVE_TO_SELF:缩放轴点的x坐标 = View左上角的原点 在x方向 加上 自身宽度乘上pivotXValue数值的值(y方向同理)</span></span><br><span class="line"> <span class="comment">// pivotXType = Animation.RELATIVE_TO_PARENT:缩放轴点的x坐标 = View左上角的原点 在x方向 加上 父控件宽度乘上pivotXValue数值的值 (y方向同理)</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 步骤3：属性设置：方法名是在其属性前加“set”，如设置时长setDuration() </span></span><br><span class="line">  scaleAnimation.setDuration(<span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 步骤4：播放动画</span></span><br><span class="line">  mButton.startAnimation(scaleAnimation);</span><br></pre></td></tr></table></figure>

<p>轴心（50%、50%）</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/99036c787b3126a21f25d823ce37346e.gif" alt="轴点为（50%,50%）"></p>
<p>轴心（20%、30%）</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/bee679d2bb1839d64a6bb61c68ffca40.gif" alt="轴点为（20%,30%）"></p>
</li>
<li><p>旋转动画</p>
<p>旋转轴心：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/bd3768da11a87ffe69a976886cf97d14.png" alt="image.png"></p>
<p>旋转轴心(50%、50%)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 设置方式1：xml</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="comment">// 步骤1：在 res/anim的文件夹里创建动画效果.xml文件</span></span><br><span class="line"> <span class="comment">// 此处路径为res/anim/view_animation.xml</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// 步骤2：根据不同动画效果的语法设置不同动画参数-view_animation.xml</span></span><br><span class="line"> <span class="comment">// 采用&lt;rotate/&gt; 标签表示是旋转动画</span></span><br><span class="line">    &lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">    &lt;rotate xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 以下参数是4种动画效果的公共属性,即都有的属性</span></span><br><span class="line">    android:duration=<span class="string">&quot;3000&quot;</span> <span class="comment">// 动画持续时间（ms），必须设置，动画才有效果</span></span><br><span class="line">    android:startOffset =<span class="string">&quot;1000&quot;</span> <span class="comment">// 动画延迟开始时间（ms）</span></span><br><span class="line">    android:fillBefore = “<span class="keyword">true</span>” <span class="comment">// 动画播放完后，视图是否会停留在动画开始的状态，默认为true</span></span><br><span class="line">    android:fillAfter = “<span class="keyword">false</span>” <span class="comment">// 动画播放完后，视图是否会停留在动画结束的状态，优先于fillBefore值，默认为false</span></span><br><span class="line">    android:fillEnabled= “<span class="keyword">true</span>” <span class="comment">// 是否应用fillBefore值，对fillAfter值无影响，默认为true</span></span><br><span class="line">    android:repeatMode= “restart” <span class="comment">// 选择重复播放动画模式，restart代表正序重放，reverse代表倒序回放，默认为restart|</span></span><br><span class="line">    android:repeatCount = “<span class="number">0</span>” <span class="comment">// 重放次数（所以动画的播放次数=重放次数+1），为infinite时无限重复</span></span><br><span class="line">    android:interpolator = @[<span class="keyword">package</span>:]anim/interpolator_resource <span class="comment">// 插值器，即影响动画的播放速度,下面会详细讲</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 以下参数是旋转动画特有的属性</span></span><br><span class="line">    android:duration=<span class="string">&quot;1000&quot;</span></span><br><span class="line">    android:fromDegrees=<span class="string">&quot;0&quot;</span> <span class="comment">// 动画开始时 视图的旋转角度(正数 = 顺时针，负数 = 逆时针)</span></span><br><span class="line">    android:toDegrees=<span class="string">&quot;270&quot;</span> <span class="comment">// 动画结束时 视图的旋转角度(正数 = 顺时针，负数 = 逆时针)</span></span><br><span class="line">    android:pivotX=<span class="string">&quot;50%&quot;</span> <span class="comment">// 旋转轴点的x坐标</span></span><br><span class="line">    android:pivotY=<span class="string">&quot;0&quot;</span> <span class="comment">// 旋转轴点的y坐标</span></span><br><span class="line">    <span class="comment">// 轴点 = 视图缩放的中心点</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// pivotX pivotY,可取值为数字，百分比，或者百分比p</span></span><br><span class="line">    <span class="comment">// 设置为数字时（如50），轴点为View的左上角的原点在x方向和y方向加上50px的点。在Java代码里面设置这个参数的对应参数是Animation.ABSOLUTE。</span></span><br><span class="line">    <span class="comment">// 设置为百分比时（如50%），轴点为View的左上角的原点在x方向加上自身宽度50%和y方向自身高度50%的点。在Java代码里面设置这个参数的对应参数是Animation.RELATIVE_TO_SELF。</span></span><br><span class="line">    <span class="comment">// 设置为百分比p时（如50%p），轴点为View的左上角的原点在x方向加上父控件宽度50%和y方向父控件高度50%的点。在Java代码里面设置这个参数的对应参数是Animation.RELATIVE_TO_PARENT</span></span><br><span class="line">    <span class="comment">// 两个50%表示动画从自身中间开始，具体如下图</span></span><br><span class="line"></span><br><span class="line">    /&gt; </span><br><span class="line">  </span><br><span class="line"> <span class="comment">// 步骤3：在Java代码中创建Animation对象并播放动画</span></span><br><span class="line">  <span class="comment">// 1. 创建需要设置动画的 视图View</span></span><br><span class="line">  Button mButton = (Button) findViewById(R.id.Button); </span><br><span class="line">  <span class="comment">// 2. 创建动画对象并传入设置的动画效果xml文件</span></span><br><span class="line">  Animation rotateAnimation = AnimationUtils.loadAnimation(<span class="keyword">this</span>, R.anim.view_animation);</span><br><span class="line">  <span class="comment">// 3. 播放动画</span></span><br><span class="line">  mButton.startAnimation(rotateAnimation);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 设置方式2：Java</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="comment">// 步骤1：创建需要设置动画的视图View</span></span><br><span class="line"> Button mButton = (Button) findViewById(R.id.Button);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 步骤2：创建旋转动画的对象 &amp; 设置动画效果</span></span><br><span class="line"> <span class="comment">// 旋转动画对应的Animation子类为RotateAnimation</span></span><br><span class="line"> Animation rotateAnimation = <span class="keyword">new</span> RotateAnimation(<span class="number">0</span>,<span class="number">270</span>,Animation.RELATIVE_TO_SELF,<span class="number">0.5f</span>,Animation.RELATIVE_TO_SELF,<span class="number">0.5f</span>);</span><br><span class="line"> <span class="comment">// 参数说明:</span></span><br><span class="line"> <span class="comment">// 1. fromX ：动画在水平方向X的结束缩放倍数</span></span><br><span class="line"> <span class="comment">// 2. toX ：动画在水平方向X的结束缩放倍数</span></span><br><span class="line"> <span class="comment">// 3. fromY ：动画开始前在竖直方向Y的起始缩放倍数</span></span><br><span class="line"> <span class="comment">// 4. toY：动画在竖直方向Y的结束缩放倍数</span></span><br><span class="line"> <span class="comment">// 5. pivotXType:缩放轴点的x坐标的模式</span></span><br><span class="line"> <span class="comment">// 6. pivotXValue:缩放轴点x坐标的相对值</span></span><br><span class="line"> <span class="comment">// 7. pivotYType:缩放轴点的y坐标的模式</span></span><br><span class="line"> <span class="comment">// 8. pivotYValue:缩放轴点y坐标的相对值</span></span><br><span class="line"> <span class="comment">// pivotXType = Animation.ABSOLUTE:缩放轴点的x坐标 =  View左上角的原点 在x方向 加上 pivotXValue数值的点(y方向同理)</span></span><br><span class="line"> <span class="comment">// pivotXType = Animation.RELATIVE_TO_SELF:缩放轴点的x坐标 = View左上角的原点 在x方向 加上 自身宽度乘上pivotXValue数值的值(y方向同理)</span></span><br><span class="line"> <span class="comment">// pivotXType = Animation.RELATIVE_TO_PARENT:缩放轴点的x坐标 = View左上角的原点 在x方向 加上 父控件宽度乘上pivotXValue数值的值 (y方向同理)</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 步骤3：属性设置：方法名是在其属性前加“set”，如设置时长setDuration() </span></span><br><span class="line">  rotateAnimation.setDuration(<span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 步骤4：播放动画</span></span><br><span class="line">  mButton.startAnimation(rotateAnimation);</span><br></pre></td></tr></table></figure></li>
</ul>
<ul>
<li><p>透明度动画</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 设置方式1：xml</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">   <span class="comment">// 步骤1：在 res/anim的文件夹里创建动画效果.xml文件</span></span><br><span class="line">   <span class="comment">// 此处路径为res/anim/view_animation.xml</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">// 步骤2：根据不同动画效果的语法设置不同动画参数-view_animation.xml</span></span><br><span class="line">   <span class="comment">// 采用&lt;alpha/&gt; 标签表示是透明度动画</span></span><br><span class="line">   &lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">   &lt;alpha xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 以下参数是4种动画效果的公共属性,即都有的属性</span></span><br><span class="line">    android:duration=<span class="string">&quot;3000&quot;</span> <span class="comment">// 动画持续时间（ms），必须设置，动画才有效果</span></span><br><span class="line">    android:startOffset =<span class="string">&quot;1000&quot;</span> <span class="comment">// 动画延迟开始时间（ms）</span></span><br><span class="line">    android:fillBefore = “<span class="keyword">true</span>” <span class="comment">// 动画播放完后，视图是否会停留在动画开始的状态，默认为true</span></span><br><span class="line">    android:fillAfter = “<span class="keyword">false</span>” <span class="comment">// 动画播放完后，视图是否会停留在动画结束的状态，优先于fillBefore值，默认为false</span></span><br><span class="line">    android:fillEnabled= “<span class="keyword">true</span>” <span class="comment">// 是否应用fillBefore值，对fillAfter值无影响，默认为true</span></span><br><span class="line">    android:repeatMode= “restart” <span class="comment">// 选择重复播放动画模式，restart代表正序重放，reverse代表倒序回放，默认为restart|</span></span><br><span class="line">    android:repeatCount = “<span class="number">0</span>” <span class="comment">// 重放次数（所以动画的播放次数=重放次数+1），为infinite时无限重复</span></span><br><span class="line">    android:interpolator = @[<span class="keyword">package</span>:]anim/interpolator_resource <span class="comment">// 插值器，即影响动画的播放速度,下面会详细讲</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 以下参数是透明度动画特有的属性</span></span><br><span class="line">    android:fromAlpha=<span class="string">&quot;1.0&quot;</span> <span class="comment">// 动画开始时视图的透明度(取值范围: -1 ~ 1)</span></span><br><span class="line">    android:toAlpha=<span class="string">&quot;0.0&quot;</span><span class="comment">// 动画结束时视图的透明度(取值范围: -1 ~ 1)</span></span><br><span class="line"></span><br><span class="line">    /&gt; </span><br><span class="line">  </span><br><span class="line"> <span class="comment">// 步骤3：在Java代码中创建Animation对象并播放动画</span></span><br><span class="line">  <span class="comment">// 1. 创建需要设置动画的 视图View</span></span><br><span class="line">  Button mButton = (Button) findViewById(R.id.Button); </span><br><span class="line">  <span class="comment">// 2. 创建动画对象并传入设置的动画效果xml文件</span></span><br><span class="line">  Animation alphaAnimation = AnimationUtils.loadAnimation(<span class="keyword">this</span>, R.anim.view_animation);</span><br><span class="line">  <span class="comment">// 3. 播放动画</span></span><br><span class="line">  mButton.startAnimation(alphaAnimation);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 设置方式2：Java</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">   <span class="comment">// 步骤1：创建需要设置动画的视图View</span></span><br><span class="line">   Button mButton = (Button) findViewById(R.id.Button);</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 步骤2：创建透明度动画的对象 &amp; 设置动画效果</span></span><br><span class="line">   <span class="comment">// 透明度动画对应的Animation子类为AlphaAnimation</span></span><br><span class="line">   Animation alphaAnimation = <span class="keyword">new</span> AlphaAnimation(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">   <span class="comment">// 参数说明:</span></span><br><span class="line">   <span class="comment">// 1. fromX ：动画在水平方向X的结束缩放倍数</span></span><br><span class="line">   <span class="comment">// 2. toX ：动画在水平方向X的结束缩放倍数</span></span><br><span class="line">   <span class="comment">// 3. fromY ：动画开始前在竖直方向Y的起始缩放倍数</span></span><br><span class="line">   <span class="comment">// 4. toY：动画在竖直方向Y的结束缩放倍数</span></span><br><span class="line">   <span class="comment">// 5. pivotXType:缩放轴点的x坐标的模式</span></span><br><span class="line">   <span class="comment">// 6. pivotXValue:缩放轴点x坐标的相对值</span></span><br><span class="line">   <span class="comment">// 7. pivotYType:缩放轴点的y坐标的模式</span></span><br><span class="line">   <span class="comment">// 8. pivotYValue:缩放轴点y坐标的相对值</span></span><br><span class="line">   <span class="comment">// pivotXType = Animation.ABSOLUTE:缩放轴点的x坐标 =  View左上角的原点 在x方向 加上 pivotXValue数值的点(y方向同理)</span></span><br><span class="line">   <span class="comment">// pivotXType = Animation.RELATIVE_TO_SELF:缩放轴点的x坐标 = View左上角的原点 在x方向 加上 自身宽度乘上pivotXValue数值的值(y方向同理)</span></span><br><span class="line">   <span class="comment">// pivotXType = Animation.RELATIVE_TO_PARENT:缩放轴点的x坐标 = View左上角的原点 在x方向 加上 父控件宽度乘上pivotXValue数值的值 (y方向同理)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 步骤3：属性设置：方法名是在其属性前加“set”，如设置时长setDuration() </span></span><br><span class="line">    AlphaAnimation.setDuration(<span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 步骤4：播放动画</span></span><br><span class="line">    mButton.startAnimation(AlphaAnimation);</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/4018a3f37bb84ac6050fc98fd349b66a.gif" alt="img"></p>
</li>
</ul>
<p><strong>Activity 的切换效果</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 系统已经封装好的动画效果</span></span><br><span class="line">  <span class="comment">// 淡入淡出：android.R.anim.fade_in、android.R.anim.fade_out</span></span><br><span class="line">  <span class="comment">// 由左向右滑入：android.R.anim.slide_in_left、android.R.anim.slide_out_right</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 核心方法：overridePendingTransition（int enterAnim, int exitAnim）</span></span><br><span class="line">  <span class="comment">// 调用时机：Activity的onCreate() 或 finish()</span></span><br><span class="line">  <span class="comment">// 参数说明</span></span><br><span class="line">  <span class="comment">// 对于在onCreate()设置：</span></span><br><span class="line">     <span class="comment">// enterAnim：进入该Activity时的动画效果资源ID</span></span><br><span class="line">     <span class="comment">// exitAnim：进入该Activity时上一个Activity离开时的动画效果资源ID</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对于在finish()设置：</span></span><br><span class="line">     <span class="comment">// enterAnim：进入其他Activity时 进入Activity的动画效果资源ID</span></span><br><span class="line">     <span class="comment">// exitAnim：进入其他Activity时 该Activity离开时的动画效果资源ID</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体使用</span></span><br><span class="line">  <span class="comment">// 方式1：在onCreate()设置</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">          overridePendingTransition(R.anim.fade_in, R.anim.fade_out);</span><br><span class="line">          <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方式2：在finish()设置</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">finish</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="keyword">super</span>.finish();</span><br><span class="line">          overridePendingTransition(R.anim.fade_in, R.anim.fade_out);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果进入退出页面：一个需要动画、另外一个不需要动画，但也必须设置时间相同的、没有任何变化的动画，否则会出现黑屏。</p>
</blockquote>
<p>自定义淡入淡出的效果：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">// 淡入：fade_in.xml</span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">alpha</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> &gt;</span>   </span><br><span class="line">        android:duration=&quot;1500&quot;  </span><br><span class="line">        android:fromAlpha=&quot;0.0&quot;  </span><br><span class="line">        android:toAlpha=&quot;1.0&quot; &gt;  </span><br><span class="line"><span class="tag">&lt;/<span class="name">alpha</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 淡出：fade_out.xml</span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">alpha</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> &gt;</span>   </span><br><span class="line">        android:duration=&quot;1500&quot;  </span><br><span class="line">        android:fromAlpha=&quot;1.0&quot;  </span><br><span class="line">        android:toAlpha=&quot;0.0&quot; &gt;  </span><br><span class="line"><span class="tag">&lt;/<span class="name">alpha</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/ebe2783aea2db65cc779752405673ffd.gif" alt="自定义滑动.gif"></p>
<p>原理：平移动画（Translate）</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/72bb454c3a6ea9c5382e794645e029ef.png" alt="img"></p>
<ul>
<li>以屏幕底边为X轴，屏幕左边为Y轴；</li>
<li>当Activity在X轴 = -100%p时，刚好完全超出屏幕到左边（位置1）</li>
<li>当Activity在X轴 = 0%p时，刚好完全在屏幕内(位置2）</li>
<li>当Activity在X轴 = 100%p时，刚好完全超出屏幕到右边（位置3）</li>
</ul>
<p>从右滑到左：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">// 从中间滑到左边，即从位置2 -&gt; 位置1：out_to_left.xml</span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">translate</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> &gt;</span>   </span><br><span class="line">        android:duration=&quot;500&quot;</span><br><span class="line">        android:fromXDelta=&quot;0%p&quot;</span><br><span class="line">        android:toXDelta=&quot;-100%p&quot; &gt;  </span><br><span class="line"><span class="tag">&lt;/<span class="name">translate</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 从右边滑到中间，即从位置3 -&gt; 位置2：in_from_right.xml</span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">translate</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> &gt;</span>   </span><br><span class="line">        android:duration=&quot;500&quot;</span><br><span class="line">        android:fromXDelta=&quot;100%p&quot;</span><br><span class="line">        android:toXDelta=&quot;0%p&quot; &gt;  </span><br><span class="line"><span class="tag">&lt;/<span class="name">translate</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>**Fragment动画切换效果 **</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 方式1：系统预设</span></span><br><span class="line">  <span class="comment">// 通过setTransition(int transit)进行设置</span></span><br><span class="line">  <span class="comment">// transit参数说明</span></span><br><span class="line">  <span class="comment">// 1. FragmentTransaction.TRANSIT_NONE：无动画</span></span><br><span class="line">  <span class="comment">// 2. FragmentTransaction.TRANSIT_FRAGMENT_OPEN：标准的打开动画效果</span></span><br><span class="line">  <span class="comment">// 3. FragmentTransaction.TRANSIT_FRAGMENT_CLOSE：标准的关闭动画效果</span></span><br><span class="line">  <span class="comment">// 标准动画设置好后，在Fragment添加和移除的时候都会有。</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 具体使用</span></span><br><span class="line">  FragmentTransaction fragmentTransaction = mFragmentManager.beginTransaction();</span><br><span class="line">  fragmentTransaction.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN)；</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式2：自定义动画效果</span></span><br><span class="line">  <span class="comment">// 通过FragmentTransavtion.setCustomAnimations()设置</span></span><br><span class="line">  <span class="comment">// 此处的自定义动画效果同Activity，此处不再过多描述</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 具体使用</span></span><br><span class="line">  FragmentTransaction fragmentTransaction = mFragmentManager.beginTransaction();</span><br><span class="line">  fragmentTransaction.setCustomAnimations(R.anim.in_from_right,R.anim.out_to_left);</span><br></pre></td></tr></table></figure>

<p><strong>视图组（ViewGroup）中子元素的出场效果</strong></p>
<blockquote>
<p>视图组（<code>ViewGroup</code>）中子元素可以具备出场时的补间动画效果。常用需求场景：为<code>ListView</code>的 <code>item</code> 设置出场动画</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/528328545d89060a01c5e08b3d746a55.gif" alt="ListView出场动画效果图"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 步骤1：设置子元素的出场动画</span></span><br><span class="line"><span class="comment">// res/anim/view_animation.xml</span></span><br><span class="line"></span><br><span class="line">  &lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">  <span class="comment">// 此处采用了组合动画</span></span><br><span class="line">  &lt;set xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> &gt;</span><br><span class="line">      android:duration=<span class="string">&quot;3000&quot;</span></span><br><span class="line"></span><br><span class="line">      &lt;alpha</span><br><span class="line">          android:duration=<span class="string">&quot;1500&quot;</span></span><br><span class="line">          android:fromAlpha=<span class="string">&quot;1.0&quot;</span></span><br><span class="line">          android:toAlpha=<span class="string">&quot;0.0&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">      &lt;translate</span><br><span class="line">          android:fromXDelta=<span class="string">&quot;500&quot;</span></span><br><span class="line">          android:toXDelta=<span class="string">&quot;0&quot;</span></span><br><span class="line">           /&gt;</span><br><span class="line">  &lt;/set&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 步骤2：设置 视图组（ViewGroup）的动画文件</span></span><br><span class="line"><span class="comment">// res/anim/anim_layout.xml</span></span><br><span class="line">  &lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">  <span class="comment">// 采用LayoutAnimation标签</span></span><br><span class="line">  &lt;layoutAnimation xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">      android:delay=<span class="string">&quot;0.5&quot;</span></span><br><span class="line">      <span class="comment">// 子元素开始动画的时间延迟</span></span><br><span class="line">      <span class="comment">// 如子元素入场动画的时间总长设置为300ms</span></span><br><span class="line">      <span class="comment">// 那么 delay = &quot;0.5&quot; 表示每个子元素都会延迟150ms才会播放动画效果</span></span><br><span class="line">      <span class="comment">// 第一个子元素延迟150ms播放入场效果；第二个延迟300ms，以此类推</span></span><br><span class="line"></span><br><span class="line">      android:animationOrder=<span class="string">&quot;normal&quot;</span></span><br><span class="line">      <span class="comment">// 表示子元素动画的顺序</span></span><br><span class="line">      <span class="comment">// 可设置属性为：</span></span><br><span class="line">      <span class="comment">// 1. normal ：顺序显示，即排在前面的子元素先播放入场动画</span></span><br><span class="line">      <span class="comment">// 2. reverse：倒序显示，即排在后面的子元素先播放入场动画</span></span><br><span class="line">      <span class="comment">// 3. random：随机播放入场动画</span></span><br><span class="line"></span><br><span class="line">      android:animation=<span class="string">&quot;@anim/view_animation&quot;</span></span><br><span class="line">      <span class="comment">// 设置入场的具体动画效果</span></span><br><span class="line">      <span class="comment">// 将步骤1的子元素出场动画设置到这里</span></span><br><span class="line">      /&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 步骤3：为视图组（ViewGroup）指定andorid:layoutAnimation属性</span></span><br><span class="line">   <span class="comment">// 指定的方式有两种： XML / Java代码</span></span><br><span class="line">   <span class="comment">// 方式1：XML</span></span><br><span class="line">   &lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">    &lt;LinearLayout xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">        xmlns:tools=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:background=<span class="string">&quot;#FFFFFF&quot;</span></span><br><span class="line">        android:orientation=<span class="string">&quot;vertical&quot;</span> &gt;</span><br><span class="line">        &lt;ListView</span><br><span class="line">            android:id=<span class="string">&quot;@+id/listView1&quot;</span></span><br><span class="line">            android:layoutAnimation=<span class="string">&quot;@anim/anim_layout&quot;</span></span><br><span class="line">            <span class="comment">// 指定layoutAnimation属性用以指定子元素的入场动画</span></span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;match_parent&quot;</span> /&gt;</span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 方式2：Java</span></span><br><span class="line">    <span class="comment">// 注：不需额外设置res/ anim /anim_layout.xml该xml文件了</span></span><br><span class="line">    ListView lv = (ListView) findViewById(R.id.listView1);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加载子元素的出场动画</span></span><br><span class="line">    Animation animation = AnimationUtils.loadAnimation(<span class="keyword">this</span>,R.anim.anim_item);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 设置LayoutAnimation的属性</span></span><br><span class="line">    LayoutAnimationController controller = <span class="keyword">new</span> LayoutAnimationController(animation);</span><br><span class="line">    controller.setDelay(<span class="number">0.5f</span>);</span><br><span class="line">    controller.setOrder(LayoutAnimationController.ORDER_NORMAL);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 为ListView设置LayoutAnimation的属性</span></span><br><span class="line">    lv.setLayoutAnimation(controller);</span><br></pre></td></tr></table></figure>

<p><strong>高级用法</strong></p>
<ul>
<li><p>组合动画</p>
<p>使用平移、缩放、旋转 &amp; 透明度4种动画，即组合动画</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 方式：xml跟java代码设置</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式1：xml</span></span><br><span class="line"> <span class="comment">// 步骤1：在路径 res/anim 的文件夹里创建动画效果 .xml文件 - view_animation.xml</span></span><br><span class="line"> <span class="comment">// 步骤2：设置组合动画（同单个动画设置）</span></span><br><span class="line">  &lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">	<span class="comment">// 采用&lt; Set/&gt;标签</span></span><br><span class="line">	&lt;set xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 组合动画同样具备公共属性</span></span><br><span class="line">	    android:duration=<span class="string">&quot;3000&quot;</span> <span class="comment">// 动画持续时间（ms），必须设置，动画才有效果</span></span><br><span class="line">	    android:startOffset =<span class="string">&quot;1000&quot;</span> <span class="comment">// 动画延迟开始时间（ms）</span></span><br><span class="line">	    android:fillBefore = “<span class="keyword">true</span>” <span class="comment">// 动画播放完后，视图是否会停留在动画开始的状态，默认为true</span></span><br><span class="line">	    android:fillAfter = “<span class="keyword">false</span>” <span class="comment">// 动画播放完后，视图是否会停留在动画结束的状态，优先于fillBefore值，默认为false</span></span><br><span class="line">	    android:fillEnabled= “<span class="keyword">true</span>” <span class="comment">// 是否应用fillBefore值，对fillAfter值无影响，默认为true</span></span><br><span class="line">	    android:repeatMode= “restart” <span class="comment">// 选择重复播放动画模式，restart代表正序重放，reverse代表倒序回放，默认为restart|</span></span><br><span class="line">	    android:repeatCount = “<span class="number">0</span>” <span class="comment">// 重放次数（所以动画的播放次数=重放次数+1），为infinite时无限重复</span></span><br><span class="line">	    android:interpolator = @[<span class="keyword">package</span>:]anim/interpolator_resource <span class="comment">// 插值器，即影响动画的播放速度,下面会详细讲</span></span><br><span class="line">	    </span><br><span class="line">	<span class="comment">// 组合动画独特的属性</span></span><br><span class="line">	    android:shareinterpolator = “<span class="keyword">true</span>”</span><br><span class="line">	    <span class="comment">// 表示组合动画中的动画是否和集合共享同一个差值器</span></span><br><span class="line">	    <span class="comment">// 如果集合不指定插值器，那么子动画需要单独设置</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 组合动画播放时是全部动画同时开始</span></span><br><span class="line">	<span class="comment">// 如果想不同动画不同时间开始就要使用android:startOffset属性来延迟单个动画播放时间</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 设置旋转动画，语法同单个动画</span></span><br><span class="line">	    &lt;rotate</span><br><span class="line">	        android:duration=<span class="string">&quot;1000&quot;</span></span><br><span class="line">	        android:fromDegrees=<span class="string">&quot;0&quot;</span></span><br><span class="line">	        android:toDegrees=<span class="string">&quot;360&quot;</span></span><br><span class="line">	        android:pivotX=<span class="string">&quot;50%&quot;</span></span><br><span class="line">	        android:pivotY=<span class="string">&quot;50%&quot;</span></span><br><span class="line">	        android:repeatMode=<span class="string">&quot;restart&quot;</span></span><br><span class="line">	        android:repeatCount=<span class="string">&quot;infinite&quot;</span></span><br><span class="line">	        /&gt;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 设置平移动画，语法同单个动画</span></span><br><span class="line">	    &lt;translate</span><br><span class="line">	        android:duration=<span class="string">&quot;10000&quot;</span></span><br><span class="line">	        android:startOffset = “<span class="number">1000</span>”<span class="comment">// 延迟该动画播放时间</span></span><br><span class="line">	        android:fromXDelta=<span class="string">&quot;-50%p&quot;</span></span><br><span class="line">	        android:fromYDelta=<span class="string">&quot;0&quot;</span></span><br><span class="line">	        android:toXDelta=<span class="string">&quot;50%p&quot;</span></span><br><span class="line">	        android:toYDelta=<span class="string">&quot;0&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 设置透明度动画，语法同单个动画</span></span><br><span class="line">	    &lt;alpha</span><br><span class="line">	        android:startOffset=<span class="string">&quot;7000&quot;</span></span><br><span class="line">	        android:duration=<span class="string">&quot;3000&quot;</span></span><br><span class="line">	        android:fromAlpha=<span class="string">&quot;1.0&quot;</span></span><br><span class="line">	        android:toAlpha=<span class="string">&quot;0.0&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 设置缩放动画，语法同单个动画</span></span><br><span class="line">	    &lt;scale</span><br><span class="line">	        android:startOffset=<span class="string">&quot;4000&quot;</span></span><br><span class="line">	        android:duration=<span class="string">&quot;1000&quot;</span></span><br><span class="line">	        android:fromXScale=<span class="string">&quot;1.0&quot;</span></span><br><span class="line">	        android:fromYScale=<span class="string">&quot;1.0&quot;</span></span><br><span class="line">	        android:pivotX=<span class="string">&quot;50%&quot;</span></span><br><span class="line">	        android:pivotY=<span class="string">&quot;50%&quot;</span></span><br><span class="line">	        android:toXScale=<span class="string">&quot;0.5&quot;</span></span><br><span class="line">	        android:toYScale=<span class="string">&quot;0.5&quot;</span> /&gt;</span><br><span class="line">	<span class="comment">// 特别注意：</span></span><br><span class="line">	<span class="comment">// 1. 在组合动画里scale缩放动画设置的repeatCount（重复播放）和fillBefore（播放完后，视图是否会停留在动画开始的状态）是无效的。</span></span><br><span class="line">	<span class="comment">// 2. 所以如果需要重复播放或者回到原位的话需要在set标签里设置</span></span><br><span class="line">	<span class="comment">// 3. 但是由于此处rotate旋转动画里已设置repeatCount为infinite，所以动画不会结束，也就看不到重播和回复原位</span></span><br><span class="line"></span><br><span class="line">	&lt;/set&gt;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 步骤3：播放动画</span></span><br><span class="line">	    <span class="comment">// 创建 需要设置动画的 视图View</span></span><br><span class="line">		Button mButton = (Button) findViewById(R.id.Button);</span><br><span class="line">		<span class="comment">// 创建 动画对象 并传入设置的动画效果xml文件</span></span><br><span class="line">		Animation setAnimation = AnimationUtils.loadAnimation(<span class="keyword">this</span>, R.anim.view_animation);</span><br><span class="line">		<span class="comment">// 播放动画</span></span><br><span class="line">		mButton.startAnimation(setAnimation);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式2：java代码设置</span></span><br><span class="line">    <span class="comment">// 创建 需要设置动画的 视图View</span></span><br><span class="line">	Button mButton = (Button) findViewById(R.id.Button);</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 组合动画设置</span></span><br><span class="line">	AnimationSet setAnimation = <span class="keyword">new</span> AnimationSet(<span class="keyword">true</span>);</span><br><span class="line">	<span class="comment">// 步骤1:创建组合动画对象(设置为true)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 步骤2:设置组合动画的属性</span></span><br><span class="line">	<span class="comment">// 特别说明以下情况</span></span><br><span class="line">	<span class="comment">// 因为在下面的旋转动画设置了无限循环(RepeatCount = INFINITE)</span></span><br><span class="line">	<span class="comment">// 所以动画不会结束，而是无限循环</span></span><br><span class="line">	<span class="comment">// 所以组合动画的下面两行设置是无效的</span></span><br><span class="line">	setAnimation.setRepeatMode(Animation.RESTART);</span><br><span class="line">	setAnimation.setRepeatCount(<span class="number">1</span>);<span class="comment">// 设置了循环一次,但无效</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 步骤3:逐个创建子动画(方式同单个动画创建方式,此处不作过多描述)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 子动画1:旋转动画</span></span><br><span class="line">	Animation rotate = <span class="keyword">new</span> RotateAnimation(<span class="number">0</span>,<span class="number">360</span>,Animation.RELATIVE_TO_SELF,<span class="number">0.5f</span>,Animation.RELATIVE_TO_SELF,<span class="number">0.5f</span>);</span><br><span class="line">	rotate.setDuration(<span class="number">1000</span>);</span><br><span class="line">	rotate.setRepeatMode(Animation.RESTART);</span><br><span class="line">	rotate.setRepeatCount(Animation.INFINITE);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 子动画2:平移动画</span></span><br><span class="line">	Animation translate = <span class="keyword">new</span> TranslateAnimation(TranslateAnimation.RELATIVE_TO_PARENT,-<span class="number">0.5f</span>,</span><br><span class="line">	TranslateAnimation.RELATIVE_TO_PARENT,<span class="number">0.5f</span>,</span><br><span class="line">	TranslateAnimation.RELATIVE_TO_SELF,<span class="number">0</span></span><br><span class="line">	,TranslateAnimation.RELATIVE_TO_SELF,<span class="number">0</span>);</span><br><span class="line">	translate.setDuration(<span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 子动画3:透明度动画</span></span><br><span class="line">	Animation alpha = <span class="keyword">new</span> AlphaAnimation(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">	alpha.setDuration(<span class="number">3000</span>);</span><br><span class="line">	alpha.setStartOffset(<span class="number">7000</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 子动画4:缩放动画</span></span><br><span class="line">	Animation scale1 = <span class="keyword">new</span> ScaleAnimation(<span class="number">1</span>,<span class="number">0.5f</span>,<span class="number">1</span>,<span class="number">0.5f</span>,Animation.RELATIVE_TO_SELF,<span class="number">0.5f</span>,Animation.RELATIVE_TO_SELF,<span class="number">0.5f</span>);</span><br><span class="line">	scale1.setDuration(<span class="number">1000</span>);</span><br><span class="line">	scale1.setStartOffset(<span class="number">4000</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 步骤4:将创建的子动画添加到组合动画里</span></span><br><span class="line">	setAnimation.addAnimation(alpha);</span><br><span class="line">	setAnimation.addAnimation(rotate);</span><br><span class="line">	setAnimation.addAnimation(translate);</span><br><span class="line">	setAnimation.addAnimation(scale1);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 步骤5:播放动画</span></span><br><span class="line">	mButton.startAnimation(setAnimation);</span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/55457758681408a5aa9fb2c36d550fcd.gif" alt="组合动画"></p>
</li>
<li><p>监听动画</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 主要通过setAnimationListener()设置</span></span><br><span class="line">Animation.setAnimationListener(<span class="keyword">new</span> Animation.AnimationListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationStart</span><span class="params">(Animation animation)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 动画开始时回调</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animation animation)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 动画结束时回调</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationRepeat</span><span class="params">(Animation animation)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//动画重复执行的时候回调</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>插值器</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/522294ab6363f9bd8d4bb448ae237d69.png" alt="img"></p>
<p>步骤2中的 插值器（Interpolator）和估值器（TypeEvaluator）是实现 复杂动画效果的关键。</p>
<p><code>定义：</code>一个接口</p>
<p><code>作用：</code>设置 属性值 从初始值过渡到结束值 的变化规律</p>
<blockquote>
<p>如匀速、加速 &amp; 减速 等等，即确定了 动画效果变化的模式，如匀速变化、加速变化 等等</p>
</blockquote>
<p><code>应用场景:</code>实现非线性运动的动画效果</p>
<blockquote>
<p>非线性运动：动画改变的速率不是一成不变的，如加速 &amp; 减速运动都属于非线性运动</p>
</blockquote>
<p><code>设置方式：</code></p>
<p>设置方法1：在 动画效果的XML代码中设置插值器属性<code>android:interpolator</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scale</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    <span class="attr">android:interpolator</span>=<span class="string">&quot;@android:anim/overshoot_interpolator&quot;</span></span></span><br><span class="line"><span class="tag">    // 通过资源<span class="attr">ID</span>设置插值器</span></span><br><span class="line"><span class="tag">    <span class="attr">android:duration</span>=<span class="string">&quot;3000&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fromXScale</span>=<span class="string">&quot;0.0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fromYScale</span>=<span class="string">&quot;0.0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:pivotX</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:pivotY</span>=<span class="string">&quot;50%&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:toXScale</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:toYScale</span>=<span class="string">&quot;2&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>设置方法2：在 Java 代码中设置</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Button mButton = (Button) findViewById(R.id.Button);</span><br><span class="line">        <span class="comment">// 步骤1:创建 需要设置动画的 视图View</span></span><br><span class="line"></span><br><span class="line">Animation alphaAnimation = <span class="keyword">new</span> AlphaAnimation(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// 步骤2：创建透明度动画的对象 &amp; 设置动画效果</span></span><br><span class="line"></span><br><span class="line">        alphaAnimation.setDuration(<span class="number">3000</span>);</span><br><span class="line">        Interpolator overshootInterpolator = <span class="keyword">new</span> OvershootInterpolator();</span><br><span class="line">        <span class="comment">// 步骤3：创建对应的插值器类对象</span></span><br><span class="line"></span><br><span class="line">        alphaAnimation.setInterpolator(overshootInterpolator);</span><br><span class="line">        <span class="comment">// 步骤4：给动画设置插值器</span></span><br><span class="line"></span><br><span class="line">        mButton.startAnimation(alphaAnimation);</span><br><span class="line">        <span class="comment">// 步骤5：播放动画</span></span><br></pre></td></tr></table></figure>

<p><code>系统内置插值器类型</code></p>
<table>
<thead>
<tr>
<th>作用</th>
<th>资源ID</th>
<th>对应的Java类</th>
</tr>
</thead>
<tbody><tr>
<td>动画加速进行</td>
<td>@android:anim/accelerate_interpolator</td>
<td>AccelerateInterpolator</td>
</tr>
<tr>
<td>快速完成动画，超出再回到结束样式</td>
<td>@android:anim/overshoot_interpolator</td>
<td>OvershootInterpolator</td>
</tr>
<tr>
<td>先加速再减速</td>
<td>@android:anim/accelerate_decelerate_interpolator</td>
<td>AccelerateDecelerateInterpolator</td>
</tr>
<tr>
<td>先退后再加速前进</td>
<td>@android:anim/anticipate_interpolator</td>
<td>AnticipateInterpolator</td>
</tr>
<tr>
<td>先退后再加速前进，超出终点后再回终点</td>
<td>@android:anim/anticipate_overshoot_interpolator</td>
<td>AnticipateOvershootInterpolator</td>
</tr>
<tr>
<td>最后阶段弹球效果</td>
<td>@android:anim/bounce_interpolator</td>
<td>BounceInterpolator</td>
</tr>
<tr>
<td>周期运动</td>
<td>@android:anim/cycle_interpolator</td>
<td>CycleInterpolator</td>
</tr>
<tr>
<td>减速</td>
<td>@android:anim/decelerate_interpolator</td>
<td>DecelerateInterpolator</td>
</tr>
<tr>
<td>匀速</td>
<td>@android:anim/linear_interpolator</td>
<td>LinearInterpolator</td>
</tr>
</tbody></table>
<blockquote>
<p>当在XML文件设置插值器时，只需传入对应的插值器资源ID即可<br>当在Java代码设置插值器时，只需创建对应的插值器对象即可</p>
<p>系统默认的插值器是<code>AccelerateDecelerateInterpolator</code>，即先加速后减速</p>
</blockquote>
<p>系统内置插值器效果：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/31ca336802c70a115a0ad9ad719ae54a.gif" alt="效果图"></p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/31ca336802c70a115a0ad9ad719ae54a.gif"></p>
<p><strong>自定义插值器</strong></p>
<p><code>本质：</code>根据动画的进度（0%-100%）计算出当前属性值改变的百分比<br><code>具体使用：</code>自定义插值器需要实现 <code>Interpolator/TimeInterpolator</code>接口 &amp; 复写<code>getInterpolation()</code></p>
<blockquote>
<ol>
<li>补间动画 实现 <code>Interpolator</code>接口；属性动画实现<code>TimeInterpolator</code>接口</li>
<li><code>TimeInterpolator</code>接口是属性动画中新增的，用于兼容<code>Interpolator</code>接口，这使得所有过去的<code>Interpolator</code>实现类都可以直接在属性动画使用</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Interpolator接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Interpolator</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 内部只有一个方法</span></span><br><span class="line">     <span class="function"><span class="keyword">float</span> <span class="title">getInterpolation</span><span class="params">(<span class="keyword">float</span> input)</span> </span>&#123;  </span><br><span class="line">         <span class="comment">// 参数说明</span></span><br><span class="line">         <span class="comment">// input值值变化范围是0-1，且随着动画进度（0% - 100% ）均匀变化</span></span><br><span class="line">        <span class="comment">// 即动画开始时，input值 = 0；动画结束时input = 1</span></span><br><span class="line">        <span class="comment">// 而中间的值则是随着动画的进度（0% - 100%）在0到1之间均匀增加</span></span><br><span class="line">        </span><br><span class="line">      ...<span class="comment">// 插值器的计算逻辑</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> xxx；</span><br><span class="line">      <span class="comment">// 返回的值就是用于估值器继续计算的fraction值，下面会详细说明</span></span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// TimeInterpolator接口</span></span><br><span class="line"><span class="comment">// 同上</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TimeInterpolator</span> </span>&#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">float</span> <span class="title">getInterpolation</span><span class="params">(<span class="keyword">float</span> input)</span></span>;  </span><br><span class="line">   </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<p>实验：先减速后加速</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Carson_Ho on 17/4/19.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DecelerateAccelerateInterpolator</span> <span class="keyword">implements</span> <span class="title">TimeInterpolator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getInterpolation</span><span class="params">(<span class="keyword">float</span> input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">float</span> result;</span><br><span class="line">        <span class="keyword">if</span> (input &lt;= <span class="number">0.5</span>) &#123;</span><br><span class="line">            result = (<span class="keyword">float</span>) (Math.sin(Math.PI * input)) / <span class="number">2</span>;</span><br><span class="line">            <span class="comment">// 使用正弦函数来实现先减速后加速的功能，逻辑如下：</span></span><br><span class="line">            <span class="comment">// 因为正弦函数初始弧度变化值非常大，刚好和余弦函数是相反的</span></span><br><span class="line">            <span class="comment">// 随着弧度的增加，正弦函数的变化值也会逐渐变小，这样也就实现了减速的效果。</span></span><br><span class="line">            <span class="comment">// 当弧度大于π/2之后，整个过程相反了过来，现在正弦函数的弧度变化值非常小，渐渐随着弧度继续增加，变化值越来越大，弧度到π时结束，这样从0过度到π，也就实现了先减速后加速的效果</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result = (<span class="keyword">float</span>) (<span class="number">2</span> - Math.sin(Math.PI * input)) / <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">        <span class="comment">// 返回的result值 = 随着动画进度呈先减速后加速的变化趋势</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">mButton = (Button) findViewById(R.id.Button);</span><br><span class="line">       <span class="comment">// 创建动画作用对象：此处以Button为例</span></span><br><span class="line">  </span><br><span class="line">       <span class="keyword">float</span> curTranslationX = mButton.getTranslationX();</span><br><span class="line">       <span class="comment">// 获得当前按钮的位置</span></span><br><span class="line">  </span><br><span class="line">       ObjectAnimator animator = ObjectAnimator.ofFloat(mButton, <span class="string">&quot;translationX&quot;</span>, curTranslationX, <span class="number">300</span>,curTranslationX);</span><br><span class="line">       <span class="comment">// 创建动画对象 &amp; 设置动画</span></span><br><span class="line">       <span class="comment">// 表示的是:</span></span><br><span class="line">       <span class="comment">// 动画作用对象是mButton</span></span><br><span class="line">       <span class="comment">// 动画作用的对象的属性是X轴平移</span></span><br><span class="line">       <span class="comment">// 动画效果是:从当前位置平移到 x=1500 再平移到初始位置</span></span><br><span class="line">       animator.setDuration(<span class="number">5000</span>);</span><br><span class="line">       animator.setInterpolator(<span class="keyword">new</span> DecelerateAccelerateInterpolator());</span><br><span class="line">       <span class="comment">// 设置插值器</span></span><br><span class="line">       animator.start();</span><br><span class="line">       <span class="comment">// 启动动画</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/07de0f1ec2d455231d8f53998946e49f.gif" alt="差值器.gif"></p>
</li>
<li><p><strong>估值器</strong></p>
<p><code>定义：</code>一个接口<br><code>作用：</code>设置 属性值 从初始值过渡到结束值 的变化具体数值</p>
<blockquote>
<ol>
<li>插值器（<code>Interpolator</code>）决定 值 的变化规律（匀速、加速blabla），即决定的是变化趋势；而接下来的具体变化数值则交给<br>而估值器</li>
<li>属性动画特有的属性</li>
</ol>
</blockquote>
<p><code>应用场景：</code>协助插值器 实现非线性运动的动画效果</p>
<p><code>具体用法：</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ObjectAnimator anim = ObjectAnimator.ofObject(myView2, <span class="string">&quot;height&quot;</span>, <span class="keyword">new</span> Evaluator()，<span class="number">1</span>，<span class="number">3</span>);</span><br><span class="line"><span class="comment">// 在第4个参数中传入对应估值器类的对象</span></span><br><span class="line"><span class="comment">// 系统内置的估值器有3个：</span></span><br><span class="line"><span class="comment">// IntEvaluator：以整型的形式从初始值 - 结束值 进行过渡</span></span><br><span class="line"><span class="comment">// FloatEvaluator：以浮点型的形式从初始值 - 结束值 进行过渡</span></span><br><span class="line"><span class="comment">// ArgbEvaluator：以Argb类型的形式从初始值 - 结束值 进行过渡</span></span><br></pre></td></tr></table></figure>

<p><strong>自定义估值器</strong></p>
<p><code>本质：</code>根据 插值器计算出当前属性值改变的百分比 &amp; 初始值 &amp; 结束值 来计算 当前属性具体的数值</p>
<blockquote>
<p>如：动画进行了50%（初始值=100，结束值=200 ），那么匀速插值器计算出了当前属性值改变的百分比是50%，那么估值器则负责计算当前属性值 = 100 + （200-100）x50% = 150.</p>
</blockquote>
<p>具体使用：自定义估值器需要实现 <code>TypeEvaluator接口</code> &amp; 复写<code>evaluate()</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TypeEvaluator</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">evaluate</span><span class="params">(<span class="keyword">float</span> fraction, Object startValue, Object endValue)</span> </span>&#123;  </span><br><span class="line"><span class="comment">// 参数说明</span></span><br><span class="line"><span class="comment">// fraction：插值器getInterpolation（）的返回值</span></span><br><span class="line"><span class="comment">// startValue：动画的初始值</span></span><br><span class="line"><span class="comment">// endValue：动画的结束值</span></span><br><span class="line"></span><br><span class="line">        ....<span class="comment">// 估值器的计算逻辑</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> xxx；</span><br><span class="line">        <span class="comment">// 赋给动画属性的具体数值</span></span><br><span class="line">        <span class="comment">// 使用反射机制改变属性变化</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 特别注意</span></span><br><span class="line"><span class="comment">// 那么插值器的input值 和 估值器fraction有什么关系呢？</span></span><br><span class="line"><span class="comment">// 答：input的值决定了fraction的值：input值经过计算后传入到插值器的getInterpolation（），然后通过实现getInterpolation（）中的逻辑算法，根据input值来计算出一个返回值，而这个返回值就是fraction了</span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<p>实验：一个圆从一个点 移动到 另外一个点</p>
<ol>
<li><p>定义对象类</p>
<p>因为ValueAnimator.ofObject（）是面向对象操作的，所以需要自定义对象类。<br>本例需要操作的对象是 圆的点坐标</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置两个变量用于记录坐标的位置</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> x;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> y;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造方法用于设置坐标</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Point</span><span class="params">(<span class="keyword">float</span> x, <span class="keyword">float</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get方法用于获取坐标</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getX</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getY</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
<ol start="2">
<li><p>根据需求实现TypeEvaluator接口</p>
<p>实现TypeEvaluator接口的目的是自定义如何 从初始点坐标 过渡 到结束点坐标；<br>本例实现的是一个从左上角到右下角的坐标过渡逻辑。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 实现TypeEvaluator接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PointEvaluator</span> <span class="keyword">implements</span> <span class="title">TypeEvaluator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 复写evaluate（）</span></span><br><span class="line">    <span class="comment">// 在evaluate（）里写入对象动画过渡的逻辑</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">evaluate</span><span class="params">(<span class="keyword">float</span> fraction, Object startValue, Object endValue)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将动画初始值startValue 和 动画结束值endValue 强制类型转换成Point对象</span></span><br><span class="line">        Point startPoint = (Point) startValue;</span><br><span class="line">        Point endPoint = (Point) endValue;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据fraction来计算当前动画的x和y的值</span></span><br><span class="line">        <span class="keyword">float</span> x = startPoint.getX() + fraction * (endPoint.getX() - startPoint.getX());</span><br><span class="line">        <span class="keyword">float</span> y = startPoint.getY() + fraction * (endPoint.getY() - startPoint.getY());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 将计算后的坐标封装到一个新的Point对象中并返回</span></span><br><span class="line">        Point point = <span class="keyword">new</span> Point(x, y);</span><br><span class="line">        <span class="keyword">return</span> point;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<ol start="3">
<li><p>将属性动画作用到自定义View当中</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Carson_Ho on 17/4/18.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyView</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 设置需要用到的变量</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> RADIUS = <span class="number">70f</span>;<span class="comment">// 圆的半径 = 70</span></span><br><span class="line">    <span class="keyword">private</span> Point currentPoint;<span class="comment">// 当前点坐标</span></span><br><span class="line">    <span class="keyword">private</span> Paint mPaint;<span class="comment">// 绘图画笔</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造方法(初始化画笔)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        <span class="comment">// 初始化画笔</span></span><br><span class="line">        mPaint = <span class="keyword">new</span> Paint(Paint.ANTI_ALIAS_FLAG);</span><br><span class="line">        mPaint.setColor(Color.BLUE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 复写onDraw()从而实现绘制逻辑</span></span><br><span class="line">    <span class="comment">// 绘制逻辑:先在初始点画圆,通过监听当前坐标值(currentPoint)的变化,每次变化都调用onDraw()重新绘制圆,从而实现圆的平移动画效果</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 如果当前点坐标为空(即第一次)</span></span><br><span class="line">        <span class="keyword">if</span> (currentPoint == <span class="keyword">null</span>) &#123;</span><br><span class="line">            currentPoint = <span class="keyword">new</span> Point(RADIUS, RADIUS);</span><br><span class="line">            <span class="comment">// 创建一个点对象(坐标是(70,70))</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 在该点画一个圆:圆心 = (70,70),半径 = 70</span></span><br><span class="line">            <span class="keyword">float</span> x = currentPoint.getX();</span><br><span class="line">            <span class="keyword">float</span> y = currentPoint.getY();</span><br><span class="line">            canvas.drawCircle(x, y, RADIUS, mPaint);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">// (重点关注)将属性动画作用到View中</span></span><br><span class="line">            <span class="comment">// 步骤1:创建初始动画时的对象点  &amp; 结束动画时的对象点</span></span><br><span class="line">            Point startPoint = <span class="keyword">new</span> Point(RADIUS, RADIUS);<span class="comment">// 初始点为圆心(70,70)</span></span><br><span class="line">            Point endPoint = <span class="keyword">new</span> Point(<span class="number">700</span>, <span class="number">1000</span>);<span class="comment">// 结束点为(700,1000)</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 步骤2:创建动画对象 &amp; 设置初始值 和 结束值</span></span><br><span class="line">            ValueAnimator anim = ValueAnimator.ofObject(<span class="keyword">new</span> PointEvaluator(), startPoint, endPoint);</span><br><span class="line">            <span class="comment">// 参数说明</span></span><br><span class="line">            <span class="comment">// 参数1：TypeEvaluator 类型参数 - 使用自定义的PointEvaluator(实现了TypeEvaluator接口)</span></span><br><span class="line">            <span class="comment">// 参数2：初始动画的对象点</span></span><br><span class="line">            <span class="comment">// 参数3：结束动画的对象点</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 步骤3：设置动画参数</span></span><br><span class="line">            anim.setDuration(<span class="number">5000</span>);</span><br><span class="line">            <span class="comment">// 设置动画时长</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 步骤3：通过 值 的更新监听器，将改变的对象手动赋值给当前对象</span></span><br><span class="line"><span class="comment">// 此处是将 改变后的坐标值对象 赋给 当前的坐标值对象</span></span><br><span class="line">            <span class="comment">// 设置 值的更新监听器</span></span><br><span class="line">            <span class="comment">// 即每当坐标值（Point对象）更新一次,该方法就会被调用一次</span></span><br><span class="line">            anim.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span> </span>&#123;</span><br><span class="line">                    currentPoint = (Point) animation.getAnimatedValue();</span><br><span class="line">                    <span class="comment">// 将每次变化后的坐标值（估值器PointEvaluator中evaluate（）返回的Piont对象值）到当前坐标值对象（currentPoint）</span></span><br><span class="line">                    <span class="comment">// 从而更新当前坐标值（currentPoint）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 步骤4：每次赋值后就重新绘制，从而实现动画效果</span></span><br><span class="line">                    invalidate();</span><br><span class="line">                    <span class="comment">// 调用invalidate()后,就会刷新View,即才能看到重新绘制的界面,即onDraw()会被重新调用一次</span></span><br><span class="line">                    <span class="comment">// 所以坐标值每改变一次,就会调用onDraw()一次</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            anim.start();</span><br><span class="line">            <span class="comment">// 启动动画</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 如果坐标值不为0,则画圆</span></span><br><span class="line">            <span class="comment">// 所以坐标值每改变一次,就会调用onDraw()一次,就会画一次圆,从而实现动画效果</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 在该点画一个圆:圆心 = (30,30),半径 = 30</span></span><br><span class="line">            <span class="keyword">float</span> x = currentPoint.getX();</span><br><span class="line">            <span class="keyword">float</span> y = currentPoint.getY();</span><br><span class="line">            canvas.drawCircle(x, y, RADIUS, mPaint);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<ol start="4">
<li><p>在布局文件加入自定义View空间(activity_main)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:paddingBottom</span>=<span class="string">&quot;@dimen/activity_vertical_margin&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:paddingLeft</span>=<span class="string">&quot;@dimen/activity_horizontal_margin&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:paddingRight</span>=<span class="string">&quot;@dimen/activity_horizontal_margin&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:paddingTop</span>=<span class="string">&quot;@dimen/activity_vertical_margin&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;scut.carson_ho.valueanimator_ofobject.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">scut.carson_ho.valueanimator_ofobject.MyView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">         /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<ol start="5">
<li><p>在主代码文件设置显示视图</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="2、逐帧动画"><a href="#2、逐帧动画" class="headerlink" title="2、逐帧动画"></a>2、逐帧动画</h4><h5 id="1、作用对象"><a href="#1、作用对象" class="headerlink" title="1、作用对象"></a>1、作用对象</h5><p>视图控件(View)</p>
<blockquote>
<p>如Android的TextView、Button等等</p>
<p>不可作用于View组件的属性，如：颜色、背景、长度等等</p>
</blockquote>
<h5 id="2、原理"><a href="#2、原理" class="headerlink" title="2、原理"></a>2、原理</h5><p>将动画拆分为帧的形式，且定义每一帧等于每一张图片，最后按序播放一组预先定义好的图片</p>
<h5 id="3、用法"><a href="#3、用法" class="headerlink" title="3、用法"></a>3、用法</h5><p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/872cafab97daeb0470ba8e8876623ad9.gif" alt="效果图"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 步骤1：将动画资源（即每张图片资源）放到 drawable文件夹里</span></span><br><span class="line"><span class="comment">// 技巧：找到自己需要的gif动画，用 gif分解软件（如 GifSplitter）将 gif 分解成一张张图片即可</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 步骤2：设置、启动动画</span></span><br><span class="line"><span class="comment">// 分两种方式：xml跟java</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// 方式1：xml</span></span><br><span class="line">   <span class="comment">// 1. 在 res/drawable的文件夹里创建动画效果.xml文件 - knight_attack.xml</span></span><br><span class="line">   &lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">	&lt;animation-list</span><br><span class="line">	    xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">	    android:oneshot=<span class="string">&quot;true&quot;</span> <span class="comment">// 设置是否只播放一次，默认为false</span></span><br><span class="line">	    &gt;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// item = 动画图片资源；duration = 设置一帧持续时间(ms)</span></span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a0&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a1&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a2&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a3&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a4&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a5&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a6&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a7&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a8&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a9&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a10&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a11&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a12&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a13&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a14&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a15&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a16&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a17&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a18&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a19&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a20&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a21&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a22&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a23&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a24&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	    &lt;item android:drawable=<span class="string">&quot;@drawable/a25&quot;</span> android:duration=<span class="string">&quot;100&quot;</span>/&gt;</span><br><span class="line">	&lt;/animation-list&gt;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 2. 载入 &amp; 启动动画</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FrameActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">	    <span class="keyword">private</span> Button btn_startFrame,btn_stopFrame;</span><br><span class="line">	    <span class="keyword">private</span> ImageView iv;</span><br><span class="line">	    <span class="keyword">private</span> AnimationDrawable animationDrawable;</span><br><span class="line"></span><br><span class="line">	        iv = (ImageView) findViewById(R.id.iv);</span><br><span class="line">	        btn_startFrame = (Button) findViewById(R.id.btn_startFrame);</span><br><span class="line">	        btn_stopFrame = (Button) findViewById(R.id.btn_stopFrame);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	        <span class="comment">// 载入动画</span></span><br><span class="line">	        btn_startFrame.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">	            <span class="meta">@Override</span></span><br><span class="line">	            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	                <span class="comment">// 1. 设置动画</span></span><br><span class="line">	                iv.setImageResource(R.drawable.knight_attack);</span><br><span class="line">	                <span class="comment">// 2. 获取动画对象</span></span><br><span class="line">	                animationDrawable = (AnimationDrawable) iv.getDrawable();</span><br><span class="line">	                <span class="comment">// 3. 启动动画</span></span><br><span class="line">	                animationDrawable.start();</span><br><span class="line">	                </span><br><span class="line">	            &#125;</span><br><span class="line">	        &#125;);</span><br><span class="line"></span><br><span class="line">	        <span class="comment">// 停止动画</span></span><br><span class="line">	        btn_stopFrame.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">	            <span class="meta">@Override</span></span><br><span class="line">	            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">	                </span><br><span class="line">	                <span class="comment">// 1. 设置动画</span></span><br><span class="line">	                iv.setImageResource(R.drawable.knight_attack);</span><br><span class="line">	                <span class="comment">// 2. 获取动画对象</span></span><br><span class="line">	                animationDrawable = (AnimationDrawable) iv.getDrawable();</span><br><span class="line">	                <span class="comment">// 3. 暂停动画</span></span><br><span class="line">	                animationDrawable.stop();</span><br><span class="line">	            &#125;</span><br><span class="line">	        &#125;);</span><br><span class="line"></span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	 <span class="comment">// 方式2：java</span></span><br><span class="line">	    <span class="comment">// 直接从drawable文件夹获取动画资源（图片）</span></span><br><span class="line">        animationDrawable = <span class="keyword">new</span> AnimationDrawable();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">25</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> id = getResources().getIdentifier(<span class="string">&quot;a&quot;</span> + i, <span class="string">&quot;drawable&quot;</span>, getPackageName());</span><br><span class="line">            Drawable drawable = getResources().getDrawable(id);</span><br><span class="line">            animationDrawable.addFrame(drawable, <span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 载入动画</span></span><br><span class="line">        btn_startFrame.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 1. 获取资源对象</span></span><br><span class="line">                iv.setImageDrawable(animationDrawable);</span><br><span class="line">                <span class="comment">// 2. 停止动画</span></span><br><span class="line">                <span class="comment">// 特别注意：在动画start()之前要先stop()，不然在第一次动画之后会停在最后一帧，这样动画就只会触发一次</span></span><br><span class="line">                animationDrawable.stop();</span><br><span class="line">                <span class="comment">// 3. 启动动画</span></span><br><span class="line">                animationDrawable.start();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 停止动画</span></span><br><span class="line">        btn_stopFrame.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                <span class="comment">// 1. 获取资源对象</span></span><br><span class="line">                iv.setImageDrawable(animationDrawable);</span><br><span class="line">                <span class="comment">// 2. 停止动画</span></span><br><span class="line">                animationDrawable.stop();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<h5 id="4、特点："><a href="#4、特点：" class="headerlink" title="4、特点："></a>4、特点：</h5><ul>
<li>优点：使用简单、方便</li>
<li>缺点：容易引起 <code>OOM</code>，因为会使用大量 &amp; 尺寸较大的图片资源</li>
</ul>
<blockquote>
<p>尽量避免使用尺寸较大的图片</p>
</blockquote>
<h5 id="5、应用场景"><a href="#5、应用场景" class="headerlink" title="5、应用场景"></a>5、应用场景</h5><p>较为复杂的个性化动画效果。（使用时一定要避免使用尺寸较大的图片，否则会引起OOM）</p>
<h3 id="3、属性动画"><a href="#3、属性动画" class="headerlink" title="3、属性动画"></a>3、属性动画</h3><p>视图动画出现的缺点：</p>
<table>
<thead>
<tr>
<th>问题</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>作用对象局限</td>
<td>只能够作用在视图Vew上<br>即只可以对一个Button、Textiew、甚至是Lineartayout、或者其他继承自VIew 的组件进行动画操作，但无法对非View的对象进行动画操作。有些情况下的动画效果只是视图的某个属性&amp;对象而不是整个视图</td>
<td>如，现需实现视图的颜色动态变化，那么就需要操作视图的颜色属性从而实现动画效果，而不是针对整个视图进行动画操作</td>
</tr>
<tr>
<td>仅改变了视觉效果</td>
<td>只是改变了View 的视觉效果，而不会真正去改变View的属性</td>
<td>如，将屏幕左上角的按钮通过补间动画移动到屏幕的右上角，点击当前的按钮位置是没有效果的，因为实际按钮还是停留在屏幕的左上角，补间动画只是将这个按钮绘制到屏幕的右小角，改变了视觉效果而已</td>
</tr>
<tr>
<td>动画效果单一</td>
<td>只能实现平移、旋转、缩放&amp;透明度这些简单的动画需要。一旦遇到相对复杂的动画效果，即超出了上述4种动画效果，那么补间动画则无法实现</td>
<td>即在功能&amp;可拓展有很大局限性</td>
</tr>
</tbody></table>
<h4 id="1、简介"><a href="#1、简介" class="headerlink" title="1、简介"></a>1、简介</h4><ul>
<li>作用对象：任意 <code>Java</code> 对象，即不再局限于 视图View对象</li>
<li>动画效果：可自定义各种动画效果，即不再局限于4种基本变换：平移、旋转、缩放 &amp; 透明度</li>
</ul>
<h4 id="2、特点"><a href="#2、特点" class="headerlink" title="2、特点"></a>2、特点</h4><ul>
<li>作用对象进行了扩展：不只是View对象，甚至没对象也可以</li>
<li>动画效果：不只是4种基本变换，还有其他动画效果</li>
<li>作用领域：API 11后引入的</li>
</ul>
<h4 id="3、工作原理"><a href="#3、工作原理" class="headerlink" title="3、工作原理"></a>3、工作原理</h4><p>在一定时间间隔内，通过不断对值进行改变、不断将该值赋给对象的属性(任意对象的任意属性)，从而实现该对象在该属性上的动画效果。整个工作原理的流程如下：</p>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/2d65cfdbda45a8dd8b3d32d50acee117.png" alt="img"></p>
<h4 id="4、具体用法"><a href="#4、具体用法" class="headerlink" title="4、具体用法"></a>4、具体用法</h4><ol>
<li>两个使用方法类：<code>ValueAnimator</code> 类 &amp; <code>ObjectAnimator</code> 类</li>
<li>两个辅助使用类：插值器 &amp; 估值器</li>
</ol>
<p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/5d97a025eb77dc24d1bbcc81de00e0da.png" alt="img"></p>
<h5 id="1、ValueAnimator"><a href="#1、ValueAnimator" class="headerlink" title="1、ValueAnimator"></a>1、ValueAnimator</h5><ul>
<li>定义：属性动画机制中 最核心的一个类</li>
<li>实现动画的原理：<strong>通过不断控制 值 的变化，再不断 手动 赋给对象的属性，从而实现动画效果</strong>。如图下：</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5d97a025eb77dc24d1bbcc81de00e0da.png" alt="工作原理"></p>
<p>三个核心方法：</p>
<ol>
<li><code>ValueAnimator.ofInt（int values）</code></li>
<li><code>ValueAnimator.ofFloat（float values）</code></li>
<li><code>ValueAnimator.ofObject（int values）</code></li>
</ol>
<h4 id="1-2、属性动画"><a href="#1-2、属性动画" class="headerlink" title="1.2、属性动画"></a>1.2、属性动画</h4><h2 id="5、Window、Activity、DecorView和ViewRoo"><a href="#5、Window、Activity、DecorView和ViewRoo" class="headerlink" title="5、Window、Activity、DecorView和ViewRoo"></a>5、Window、Activity、DecorView和ViewRoo</h2><p><img src="https://raw.githubusercontent.com/dpzxka/typora_pictures/master/944365-aeeb7d69afb2cd63" alt="img"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">XKADPZ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://dpzxka.github.io/2022/09/13/Android/4%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89View/">https://dpzxka.github.io/2022/09/13/Android/4%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89View/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://dpzxka.github.io" target="_blank">小白兔与小猪猪</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/android/">android</a></div><div class="post_share"><div class="social-share" data-image="/img/author.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/08/31/PdfTest-1/"><img class="prev-cover" src="/img/author.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">PDF TestNew</div></div></a></div><div class="next-post pull-right"><a href="/2022/09/13/Android/5%E3%80%81%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"><img class="next-cover" src="/img/author.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">5、性能优化</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/02/13/Android/%E7%AC%AC%E4%BA%94%E7%AB%A0%20%E5%B9%BF%E6%92%AD%E6%9C%BA%E5%88%B6/" title="Android之广播机制(五)"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-13</div><div class="title">Android之广播机制(五)</div></div></a></div><div><a href="/2022/02/13/Android/%E7%AC%AC%E5%85%AD%E7%AB%A0%20%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/" title="Android之数据存储(六)"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-13</div><div class="title">Android之数据存储(六)</div></div></a></div><div><a href="/2022/04/22/Android/Android%E7%9F%A5%E8%AF%86%E7%82%B9/" title="Android 知识点"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-22</div><div class="title">Android 知识点</div></div></a></div><div><a href="/2022/07/08/Android/Android%20%E9%9D%A2%E8%AF%95/" title="Android 面试宝典"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-08</div><div class="title">Android 面试宝典</div></div></a></div><div><a href="/2022/07/28/Android/Android%2033%E8%AE%B2/" title="Android 33讲"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-28</div><div class="title">Android 33讲</div></div></a></div><div><a href="/2022/08/08/Android/Android%20%E7%BE%A4%E8%8B%B1%E4%BC%A0%20%E6%80%BB%E7%BB%93%E8%AE%B0%E5%BD%95/" title="Android 群英传笔记"><img class="cover" src="/img/author.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-08</div><div class="title">Android 群英传笔记</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#4%E3%80%81-%E8%87%AA%E5%AE%9A%E4%B9%89View"><span class="toc-number">1.</span> <span class="toc-text">4、 自定义View</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89View%E5%9F%BA%E7%A1%80"><span class="toc-number">1.1.</span> <span class="toc-text">1、自定义View基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E8%A7%86%E5%9B%BE%E5%AE%9A%E4%B9%89"><span class="toc-number">1.1.1.</span> <span class="toc-text">1、视图定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%86%E5%9B%BE%E5%88%86%E7%B1%BB"><span class="toc-number">1.1.2.</span> <span class="toc-text">2、视图分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E8%A7%86%E5%9B%BE%E7%B1%BB%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.3.</span> <span class="toc-text">3、视图类简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E8%A7%86%E5%9B%BE%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.4.</span> <span class="toc-text">4、视图结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Android%E5%9D%90%E6%A0%87%E7%B3%BB"><span class="toc-number">1.1.5.</span> <span class="toc-text">5. Android坐标系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81View%E4%BD%8D%E7%BD%AE%EF%BC%88%E5%9D%90%E6%A0%87%EF%BC%89%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.1.6.</span> <span class="toc-text">6、View位置（坐标）描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E4%BD%8D%E7%BD%AE%E8%8E%B7%E5%8F%96%E6%96%B9%E5%BC%8F"><span class="toc-number">1.1.7.</span> <span class="toc-text">7. 位置获取方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E8%A7%92%E5%BA%A6%EF%BC%88angle%EF%BC%89-amp-%E5%BC%A7%E5%BA%A6%EF%BC%88radian%EF%BC%89"><span class="toc-number">1.1.8.</span> <span class="toc-text">8. 角度（angle）&amp; 弧度（radian）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81-%E9%A2%9C%E8%89%B2%E7%9B%B8%E5%85%B3"><span class="toc-number">1.1.9.</span> <span class="toc-text">9、 颜色相关</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89View%E6%B5%81%E7%A8%8B%E5%8F%8A%E7%89%B9%E7%82%B9-Measure%E8%BF%87%E7%A8%8B%E3%80%81Layout%E8%BF%87%E7%A8%8B%E3%80%81Draw%E8%BF%87%E7%A8%8B"><span class="toc-number">1.2.</span> <span class="toc-text">2、自定义View流程及特点:Measure过程、Layout过程、Draw过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%9F%BA%E7%A1%80"><span class="toc-number">1.2.1.</span> <span class="toc-text">1、基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ViewRoot"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">ViewRoot</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DecorView"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">DecorView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Window%E3%80%81Activity%E3%80%81DecorView-%E4%B8%8E-ViewRoot%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">Window、Activity、DecorView 与 ViewRoot的关系</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E7%BB%98%E5%88%B6%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-number">1.2.2.</span> <span class="toc-text">2、绘制步骤：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E6%A6%82%E8%BF%B0"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">1、概述</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.2.3.</span> <span class="toc-text">3、详细介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.2.4.</span> <span class="toc-text">4、实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81canvas%E7%B1%BB"><span class="toc-number">1.2.5.</span> <span class="toc-text">5、canvas类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%9F%BA%E7%A1%80-1"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">1、基础</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Paint%E7%B1%BB"><span class="toc-number">1.2.5.1.1.</span> <span class="toc-text">Paint类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81Path%E7%B1%BB"><span class="toc-number">1.2.5.1.2.</span> <span class="toc-text">2、Path类</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81Canvas%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">2、Canvas的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9B%E5%BB%BA-amp-%E8%8E%B7%E5%8F%96"><span class="toc-number">1.2.5.2.1.</span> <span class="toc-text">1、对象的创建&amp;获取</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E7%BB%98%E5%88%B6%E6%96%B9%E6%B3%95%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.5.2.2.</span> <span class="toc-text">2、绘制方法使用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E9%A2%9C%E8%89%B2"><span class="toc-number">1.2.5.2.2.1.</span> <span class="toc-text">绘制颜色</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E5%9F%BA%E6%9C%AC%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.2.5.2.2.2.</span> <span class="toc-text">绘制基本图形</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E6%96%87%E5%AD%97"><span class="toc-number">1.2.5.2.2.3.</span> <span class="toc-text">绘制文字</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E5%9B%BE%E7%89%87"><span class="toc-number">1.2.5.2.2.4.</span> <span class="toc-text">绘制图片</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E8%B7%AF%E5%BE%84"><span class="toc-number">1.2.5.2.2.5.</span> <span class="toc-text">绘制路径</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E6%9C%BA%E5%88%B6%E6%B5%81%E7%A8%8B%E5%8F%8A%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">3、事件分发机制流程及原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E5%8A%A8%E7%94%BB%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.4.</span> <span class="toc-text">4、动画类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.4.1.</span> <span class="toc-text">1、类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1%E3%80%81%E8%A7%86%E5%9B%BE%E5%8A%A8%E7%94%BB-%E8%A1%A5%E9%97%B4%E5%8A%A8%E7%94%BB%E3%80%81%E5%8D%93%E5%B8%A7%E5%8A%A8%E7%94%BB"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">1.1、视图动画(补间动画、卓帧动画)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E5%8A%A8%E7%94%BB%E7%B1%BB%E5%9E%8B-1"><span class="toc-number">1.5.</span> <span class="toc-text">4、动画类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%B1%BB%E5%9E%8B-1"><span class="toc-number">1.5.1.</span> <span class="toc-text">1、类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%86%E5%9B%BE%E5%8A%A8%E7%94%BB-%E8%A1%A5%E9%97%B4%E5%8A%A8%E7%94%BB%E3%80%81%E5%8D%93%E5%B8%A7%E5%8A%A8%E7%94%BB"><span class="toc-number">1.5.2.</span> <span class="toc-text">2、视图动画(补间动画、卓帧动画)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E8%A1%A5%E9%97%B4%E5%8A%A8%E7%94%BB"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">1、补间动画</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E9%80%90%E5%B8%A7%E5%8A%A8%E7%94%BB"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">2、逐帧动画</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E4%BD%9C%E7%94%A8%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.5.2.2.1.</span> <span class="toc-text">1、作用对象</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%8E%9F%E7%90%86"><span class="toc-number">1.5.2.2.2.</span> <span class="toc-text">2、原理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E7%94%A8%E6%B3%95"><span class="toc-number">1.5.2.2.3.</span> <span class="toc-text">3、用法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E7%89%B9%E7%82%B9%EF%BC%9A"><span class="toc-number">1.5.2.2.4.</span> <span class="toc-text">4、特点：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.5.2.2.5.</span> <span class="toc-text">5、应用场景</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB"><span class="toc-number">1.5.3.</span> <span class="toc-text">3、属性动画</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E7%AE%80%E4%BB%8B"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">1、简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E7%89%B9%E7%82%B9"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">2、特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">3、工作原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E5%85%B7%E4%BD%93%E7%94%A8%E6%B3%95"><span class="toc-number">1.5.3.4.</span> <span class="toc-text">4、具体用法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81ValueAnimator"><span class="toc-number">1.5.3.4.1.</span> <span class="toc-text">1、ValueAnimator</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2%E3%80%81%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB"><span class="toc-number">1.5.3.5.</span> <span class="toc-text">1.2、属性动画</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81Window%E3%80%81Activity%E3%80%81DecorView%E5%92%8CViewRoo"><span class="toc-number">1.6.</span> <span class="toc-text">5、Window、Activity、DecorView和ViewRoo</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By XKADPZ</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">xkadpz的欢乐乐园</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>